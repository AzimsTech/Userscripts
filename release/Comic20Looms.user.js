// ==UserScript==
// @name               Comic Looms
// @name:en            Comic Looms
// @namespace          https://github.com/MapoMagpie/comic-looms
// @version            4.12.8
// @author             MapoMagpie
// @license            MIT
// @icon               data:image/x-icon;base64,AAABAAEAQEAAAAEAIAAoQgAAFgAAACgAAABAAAAAgAAAAAEAIAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAADF2+r/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Of/xdzn/8Xc5//F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Tb5//E2+f/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/E2+f/xNvn/8Xb6P/E3Of/xNvn/8Tb5//F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xNvn/8Tb5//E2+f/xNvn/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdvp/8Xd5//F3eb/xd3m/8Xd5//F3ef/xd3n/8Xd5//F3ef/xd3n/8Xd5//F3ef/xd3n/8Xd5//F3eb/xd3m/8Xd5v/F3eb/xd3m/8Xe5//F3eb/xd3m/8Xd5v/F3eb/xd3m/8Xd5//F3eb/xd3m/8Xd5//F3eb/xd3m/8Xd5v/F3eb/xd3n/8Xd5//F3ef/xd3n/8Xd5//E3OX/w9vm/8Tc5//D2+X/wtvk/8Xd5//F3eb/xd3m/8Xd5v/F3eb/xd3m/8Xd5v/F3ef/xd3n/8Xe5v/F3uf/xd3m/8Xe5v/F3eb/xd3n/8Xd5v/F3eb/xd3n/8Xd5//F3ef/xdzo/8Xb6f/F3eb/xd7l/8Xe5f/D3uX/xN7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xN7l/8Te5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5P/F3uT/xd3k/8Xd5P/F3eT/xd3k/8Xd5P/E3OP/zeXr/9Dm6//N4uf/0uju/9Hq8f/H4On/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5v/F3ef/xd3n/8Xd6f/F2ur/xd3n/8Xe5f/E3uX/w97l/8Pe5f/F3uX/xN3k/8Xd5P/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uT/xd3k/8Xd5P/F3eT/xd3k/8Xd5P/F3eP/xN3j/8Td4//E3eT/xN3k/8Td5P/E3eT/xN3l/8Pe5f/D3ub/xN/n/8Tf6P/E4Oj/xOHp/8Xh6//F4Or/0ez2/5aquv9YZ4X/YXGQ/1Jbd/+LmKj/yd3l/8be5//F3uT/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/xd7m/8Xd5//F3ej/xdrq/8Xd5//F3uX/xd7l/8Te5f/F3uX/xd7l/8ji6v/G4Oj/xN3l/8Tc5P/E3eT/xN3k/8Pd5f/E3uf/xN/o/8Tf6P/E3+r/xOHq/8bi7P/G4+z/x+Tu/8jl7v/J5e//y+Xv/8vl7v/M5e3/zeXs/87k6v/P4uj/z+Dj/9De3//O2dr/zdXV/8zRzv/IysX/xMK8/8rEvv+Ng4P/T2yk/01spv8ZKmj/DCBs/3yFmP/b8fj/w93p/8Td5f/E3eT/xd7l/8Td5P/E3eT/xN3k/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/w97l/8Te5f/F3uX/xd7l/8Xe5f/F3ef/xd3n/8Xb6v/F3ef/xd7l/8Xe5f/F3uX/xt7m/8fd5P+6ztP/xNnd/8zj6f/N5/D/zubu/87l7P/O4+j/z+Hk/8/e3//O2tr/ztXU/8vQzv/Iy8f/xcS+/8K7tP+9s6v/uayj/7Okmv+unZL/p5WK/6CNg/+ZhXz/kn14/4p2dP+CcXT/e21y/3Rpcv9vZXL/aWRy/2Nhdf9hZH3/VFNn/0BSf/9JZqf/IjNy/x45jf9DP1f/tqid/9DT0P/P4+r/yePv/8Pd5v/G4Oj/yuTs/8rj6//D3eT/xN3k/8Xe5f/E3uX/w97l/8Te5f/F3uX/xd7l/8Xe5f/F3uX/xd3n/8Xd6P/F2ur/xd3n/8Xe5f/F3uX/w9zj/8/n7/+Il6v/QVF8/y07af9laHv/r6KZ/5+Ph/+Zh3//kH95/4l4dP+EdHT/fW9z/3drcv9yaXP/bGZ1/2Zjd/9fYHj/Wl99/1phg/9VYYf/UWGN/1BklP9PZpr/T2mi/01sqf9NcLD/UXS5/1F4vv9Te8P/VX3H/1eAzP9Ygc3/XojX/0lpr/8+Tnv/VXOv/yU1dv8eLWn/GiZT/y8zWP9uW2H/n4yE/8XAuf/V4uT/xNnf/7HEyf+2yM3/0eXq/8ri6f/E3eT/xd7l/8Te5f/E3uX/xd7l/8Xe5f/F3uX/xd7l/8Xd5//G3ef/xdrq/8Xd5//F3uX/xd7l/8Lb4//Q6e//gJGo/0dlqf8fOIf/GSNY/0ZRfv9RaKD/UWqi/1Bvq/9Rc7P/U3e8/1R7w/9Vf8j/V4HN/1qF0/9dh9b/XorZ/12K2/9hjN7/Y47f/2SQ3v9lk97/aJLg/2mT3/9pkt3/aJHd/2iR3f9pkdz/aJHa/2qR2v9pkdn/Z47X/2WN2P9IZrH/RVqK/1t8t/82S4n/HShZ/zdLi/8iNnf/FS99/x4ua/87Oln/alxk/0BGYf9DWpD/OUuC/0tTcv++0dr/x+Hp/8Td5P/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3ef/xt3o/8Xb6v/F3ef/xd7l/8Xe5f/D3OP/z+nv/5qruP9HZab/Ijp9/xcgUP9QcLf/apbl/2OO2/9kj9v/Y47a/2SP2v9jj9n/ZI3W/2OJ0v9hhs7/XILJ/1t/xP9ZfL//V3i7/1Rzs/9TcK7/T2yo/0tnof9GYZr/Q1qT/z9Vi/86T4P/OEp7/zVEdP8xQG3/LDpl/ys1Xv8pMlj/ICJD/zE8Xv9KYpX/MEN2/x8rV/8fLl7/IzBq/yk+h/8kPoz/GzmN/xUxfv8ZLW7/Kjx7/yU5eP8XJF//sMHJ/8vl7P/E3eT/xd7l/8Xe5f/F3uX/xd7l/8Te5f/F3uX/xd3n/8be6P/F2ur/xd3n/8Xe5f/F3uX/xd7l/8fh6f+90df/Wnaj/zFHf/8YH07/MkN+/z9UiP9CVor/P1OG/z5Pf/8xPm3/KzVg/y43X/8zOl7/NDpa/zE0VP8sLkz/LS1I/zAtR/8yL0b/MzBH/zYyR/84NUr/PTpL/0I/T/9JRlb/UU5a/1lXYP9iXmf/aWdu/3Nyd/99fYD/hIWJ/5manP9iZ3b/S2qq/1iAyf84SYH/Z1df/0xJZf8sM2D/KjZv/yo1cf8hMXL/JD2H/yU/jv8WJGH/Qklo/8zi6P/E3eX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xd5//F3ej/xdrq/8Xd5//F3uX/xd7l/8Xe5f/D2+P/0Onv/4mcrv9JZaL/JC9i/xosbv8aLnX/FiFU/x4pZv8ZIFH/aGl2/42Pl/+Dgoj/dXB3/3V0ev+Pj5D/rLGx/663uv+zvMD/usPH/77Kzv/C0NT/xtXY/8ra3f/M3uH/zuHl/9Dk6f/S5+z/0unv/9Tq8f/V6/L/0+zz/9Dq8v/e+P3/hJar/1V+xv9gj9z/Mz9v/7Oonv/SzML/xMnJ/2x4kv85T47/QlyX/yMwaf8hM3f/DRdL/4yZo//R6/L/wtvi/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/xd7l/8Xe5f/F3ef/xd3n/8Xa6v/F3ef/xd7l/8Xe5f/F3uX/xd7l/8Xf5v/H3OT/W2uM/zE/c/8mNGz/IjRy/xooXv8aJ2j/IC1g/8XY3v/g+v//cIKc/0pop/8xRYH/Hy9v/217lv/X8ff/y+Xt/8rm7v/J5O3/yOPr/8fh6v/G4On/xd/n/8Te5f/D3eX/w9zk/8Lb4//B2uL/wdrh/8HZ4f++19//zeTr/3yNof9Se8P/XofM/yIya/8rPHL/VGKI/56ruP97hJT/YozU/3er+P8nP4n/MT1q/56stf/I4Of/xN7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd3n/8bd6P/F2ur/xd3n/8Xe5f/F3uX/xd7l/8Xe5f/C2+P/0Oft/3SHov9Vgcv/PFeY/x0ucf8gM3j/EyVr/3N7kf/P5u3/zOPp/36Nof9Sdrz/M0qL/w4gbf9KVXX/zuTp/8DY4P/C2+P/xNzl/8Xe5//G4Of/yeLp/8ni6//L5Oz/zufu/8/o7//Q6vD/0uvx/9Ts8f/U7PH/0unv/9/2+f+Glqn/UnzD/12Hzf8lPH//HDiJ/xUuf/8TKXP/HCxo/y9Ad/9XdrX/IjyH/0dWgP/Z7/H/w93l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xN7l/8Te5f/F3uX/xd7l/8Xd5//F3ej/xdrq/8Xd5//F3uX/w97l/8Pe5f/F3uX/w9zk/83l6/9zh6X/V4bR/z1cof8fOIf/IDN4/w8bWP+hqbb/2fL4/8/n8P/C1tv/W3Sr/0Fdo/8TJGb/orC9/973+//R6O7/0enu/8zh5v/J3eL/xtjc/8LS1v+7zNL/tcXM/66+xP+pt8D/oK65/5elsf+Om6z/g5Gl/3iGnv94hZ7/Ul5+/1qEyf9bhsr/Jjt//yI/kP8lQI//JUGR/yM/kf8aM4H/LUKG/yQ8hP9DU33/zOHl/8Td5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Te5f/D3uX/xd7l/8Xe5f/F3ef/xt3n/8Xa6v/F3ef/xd7l/8Pe5f/D3uX/xd7l/8Pc5P/O5ev/c4el/1eF0P89W5//HzN+/x0qaf8TIWT/XWJ2/8PS0v+1xMj/pa+1/0tcif8xRH7/Eh1R/2x2i/97iqD/aHSM/2Fuif9jdpn/Wm2U/1Fmk/9MZZT/R2GV/0pkmv9OaqH/Q1+Z/0JenP9CYJ//RmOi/0hmpf9Ka6r/T3Ct/0FWh/9chMj/XIfM/yM1cv8XKWL/HTJz/yE4f/8jO4X/ITyL/y9JkP8iN3//RVSA/87k5//E3eX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/xd7l/8Xe5f/F3uX/xd3n/8bd6P/F2ur/xd3n/8Xe5f/D3uX/w97l/8Xe5f/D3OT/zuXr/3OHpP9WhM//PVqd/xwvef8bKGr/JDVx/zhPgv9OZZj/R2Gb/0tnoP9KZ6P/VHKx/1p7u/9Qc7X/VXe6/1Zzrv9ge6//Y4TD/3CPw/+HptL/iqjR/5q22f97lLr/YXag/7LH3P+yyNv/t8ve/7vP3v+90d3/zODm/56tuP83QGD/XojM/1mDyf8iLVf/ICta/yIvZf8eLWr/Hi1r/xstcP8pPHn/IjZ8/0VUgP/O4+f/xN3l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xd5//F3ej/xdrq/8Xd5//F3uX/w97l/8Pe5f/F3uX/w9zk/83l6/9yhqP/VoPP/0Jdnf8iL2D/GCNX/yg4av9be7n/WnKf/4OWrf9ccpT/TGij/yw/eP9KVnj/t8LE/3qElv9PW3P/u8PC/1Rbcv9dY3P/sre2/5ykqP+hqaz/eYGN/y82Uv+Bh5L/fYSR/3J5iP9pcYP/YWl+/1xmfP9JUW3/Ji1Q/1+Kzv9Xgcb/PVCE/zBFgf8kMWX/JDuF/yQ/jv8gN4H/JDl//xoveP9HV4H/z+Pn/8Pd5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3ef/xd3n/8Xa6v/F3ef/xN7l/8Pe5f/D3uX/xN7l/8Lb4//R6O7/eY2p/1F+zP9LaKX/PFCA/xohS/8gLF3/Kjt0/y84Yf9HTm7/Ljll/yw9d/8hLmb/LDlq/0JOe/89S33/MUB2/zpJfP85Sn7/MkN6/zJDef8wQ3n/Lj93/zNCe/84SH7/LD12/y0+ef8vPnv/MEB9/zJAfv8xP3//MEGC/zE/dv9dhsn/WobM/yAzdP83Snr/JjNg/xooZ/8gN37/IjqI/yQ+jf8TJ3H/SVmD/83k5//D3eX/xd7l/8Te5f/D3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd3n/8Xd6P/E2ur/xd3n/8Te5f/D3uX/w97l/8Td5P/G4Of/wtXd/1Jggv9YhtT/RF6a/yo5bP8sPHH/Qluc/zxVkv9BWpn/P1ST/0VZlf9GWI7/Q1WK/zVIfP85SoD/NkV4/zZEc/83Q3D/OENs/ztEa/86RGf/OkVm/z9JZ/9CS2n/RE1r/0dQbf9JUm3/TVZw/1Nbcv9ZYXb/XWV5/2Rtf/9OV3H/WoXL/1mFyf8lO4D/JTx+/1dmiv9FTGf/Nj1Y/y43Yf8kMmj/FSRo/0pahf/M5Of/w93l/8Xe5f/E3uX/w97l/8Xe5f/F3uX/xN7l/8Te5f/E3uX/xd7l/8Xd5//F3ej/xdrq/8Xd5//E3uX/w97l/8Pe5f/D3OP/zujv/5uuuf8xQWv/YI7Z/0Jdm/82UI3/GShc/x4rZP8WH0r/FxxB/wYCAv8ODyb/DA86/zU2Tf+PkJb/Jyk0/0BBTP+WmqD/maCl/5adov+Yn6T/maGn/5miqP+boqr/m6Or/5qkrP+apKz/mKKr/5ehqv+XoKr/lp+q/5Gcp/+Un6v/aHGJ/1eDyP9ahsr/Jz2B/xcxhP9QVnf/VFlr/z1BV/8vNEz/KjZp/xknZP9LWob/y+Ll/8Lb4//F3uX/xd7l/8Te5f/D3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3ef/xd3n/8Xa6v/F3ef/xd7l/8Pe5f/D3uX/w9zk/8zm7f+ou8P/M0Bm/1+N2v9BW5L/GyRL/wwSOP8VHEb/JC9d/xYaOP8SEyf/IidN/yEoWP8zOl3/aW+J/01VcP9VXHn/WmKB/1Jaef9OVnj/S1R2/0hTc/9IUnL/SVNz/0lSdP9HUXP/RU9y/0NMcf9CTHL/Qkxy/z9KcP8/SW7/Pkhu/zY/Zf9bh8v/WobL/yY9gP8eOIf/NT5m/zY9W/83P1v/OUFd/yg1a/8VI2H/TVyF/9rw8//K4uz/xNzj/8Xe5f/F3uX/xN7l/8Xe5P/F3uX/xN3k/8Xe5f/F3uX/xd3n/8bd6P/F2ur/xd3n/8Te5f/D3uX/w97l/8Xe5f/F3+b/xNrg/1Rjgv9Zh9X/PlmV/ztPiP8tPG3/KTVg/yY4df8XGT3/RE9z/1Bfhf9UYoj/UV+H/0VRef9LVXz/SVR5/0RQdv9CT3f/QU14/0FNev8/Tnr/P096/0BPef8/Tnn/PEp5/zlIdf82RXX/NEJ2/zFBc/8uPnD/LTxv/yc3av8nM2L/XYjM/1uHy/8mPX//HTmH/yQxY/8kMFf/HCNI/ykqPP8fIDj/EBY+/yAmTP9MUWD/sMHL/8vj7f/B2uP/xN7l/8Xe5//G3+j/xuDo/8nj6//F3+b/xN3k/8Xd5//G3ef/xNvq/8Xd5//E3uX/w97l/8Pe5f/F3uX/wtri/87k6v91iab/U4LP/0RfoP8pQIP/JTyB/zhKhf8tPXf/IjR8/xolXP8UGTj/GiRO/xQeRv8qNVz/LTpg/zA9Zf8yPmb/Mz9n/zRAZ/81QGb/OD9j/zk/X/87QFz/PEFa/z5CWf89QVb/Pj9U/0FBVv9JR1z/UExf/1RRYf9jXmv/UFFm/1iDyf9ahcn/JTt//yA7if8cJU//FBpB/xQZNf8cJlD/IzNx/yM0bf8bJFn/Bgs8/0NJYv/R5Or/0Obs/8zi5//J3uT/xtrf/8TY2v+4ytD/x93k/8rj6v/F3Ob/x97o/8Xa6v/F3ef/xd7l/8Te5f/E3uX/w9zj/8jh6f/a8vf/domn/1SDz/8/Wp//GS12/xs2g/8mPoL/Fidb/wogaP8cJ0//DxIl/x4hM/9iXFz/e3R0/4F5eP+Cenj/h3x5/4p9ev+Mfnn/jH55/4+Aef+Sg3r/lYV8/5eGfP+aiX3/nIt+/5yNf/+fj4H/opKF/6SVif+snZD/hn13/1hbav9ij9j/YI/U/ylDiP8ZM4P/SE9r/3yBiP8pNV3/OVOU/0tpq/8zTI3/Hixp/xwiVv8cIk7/S1Vx/1Nef/9LVnr/RlN5/0FOeP8+S3j/HShO/2Bqff/J3uf/xt3n/8bd5//F2ur/xd3n/8Xe5f/E3uX/xNzk/8/m7/+zxc7/nKmw/2Jxjv9Yh9H/Plqe/x0weP8dNoT/SVJ5/46Pk/+UlJv/rKur/7Kxr/+5trX/1c3I/9TMx//X0Mr/29XP/9/a1f/i3tj/5uLb/+jj3v/p5uL/7enk/+/r5//u7Oj/8O7r//Hv6//y8Oz/8vDt//Lw7f/x8O3/9/Xu/05Taf8FDS3/OlCK/zRLi/8QFz//DRNA/z1CWP+DiZL/PU+A/0dlqv9Sb6//JzZs/zxXoP9WftT/VHzO/094zP9OeM7/U3zT/1aA2P9diN//XYfc/05wqP9JZ4n/hpen/9Hn8f/E2+X/xdvq/8Xd5//F3uX/w9vj/9Dn8P+QoLL/HydJ/wsMMf8vP23/Zprh/z9ep/8bLXX/GiJP/6yrqf/d3NX/0c/M/8zKx//Ry8j/zsrF/8bCvv/FwLz/w765/7+5tP+8ta7/uK+n/7Kqov+tpJz/qJ+X/5+blP+clY7/mZCH/5WLgf+RhXv/jIB2/4h7cv+Ddm//f3Ns/3NoZf9DTm7/OEp2/zdIef86TH//RFeH/zdGdf8HDDH/JStL/0daiv9DYKn/SmSl/xohSP9AU3X/aoy4/2OArP9kgqz/aISr/2mFqv9th6r/aYKi/1pzk/80RGb/ZXWH/77T3f/J3+n/xt3n/8Xa6v/F3ef/xN3j/8vk7P+zw87/Kzlj/yAybf8fLGD/Fxw7/zhOhv8xQW//FhxE/xkZMf8sLD3/NDVI/yIpRf8fIjb/Qj1H/09IUP9OSE//T0lQ/1BLUv9RS1X/UU1X/1JPW/9SUF//UVFj/05QZ/9LUWn/T1Vs/1Rab/9VXHP/V113/1hhev9YZX//WGaG/1tskf9OXYT/WXu4/2+f7f9rmeH/Z5La/2qX4f9Naab/DxM2/z5IYf9TZpD/ZYzK/2GCtP82RHD/IzVs/yU1a/8fKU//HyZE/6Ovuv+0xs//tsbO/7DAyf+cqrb/iJCd/8PX4f/L4uv/xN3k/8fe5//E2ur/xd3n/8Lb4v/T7PP/dYGT/yU6df8kNXf/LTtw/0xmlv9PaqH/U2+g/1d0pf9ee7L/X321/2B+tv9ggLz/YoLB/1+Bwf9fgML/XYDD/11/w/9bfsb/W3/G/1x+yP9afcf/W37G/1p/yP9Xfsr/VX7K/1V9yv9VfMf/UnrF/1F5xf9RecP/TnjB/092vf9Rd7v/S2yu/zFAav9GVXX/XXaj/1Ztmf9FUnj/PUp1/xgiT/+DjZ7/dIOh/16FwP9vk8b/PU5//01bhf9iea3/NUhx/zE5V//H2+T/zefu/8nj6v/M5u3/zeXt/6a2wf/K4ur/xNvl/8Xe5f/H3uf/xdrq/8Xd5//C2+L/0erw/2dziP8tQX3/JDh7/0BVgv9PZpj/U3Co/1BqoP9RaqD/TWSa/01jmf9KYZb/R12U/0ZZkf9GWI7/R1iM/0ZYjP9HWIv/SFmK/0dZiP9LW4f/Tl2H/1Ngif9WY4r/WWaM/11pj/9ebY//ZHCQ/2p0kv9teZX/cnuX/3Z+mf95gpr/f4ea/4eNn/8hLFL/CxQ2/2GJ0f9XgMn/Jzd1/zFFif8aJ1b/XGV6/zI5U/8vQn3/T3C3/zdKhP94f5b/bXmS/wsUPf9FTWz/y+Do/8Tc5P/E3eT/xd7l/8Pa4v+drLj/yN7n/8Xd5f/F3uX/xt7n/8Xa6v/F3ef/wtzi/9Hq8f+DkaL/Okt4/y8/dP8qN2T/JSxO/zNBb/8vPm//M0Ny/1h2vv8qNmf/GCBV/0JGX/+QjIn/2dfR/+3s5P/t7OX/8vDs//X07//49vH/+vjz//389/////n////7/////v//////////////////////////////////////////////////////1M/K/3Byf/9ahc3/XIXK/y9Hj/8fOI3/UFdy/5eao/9RV2n/GSBJ/yozWP8kL1f/KDJi/z1DXv8eIz//eIWV/9Lr8f/C2+L/xd7l/8Xe5f/E3eX/m6y3/8fd5f/F3uX/xd3n/8Xd6P/E2ur/xd3n/8Td5P/H4Of/wNXg/1FZcf80P2H/GyZg/ys8av9chsn/OFGR/zZKgf9fiNr/GyVS/w0UPf88PFP/g3x6/7ewrP/Fvrj/wLmz/761r/+6saz/uK6o/7Sqpf+wpqL/rKKf/6ifnP+km5j/n5eU/5yUkP+XkIz/lI2J/5KLhv+NhYH/iYF//4Z/fv+DfHz/fnp6/4yHhf9dX23/WYXN/1qDx/8zTpf/HDKC/1xecf/IyMn/Zml9/yEmRf8/PEH/LCxF/1hjgP/M4ej/vtHZ/8Tb4//G4Ob/xd7l/8Xe5f/F3uX/xt/m/5ytuP/F2+T/xd/m/8Xe5v/H3ef/xdrq/8Xd5//F3uX/w93k/8vj6/+90Nn/a3eK/01Taf9EU3j/YJLc/zlSj/8qPHD/WH3H/yEnT/8hJj//HyIx/zM1Qv9CQUz/QUBL/0A+Sv8+PEn/PTxJ/0A9R/9BP0f/QT9I/0JARv9DQkf/RURJ/0ZETP9GR03/R0hO/0lLUv9NTVT/TU5U/01OU/9MTlT/S01W/1BSWv8gJTv/FiFE/2CLz/9bhcz/JTRv/xceTP8IEUD/ISZD/1BVZv9DQ1H/S0tX/09UY//F2eP/xd7l/8ji6f/G3+b/xd7l/8Xe5f/F3uX/xN3k/8fg5/+gsLr/xNri/8Xf5v/F3uX/x97n/8Xa6v/F3ef/xd7l/8Xe5f/E3eT/yePq/8/p7//Y7/L/doun/1aFzv89WJP/IzBf/yg5av8XHT7/MkFu/1JSXv+Bf4H/qqip/6Sgof+loqb/pqar/6mprP+qqq3/q6qr/6yqqv+urKv/r6yp/7Ctqf+xrqz/sK+u/7Gxsf+0s7H/trOw/7eysP+3s7H/tbGv/7a0sv+jo6X/KS9R/xwkRP9hjNL/WYPI/zdLfP9FYZX/FShp/3+Opv/P3uH/S0pU/01NV/9eZG//0ejy/8Td5P/E3eT/xd7l/8Xe5f/E3uX/xd7l/8Td5P/I4ej/obC7/8PZ4P/G4Ob/xd7l/8fe5//F2+r/xd3n/8Xe5f/F3uX/xd7l/8Td5P/A2uL/zOTo/3GGov9YhtL/OlGK/yMyXf8iLFf/CQom/xQYM/8eHCf/Qz0+/2pmZP9oZGX/Z2Zo/2Nmav9lZ2n/Z2dp/2ppaf9ramf/a2pm/2xpaf9raWf/amlm/2poZv9qaGX/a2Zi/2tmYP9rZV//aGNf/2ZhXv9jXln/TlFb/yk7bv8dJU7/Yo7T/1mDxv9GXI3/VnKp/xMmaP91g53/vs7T/0pKVP9QUVj/X2Vw/83k7P/D3eP/xd7l/8Xe5f/F3uX/xN7l/8Xe5f/E3eT/yuPq/5+vuf/B1t7/xuDn/8Xe5f/G3uf/xdrq/8Xd5//F3uX/xd7l/8Xe5f/F3uX/w9zk/87m6v90iKb/UXzG/zZHd/9GXY7/Iy1c/zlKgf9AUoX/PlB9/0hZgv9CU3v/QlN7/0RWfv9FWH//Sl+B/09ggv9JWoD/SVl+/0lZff9MXID/TF6B/01fgv9OYIX/TWCG/05hhv9OYof/TmGH/05ihf9OY4b/T2KG/0pegf9OaZj/HCZI/2CLz/9bic//Ii1f/xwwdv8TLX3/doSb/8HR1f9KSVT/UE9X/15lb//O5e3/xNzj/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xN3k/8zj6v+er7n/vdPb/8fh6P/F3uX/xt7n/8Xa6v/F3ef/xd7l/8Xe5f/F3uX/xd7l/8Pc5P/O5ur/c4mm/1N+yP9BV4//UGaV/yo0Yv85SXv/QVOA/0Vclf9RYpL/jpey/5Kbtf+Rm7T/kpq0/5igtv+fprf/lp2y/5Scsv+UnbP/lp60/5ees/+Yn7P/mJ+0/5iftP+YoLb/mKC2/5aftv+XobX/lqC0/5mluf9+jKH/Wnik/yApTP9gi83/WojP/yg4dv8jNXj/FC18/3WEm//C0db/SUlT/09OV/9dZG3/zeXt/8Pc4//F3uX/xd7l/8Xe5f/F3uX/xd7l/8Td5P/L5ev/na23/7rQ2P/H4ej/xd3l/8fe5//F2ur/xd3n/8Xe5f/F3uX/xd7l/8Xe5f/D3OT/zubq/3KGpf9Wgs3/OlWa/yMwa/86R3P/AwQh/xccO/8TH07/PkNl///+7P////T////y////8/////L////y////8/////L////z////8v////L////z////8v////L////w////8P////H////y////8f////b/+vLo/09ehv8ZIEn/Yo7Q/1mGyv8pQIT/Jjh4/xMpdP90g5v/wM/U/0dHUv9PTlf/XGJr/8zj6v/D3OP/xd7l/8Xe5f/F3uX/xN7l/8Te5f/E3OP/yuTr/5mps/+4zdX/yOLp/8Td5f/H3uf/xdrq/8Xd5//F3uX/xd7l/8Xe5f/F3uX/w9zk/87m6v90hqb/VX/N/z9Znv8aLHL/Lz9+/y03af8aHjv/Fxsz/zQ8W/92eoz/e3+P/3x/j/+AgI//g4KQ/4SDkv+FhJL/h4aT/4mHk/+LhpP/jYiU/42Klv+OjJb/kI2Y/5KPmv+UkZz/lpOd/5aUnf+Wlpz/lJOc/5+do/9dX3T/JzRc/2CL0P9ahsn/KUCF/yo+gv8TK3b/fo6l/8vb4P9JSVT/UlJb/2Jnb//c8ff/xN3l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/wtvi/9Pt9P+is77/tMjS/8rj6v/E3eT/xt7n/8Xa6v/F3ef/xd7l/8Xe5f/F3uX/w9zj/8DZ4f/M5Oj/c4Wl/1SAzf89WJ7/HC5z/yE6hf8uPXj/JixN/x0kRf85QWf/lZSe/5eXo/+TlJ//k5Kf/5KQof+RkKD/j4+e/42Onf+Mjpz/jIuc/4uLnP+Jipr/h4iZ/4WHmf+FiJn/hYeX/4SGlv+DhpX/gYWU/4GEk/9+gJD/jo6a/2RpgP9YhMv/XIfM/yg/hf8oPoX/EiRj/1phb/+fpaj/OzY8/09MUv9MTlb/rLe9/8fc5f/E3ub/xN3k/8Te5f/F3uX/xN3k/8vh6v+0xs//eYOM/7fK1P/L4+z/xd3k/8fd5//F2ur/xd3n/8Xe5f/F3uX/w9zj/9Do8P/S6fL/3PHz/3yOq/9Rf8z/PVqf/xwudP8kQI3/HChk/zc+Y/8dJ1H/SVB5////+f///////////////////////////////////////////////////////////////////////////////v////7////9/////f////z////6//////+np7D/T3vD/1+Jzv8pQIb/HSth/xcdQ/8YJVn/Jzx4/0Rem/8uOmX/GiNL/xMfWv+Jlaf/0+30/8Te5v/H4Oj/xd3n/9Dp8v+errz/GiFB/yk3Xf+Mmqf/0eny/8Pb5P/G3uf/xdvq/8Xd5//F3uX/xN3k/9Dm8P+hrrj/XGJw/0VJXP8/TW3/W4rW/zxZn/8aKGf/FyFP/w8SL/8cHzr/GyE+/zlAZP+LjJT/lZSZ/5qWlP+emJX/oJqW/6Gbl/+jm5n/ppya/6eem/+ooJ3/q6Kf/66lov+xqaX/tKun/7ewqv+5sqz/vrWw/8K4sv/CurX/xLy3/8O7tv/Z0Mb/h4aT/1N/x/9fidD/Kzx3/yMvX/8mNnH/M1Gn/zpguf9Ca8P/LTx2/zBKlP8qTKX/WmJ8/9Hj4//D1Nn/xdba/8LU2P/P4OH/XmqF/xknWP8xQXb/R1F0/8vg5P/G3Of/xt3n/8Xa6v/F3ef/wtvi/9Lr8/97hZT/BwkS/xAZPf8JDS3/Kzdc/1+N2v86VZn/GyZV/xcgT/8UG0H/GB42/xIVK/8yOVH/bnB9/25we/9oaGn/bmpo/25raP9va2r/b2pq/3Brav9saGf/amRk/2VgYf9iXV//Ylxf/2BcXv9dWlv/XFha/1xXWf9bVlf/WlRW/1hSVf9cVlj/Lyk0/yAkQP9gi9L/XIbM/yo3Y/8wQXj/M0N6/zdOjv82U5//QV+j/zJAc/8hMGz/M0+e/zA7Zv9IXY7/Sl+R/0ldj/9MX5D/R1iK/zxRhv8iMWX/IC5Q/09xh/+4ytP/yuLs/8bc5//E2ur/xNvl/8vl7P+sv8v/Exkp/xsqQf84RGr/pqyu/0BNbv9bitj/PViW/zdKf/8dMHX/b3GI/9DOy/++vL3/v769/8vJxf/KycT/yMbC/8fEwP/Ewb3/wb65/7+7tv+/u7X/vbmz/7q2sf+2tK//tbOu/7Wyrv+zsav/sK6p/7Ctqf+tqqf/qqmk/6elov+urKf/iYyQ/x4qVP8jLFz/YYzT/1uFyv8uPGj/O0+J/0RZj/9EXZb/MEiO/0tmpv9AT3z/LkWN/zZUqf9BS3L/b4ey/2uEsv9pg7L/aYS0/2R9rf9bdKb/Ljts/yYxYf88Unj/uczV/8nh6//F3ef/xdrq/8La5P/V7PP/ZG+C/xAePP8pO2H/NENx/2Bqfv9cZ4H/VITT/0Jdm/9feqX/MU+b/8PDyv////////////////////////////////////////////////////////////////////////////////////7////9/////P////v///76///9+f/7+vb////+/56ptP83Uof/Lzx6/2CM0v9ahMj/O057/0FXk/85S4L/Lj5u/yU6fP9NaKr/VmaI/zBIkf8cMYD/e4aU/9rx8v/J3uP/zOHl/8vf4//R5Ob/cIKb/y8+a/85T43/SFWA/8nd4v/G3ej/xt3n/8Xa6f/G3Of/y+Dn/0BJZ/8hNF3/KThp/1Rffv80R33/NUBh/12M2v84UpP/aYCi/y9Gi/9hZ4X/p6Wm/6Ojqv+trbD/t7e5/7u6vP++vb//wcDC/8XExf/Jycn/zc3N/9DQ0P/S0tL/1tXW/9rZ2f/d3Nz/4N/e/+Tj4f/n5eT/6ujn/+3s6v/w7+7/8PDv//36+P+grLj/U22a/yw6df9gjNP/WYPH/z1Qe/89U4z/HilS/z5Siv8vS5v/UG2s/1Vrjf8UGDf/VVtw/7nO1v/H4en/w9zk/8Td5f/C2+P/zOft/5iouf8sOmD/M0Nr/4KRov/R6fH/xNvk/8bd6P/E2un/yd/q/77S2f84RWf/KkBq/yo4av9KVHf/Jzdu/yk5af9ijtj/MUmO/0VYfv8+T3f/DxhT/xQgV/8ULH7/QU11/9LNyP/X0tH/0c3L/9DMyv/Mysb/ycbD/8XDv//Dwb7/wL68/768uv+9urn/vbm3/7u4tv+4t7T/trWy/7Sysv+ysK//sLCu/66urv+xsK//lpqg/01olP8fK1r/YIzR/1mDyv8+UHv/RFmN/yU2Z/8wQXb/MEF2/0Vckf8+UoD/Gh00/8bY3f/N5+7/w9zj/8Xe5f/F3uX/xd7l/8Td5P/L4+r/nq+6/5Skrf/J4uj/xd7m/8Xd5//H3ef/xNrp/8ng6v+80dj/PElp/ylAav9IVYT/p621/xokUP8nNWP/ZI7Y/zZPlP8uPnT/Ok58/xkfSP8YH0L/Ex5F/zg7Tf+WjYH/oJOI/6SVif+rmIz/sJyN/7ehkP+6ppP/vqqX/8Owmv/Isp3/zbWh/9C6pf/Svqn/1sKt/9rIsf/czbb/38+8/+PTwP/l1sT/5tnJ/+3ezv+enaL/RE5t/1yIy/9bhsv/RliF/05ilP8rPHb/LD58/x8pVP8bI0v/KTRs/yQrUP+zxMr/yePq/8Td5P/F3uX/xd7l/8Xe5f/F3uX/xN3k/87o7v/Q6vH/xd7l/8Xe5f/F3ef/xt3o/8Xa6f/H3ef/x93m/1Bbcv8vRm3/MUFw/ycuUv8YIVP/NkNq/2KL2f82TpH/MUWC/zBBgP8pNWv/JC9j/yIrWv8nMV3/LDhi/y04Yv8uOGH/LTdd/y41XP8uNVr/LzdY/zE3Vv8yNlP/NDdS/zY5Uf83O0//OzxP/zw8Tv8+PU3/QT9N/0NCTf9IRE7/S0ZP/0xIT/9RTFT/U0pO/zY4SP9ei9H/XIjM/0JVhv9QZZn/Lj5v/yQvXf8sO3b/MUB1/yo6ef9NVXX/zuLo/8Te5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/D3OP/w9zj/8Xe5f/F3uX/xd3n/8Xd6P/F2+r/xNrk/9Lp8f9zgJH/KDlT/y5Dcv8bJVD/gIyd/3SFov9Vf8//OFGW/y5Bfv87UJT/Q1ik/0Rdp/9HZK3/Smat/0hlqf9JZKj/SGGm/0VepP9EXaP/Q1yi/0Baof89WJz/O1SZ/ztTlf88UJH/Ok6Q/zlMjv82Sor/NEeG/zRGhv8yRYX/LkJ//yw/ev8rPnn/JjZt/yk9dP81S4H/XojM/16L0f83TYP/SFuO/ztPh/8rNmL/KjNV/zM+bf8lM2//aHSR/9Xt8//C2+L/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xd5//F3ej/xtvq/8Tc5f/J4+n/uMvX/yw2Sf8cLFL/V2KB/+7++/93iqr/U3/M/zhTlv8vQn//Ok+Q/0Vcov9JZKr/Wnu//2GDx/9kiMz/ZYnO/2WL0P9mjNL/ZozU/2SO1P9lj9X/ZI7V/2WN0/9ljNL/Y4rR/2OJz/9ih83/YIbK/1+Fyv9eg8v/XYPN/1yCzP9agcr/WXzH/0BfrP84U5z/RV+f/12Gy/9gjdL/OlKI/ys3aP81RHL/IitY/y05Zf8wO2X/GCJe/2t3lP/R6u7/wtvj/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/w97l/8Xe5f/F3uX/xd7l/8Xe5f/F3ef/xd3n/8Xb6v/G3ef/w9zj/87n7v+ktcH/P0ha/yErVP9SVWf/T1x4/12I1P85UpX/LT1v/yY2aP8gKlb/LDhn/0tXe/9GU3j/P050/0VUev9HWYH/RVmE/0Vahv9FW4n/RVuN/0ZdkP9JX5H/S2GU/0tilv9MZZv/S2ac/0xnoP9OaKT/Tmmk/09qpv9Sban/U2+r/05sqv83Upj/NkyM/z1Of/9fiM7/YYzU/zpPgv8hLWT/LTt0/y46cP8zPGH/Lzhb/xYgXv94hqD/0uvw/8Lb4v/F3uX/xd7l/8Xe5f/D3uX/w97l/8Pe5f/F3uX/xd7l/8Xe5f/F3uX/xd3n/8Xd6P/E2ur/xd3n/8Xe5f/D3OP/zeft/8/l7f+Xp7T/eISS/2Bxj/9Zgcr/NUuO/zI9ZP86Rmj/SVVw/x4tX/99hJn/eX6S/wUNQP+HlKL/s8XO/6O0v/+gsLz/nKu4/5eltP+SoLD/jZus/4iVqf+BjqP/fImf/3eEm/90gJb/cHqR/2x1jP9ncIj/YmyF/1xng/9WYoH/S1Nw/0ZYh/9DV4r/YorM/12Kz/9FW4//MTpd/y09ef8zQnf/Pkx9/y4zWP8XIWD/j52x/9Dq7//C2+P/xd7l/8Xe5f/F3uX/w97l/8Pe5f/F3uX/xd7l/8Xe5f/F3uX/xd7m/8Xd5//F3uf/xdrq/8Xd5//F3uX/xd7l/8Pc4//E3eT/zObt/9/4+/98kKr/T3a7/y1Agv8bKFr/h5Oj/258mf98iaD/R1Fz/yovTP8fKVz/tsjQ/9Tt9P/M5uz/zuju/87p7//P6vD/0Orw/9Hr8P/R6/H/0urw/9Pr8P/S6/D/0urv/9Hp7v/Q6O3/z+fs/8/l6//O5er/zeTq/8/g5P9keaf/FCVc/0tspv9kkNT/Ok6D/yMsVf8rN2X/LDtq/zVGff8hJkr/ICtm/6e3xf/M5u3/w9zj/8Xe5f/F3uX/w97l/8Pe5f/E3uX/xd7l/8Xe5f/E3uX/xN7l/8Xe5v/F3ef/xd3o/8Xa6v/F3ef/xd7l/8Xe5f/F3uX/xd7l/8HZ4f/N5uz/jJ6u/1R4t/80SpH/Hyhb/8XQ0P9ebYv/wtDZ/4OOnP8EDD//P0lw/8fd4f/D3OT/w9zj/8Pc4//D3OP/w9zj/8Pb4//D2+P/wtvj/8Lb4//C2+P/wtvj/8Pc4//D3OP/w9zj/8Pc5P/E3eT/xd7l/8Td5P/K4ur/g5Sq/256kv9Zcpn/YIjK/ztUjv8uOGX/V112/0lVff9MWXr/ERlG/zZDd/+/09v/yOHo/8Td5P/F3uX/xd7l/8Pe5f/D3uX/w97l/8Pe5f/D3uX/w97l/8Xe5f/F3uX/xd3n/8Xc6f/F2ur/xd3m/8Xe5f/F3uX/xd7l/8Xe5f/E3eT/yeTr/7PGzv9cean/RF+j/xolZ/90fpT/aHSJ/3+Hlf86Q2v/ER1a/3N/kv/T7PH/wtvi/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8vj6v/a8PX/d4um/1l+u/9IY6P/Rk1x/5CWpP9aaI3/cneE/xEfZv9bZ4v/0Obt/8Pc5P/F3uX/xd7l/8Pe5f/E3uX/w97l/8Pe5f/D3uX/w97l/8Pe5f/E3uX/xd7l/8Xd5//F3ej/xdvq/8Xd5v/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Pc4//O5uz/fpCn/0prrP8rOXn/Hi9w/yYyW/8cJVD/FSJf/yQsVP+7zdT/yePq/8Td5P/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/B2uL/y+Tr/6Cwvv9ScaH/XHy3/z5Nff9naXj/JCxG/y86bf8aKGj/kaCv/9Hp8v/D2+P/xd7l/8Xe5f/D3uX/xd7l/8Te5f/D3uX/w97l/8Pe5f/D3uX/w97l/8Xe5f/F3ef/xd3n/8Xa6v/F3ef/xd7l/8Pe5f/D3uX/w97l/8Xe5f/E3eT/x+Ho/7/T2/9ieJ7/PE+F/xkiWv8WJmf/FyVi/yMrUf+Wo67/zufu/8DZ4f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Te5f/D3uX/w97l/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/xN7l/8Te5f/E3uX/xd7l/8Xe5f/F3uX/xd7l/8Td5P/M4+r/eImf/1Jtov86T4n/Ex1O/xQbS/8QG1j/R09u/8vg6P/F3eX/xd7l/8Xe5f/E3uX/w97l/8Xe5f/F3uX/xd7l/8Pe5f/D3uX/w97l/8Pe5f/F3uX/xd3n/8Xd5//F2ur/xd3n/8Xe5f/D3uX/w97l/8Pe5f/E3uX/xd7l/8Lb4v/S7PL/kqKt/z5Vhf9DTXT/l6Gq/7G/x//G2OD/2fD3/8/n7f/Q6e7/xt/m/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xN7l/8Te5f/E3uX/xd7l/8Xe5f/F3uX/xN7l/8Xe5f/E3uX/xN7l/8Xe5f/F3uX/xd7l/8Xe5f/F3eT/xuDn/8bd5P+ClKn/XGuM/zxHbv8rOWj/Ult1/7vO1//J4+r/xN3k/8Xe5f/F3uX/xd7l/8Te5f/E3uX/xd7l/8Te5f/D3uX/w97l/8Pe5f/D3uX/xd7l/8Xd5//F3ej/xdvp/8Xd5//F3uX/w97l/8Pe5f/D3uX/w97l/8Te5f/E3eT/yuTr/6/Dzf84TX//bXyY/5+quf9rdYv/prfE/6O2xv+Yqbz/nK2+/8Tc5f/G3+b/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xN7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Td5P/G3+b/zebs/8rg5f/E2N3/v9PX/9Dn7P/J4un/w93k/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Te5f/D3uX/w97l/8Pe5f/D3uX/xd7l/8Xe5f/F3ef/xd3o/8Xb6f/F3ef/xd7l/8Xe5f/E3uX/w97l/8Pe5f/D3uX/xN3k/8rk6/+vw8v/SWWb/z9QeP8hNXL/HjR5/zlBZv9JWYL/R1iB/05cff+4zNb/yeLq/8Td5P/E3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xN7l/8Pe5f/E3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Pc5P/E3uX/xuDn/8jh6f/D3OT/xN3k/8Xe5f/F3uX/xd7l/8Xe5v/F3uX/xd7l/8Xe5f/E3uX/xN7l/8Te5f/D3uX/xN7l/8Xe5f/F3uX/xd3n/8Xd6P/F2+j/xd3n/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/xd7l/8Xe5f/G4Of/w9nh/26Dnf+Qn7L/lqa5/4iZrf/D1t//wNbc/8Ta3//H3eP/yODn/8Xe5f/G3+b/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xd5f/E3eT/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/G3+b/xd7l/8Xe5f/F3uX/xN7l/8Te5f/F3uX/xN7l/8Xe5f/F3uX/xd7l/8Xd5//F3ej/xdvp/8Xd5//F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7k/8fg5//K4eb/zuXs/8/o7f/P5+z/yeHo/8jh6P/I4ej/x+Dn/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xt/l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3ef/xd3o/8Xc6P/F3ef/xd7m/8Xe5v/F3uf/xd7m/8Xe5v/F3ub/xd7m/8Xe5v/F3ub/xN3m/8Td5f/D3OX/w9zk/8Td5f/F3ef/xd7n/8be5v/F3ub/xd7m/8Xe5//F3ub/xd7m/8Xe5//F3ub/xd7m/8Xe5//F3ub/xd7n/8Xe5v/F3ub/xd7n/8Xe5v/F3ub/xd7n/8Xe5//F3ub/xd7n/8Xe5//F3uf/xd7m/8Xe5//F3uf/xd7m/8Xe5//F3uf/xd7m/8Xe5v/F3uf/xd7n/8be5//F3uf/xd7m/8Xe5v/F3uf/xd7n/8Xe5//F3uf/xd7n/8Xe5//F3ub/xd3m/8bd6v/F3Of/xt3n/8bd5v/G3ub/x97n/8fe5v/H3ub/x97o/8fe5//H3uj/xt/n/8bf5v/G3uf/xt7n/8fe5//H3+b/x97m/8fe5//G3uf/xt7n/8be6P/G3uf/xt7n/8be5v/G3uf/x97m/8fe5v/H3+b/xt7m/8fe5//H3+f/x9/m/8bf5v/G3ub/x9/m/8fe5v/H3uf/xt7n/8be5v/G3uj/xt/n/8bf5v/H3+f/x9/n/8fe5//G3+f/xt/m/8be5v/H3ub/xt7m/8be5//G3uf/xt7n/8bf5//G3+f/x97o/8bf5//G3uf/xt7n/8be5//G3uf/xt7n/8bd6P/G3un/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=
// @supportURL         https://github.com/MapoMagpie/comic-looms
// @match              https://*.pixiv.net/*
// @match              https://steamcommunity.com/*
// @match              https://twitter.com/*
// @match              https://x.com/*
// @match              https://*.instagram.com/*
// @match              https://*.manhuagui.com/*
// @match              https://*.mangacopy.com/*
// @match              https://*.copymanga.tv/*
// @match              https://*.artstation.com/*
// @match              *://*/*
// @require            https://cdn.jsdelivr.net/npm/@zip.js/zip.js@2.7.57/dist/zip-full.min.js
// @require            https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js
// @require            https://cdn.jsdelivr.net/npm/pica@9.0.1/dist/pica.min.js
// @connect            *
// @grant              GM_getValue
// @grant              GM_setValue
// @grant              GM_xmlhttpRequest
// @downloadURL https://raw.githubusercontent.com/AzimsTech/Userscripts/release/release/Comic20Looms.user.js
// @updateURL https://raw.githubusercontent.com/AzimsTech/Userscripts/release/release/Comic20Looms.meta.js
// ==/UserScript==
(function(It,At,St){"use strict";var Q=typeof document<"u"?document.currentScript:null;function kt(s){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(s){for(const t in s)if(t!=="default"){const i=Object.getOwnPropertyDescriptor(s,t);Object.defineProperty(e,t,i.get?i:{enumerable:!0,get:()=>s[t]})}}return e.default=s,Object.freeze(e)}const ee=kt(At);class P{url;title;originTitle;downloader;tags;constructor(e,t){this.url=e,this.title=t,this.tags={},this.downloader="https://github.com/MapoMagpie/comic-looms"}}var je=typeof GM_getValue<"u"?GM_getValue:void 0,Fe=typeof GM_setValue<"u"?GM_setValue:void 0,ue=typeof GM_xmlhttpRequest<"u"?GM_xmlhttpRequest:void 0;const Et=s=>s.startsWith("zh")?1:s.startsWith("ko")?2:s.startsWith("es")?3:0,Lt=navigator.language,Tt=Et(Lt);class Rt extends Array{constructor(e){super(...e)}get(){return this[Tt]}}const Pt={imageScale:["SCALE","\u7F29\u653E","\uBC30\uC728","Escala"],config:["CONF","\u914D\u7F6E","\uC124\uC815","Ajustes"],chapters:["CHAPTERS","\u7AE0\u8282","\uCC55\uD130","Cap\xEDtulos"],filter:["FILTER","\u8FC7\u6EE4","FILTER","FILTER"],autoPagePlay:["PLAY","\u64AD\u653E","\uC7AC\uC0DD","Reproducir"],autoPagePause:["PAUSE","\u6682\u505C","\uC77C\uC2DC \uC911\uC9C0","Pausar"],collapse:["FOLD","\u6536\u8D77","\uC811\uAE30","Plegar"],colCount:["Columns","\u6BCF\u884C\u6570\u91CF","\uC5F4 \uC218","Columnas"],colCountTooltip:["The number of images per row in the thumbnail list. If the layout is Flow Vision, the final number of images per row will be influenced by the specific aspect ratio of the images.","\u7F29\u7565\u56FE\u5217\u8868\u7684\u6BCF\u884C\u56FE\u7247\u6570\u91CF\u3002\u5982\u679C\u5E03\u5C40\u4E3A\u81EA\u9002\u5E94\u89C6\u56FE\uFF0C\u6700\u7EC8\u6BCF\u884C\u56FE\u7247\u6570\u91CF\u53D7\u56FE\u7247\u7684\u5177\u4F53\u5BBD\u9AD8\u6BD4\u5F71\u54CD\u3002","\uC378\uB124\uC77C \uBAA9\uB85D\uC5D0\uC11C \uD55C \uC904\uC5D0 \uD45C\uC2DC\uB418\uB294 \uC774\uBBF8\uC9C0\uC758 \uAC1C\uC218\uC785\uB2C8\uB2E4. \uB808\uC774\uC544\uC6C3\uC774 \uBC18\uC751\uD615\uC778 \uACBD\uC6B0, \uCD5C\uC885 \uD55C \uC904\uC5D0 \uD45C\uC2DC\uB418\uB294 \uC774\uBBF8\uC9C0\uC758 \uAC1C\uC218\uB294 \uC774\uBBF8\uC9C0\uC758 \uAD6C\uCCB4\uC801\uC778 \uAC00\uB85C\uC138\uB85C \uBE44\uC728\uC5D0 \uC601\uD5A5\uC744 \uBC1B\uC2B5\uB2C8\uB2E4.","El n\xFAmero de im\xE1genes por fila en la lista de miniaturas. Si el dise\xF1o es adaptable, el n\xFAmero final de im\xE1genes por fila estar\xE1 influenciado por la proporci\xF3n de aspecto espec\xEDfica de las im\xE1genes."],rowHeight:["Row Height","\u6BCF\u884C\u9AD8\u5EA6","\uD589 \uB192\uC774","Altura de fila"],rowHeightTooltip:["This option is only effective when the layout of the thumbnail list is Flow Vision. The reference height per row, along with the number of images per row, jointly influences the final display effect.","\u6B64\u9879\u4EC5\u5728\u7F29\u7565\u56FE\u5217\u8868\u7684\u5E03\u5C40\u4E3A\u81EA\u9002\u5E94\u89C6\u56FE\u65F6\u6709\u6548\u3002\u6BCF\u884C\u7684\u53C2\u8003\u9AD8\u5EA6\uFF0C\u548C\u6BCF\u884C\u6570\u91CF\u5171\u540C\u5F71\u54CD\u6700\u7EC8\u7684\u5C55\u793A\u6548\u679C\u3002","\uC774 \uC635\uC158\uC740 \uC378\uB124\uC77C \uBAA9\uB85D\uC758 \uB808\uC774\uC544\uC6C3\uC774 \uBC18\uC751\uD615\uC77C \uB54C\uB9CC \uC720\uD6A8\uD569\uB2C8\uB2E4. \uAC01 \uD589\uC758 \uAE30\uC900 \uB192\uC774\uB294 \uD589\uB2F9 \uC774\uBBF8\uC9C0 \uAC1C\uC218\uC640 \uD568\uAED8 \uCD5C\uC885 \uD45C\uC2DC \uACB0\uACFC\uC5D0 \uC601\uD5A5\uC744 \uBBF8\uCE69\uB2C8\uB2E4.","Esta opci\xF3n solo es efectiva cuando el dise\xF1o de la lista de miniaturas es adaptable. La altura de referencia por fila, junto con el n\xFAmero de im\xE1genes por fila, influye en el efecto final de la visualizaci\xF3n."],threads:["Preload Threads","\u6700\u5927\u540C\u65F6\u52A0\u8F7D","\uB3D9\uC2DC \uB85C\uB4DC \uC218","Hilos de pre-carga"],threadsTooltip:["Max Preload Threads","\u5927\u56FE\u6D4F\u89C8\u65F6\uFF0C\u6BCF\u6B21\u6EDA\u52A8\u5230\u4E0B\u4E00\u5F20\u65F6\uFF0C\u9884\u52A0\u8F7D\u7684\u56FE\u7247\u6570\u91CF\uFF0C\u5927\u4E8E1\u65F6\u4F53\u73B0\u4E3A\u8D8A\u770B\u52A0\u8F7D\u7684\u56FE\u7247\u8D8A\u591A\uFF0C\u5C06\u63D0\u5347\u6D4F\u89C8\u4F53\u9A8C\u3002","\uD070 \uC774\uBBF8\uC9C0 \uBAA8\uB4DC\uC5D0\uC11C \uB2E4\uC74C \uC774\uBBF8\uC9C0\uB85C \uC774\uB3D9\uD560 \uB54C \uBBF8\uB9AC \uB85C\uB4DC\uD560 \uC774\uBBF8\uC9C0 \uC218\uC785\uB2C8\uB2E4.<br>\uC774 \uAC12\uC774 1\uBCF4\uB2E4 \uD074 \uACBD\uC6B0, \uB3D9\uC2DC\uC5D0 \uB85C\uB4DC\uB418\uB294 \uC774\uBBF8\uC9C0\uAC00 \uB354 \uB9CE\uC544\uC838\uC11C \uC0AC\uC6A9 \uACBD\uD5D8\uC774 \uD5A5\uC0C1\uB429\uB2C8\uB2E4.","Hilos m\xE1ximos de pre-carga"],downloadThreads:["Download Threads","\u6700\u5927\u540C\u65F6\u4E0B\u8F7D","\uCD5C\uB300 \uB3D9\uC2DC \uB2E4\uC6B4\uB85C\uB4DC","Hilos de descarga"],downloadThreadsTooltip:["Max Download Threads, suggest: <5","\u4E0B\u8F7D\u6A21\u5F0F\u4E0B\uFF0C\u540C\u65F6\u52A0\u8F7D\u7684\u56FE\u7247\u6570\u91CF\uFF0C\u5EFA\u8BAE\u5C0F\u4E8E\u7B49\u4E8E5","\uB2E4\uC6B4\uB85C\uB4DC \uBAA8\uB4DC\uC5D0\uC11C \uB3D9\uC2DC\uC5D0 \uB2E4\uC6B4\uB85C\uB4DC\uD560 \uC774\uBBF8\uC9C0 \uC218\uC785\uB2C8\uB2E4. 5 \uC774\uD558\uB85C \uC124\uC815\uD558\uB294 \uAC83\uC774 \uC88B\uC2B5\uB2C8\uB2E4.","Hilos m\xE1ximos de descarga, sugerido: <5"],paginationIMGCount:["Images Per Page","\u6BCF\u9875\u56FE\u7247\u6570\u91CF","\uD398\uC774\uC9C0\uB2F9 \uC774\uBBF8\uC9C0 \uC218","Im\xE1genes por p\xE1gina"],paginationIMGCountTooltip:["In Pagination Read mode, the number of images displayed on each page","\u5F53\u9605\u8BFB\u6A21\u5F0F\u4E3A\u7FFB\u9875\u6A21\u5F0F\u65F6\uFF0C\u6BCF\u9875\u5C55\u793A\u7684\u56FE\u7247\u6570\u91CF","\uD398\uC774\uC9C0 \uB118\uAE40 \uBAA8\uB4DC\uC5D0\uC11C \uAC01 \uD398\uC774\uC9C0\uC5D0 \uD45C\uC2DC\uB420 \uC774\uBBF8\uC9C0 \uC218\uC785\uB2C8\uB2E4.","En el modo de lectura por paginaci\xF3n, el n\xFAmero de im\xE1genes mostradas en cada p\xE1gina"],timeout:["Timeout(second)","\u8D85\u65F6\u65F6\u95F4(\u79D2)","\uC774\uBBF8\uC9C0 \uB85C\uB529 \uC2DC\uB3C4 \uC2DC\uAC04 (\uCD08)","Tiempo de espera (segundos)"],preventScrollPageTime:["Min Paging Time","\u6700\u5C0F\u7FFB\u9875\u65F6\u95F4","\uCD5C\uC18C \uD398\uC774\uC9C0 \uB118\uAE40 \uC2DC\uAC04","Tiempo m\xEDnimo de paginaci\xF3n"],preventScrollPageTimeTooltip:["In Pagination read mode, prevent immediate page flipping when scrolling to the bottom/top to improve the reading experience.<br>Set to 0 to disable this feature,<br>If set to less than 0, page-flipping via scrolling is always disabled, except for the spacebar.<br>measured in milliseconds.","\u5F53\u9605\u8BFB\u6A21\u5F0F\u4E3A\u7FFB\u9875\u6A21\u5F0F\u65F6\uFF0C\u6EDA\u52A8\u6D4F\u89C8\u65F6\uFF0C\u963B\u6B62\u6EDA\u52A8\u5230\u5E95\u90E8\u65F6\u7ACB\u5373\u7FFB\u9875\uFF0C\u63D0\u5347\u9605\u8BFB\u4F53\u9A8C\u3002<br>\u8BBE\u7F6E\u4E3A0\u65F6\u5219\u7981\u7528\u6B64\u529F\u80FD\uFF0C\u5355\u4F4D\u4E3A\u6BEB\u79D2\u3002<br>\u8BBE\u7F6E\u5C0F\u4E8E0\u65F6\u5219\u6C38\u8FDC\u7981\u6B62\u901A\u8FC7\u6EDA\u52A8\u7684\u65B9\u5F0F\u7FFB\u9875\u3002\u7A7A\u683C\u952E\u9664\u5916\u3002","\uD398\uC774\uC9C0 \uB118\uAE40 \uBAA8\uB4DC\uC5D0\uC11C \uC544\uB798/\uC704\uB85C \uC2A4\uD06C\uB864 \uC2DC \uB108\uBB34 \uBE68\uB9AC \uD398\uC774\uC9C0\uAC00 \uB118\uC5B4\uAC00\uB294 \uAC83\uC744 \uBC29\uC9C0\uD558\uC5EC \uC77D\uAE30 \uACBD\uD5D8\uC744 \uAC1C\uC120\uD569\uB2C8\uB2E4.<br>0\uC73C\uB85C \uC124\uC815\uD558\uBA74 \uC774 \uAE30\uB2A5\uC774 \uBE44\uD65C\uC131\uD654\uB429\uB2C8\uB2E4.<br>0\uBCF4\uB2E4 \uC791\uC740 \uAC12\uC73C\uB85C \uC124\uC815\uD558\uBA74 \uB2E8\uCD95\uD0A4\uB97C \uC81C\uC678\uD558\uACE0 \uC2A4\uD06C\uB864\uC744 \uD1B5\uD55C \uD398\uC774\uC9C0 \uB118\uAE40\uC774 \uD56D\uC0C1 \uBE44\uD65C\uC131\uD654\uB429\uB2C8\uB2E4. (\uBC00\uB9AC\uCD08 \uB2E8\uC704)","En el modo de lectura por paginaci\xF3n, evita el cambio inmediato de p\xE1gina al desplazarse hacia el fondo o la parte superior para mejorar la experiencia de lectura.<br>Establezca en 0 para desactivar esta funci\xF3n,<br>Si se establece en menos de 0, el cambio de p\xE1gina mediante desplazamiento siempre est\xE1 desactivado, excepto para la barra espaciadora.<br>Medido en milisegundos."],autoPageSpeed:["Auto Paging Speed","\u81EA\u52A8\u7FFB\u9875\u901F\u5EA6","\uC790\uB3D9 \uD398\uC774\uC9C0 \uB118\uAE40 \uC18D\uB3C4","Velocidad de paginaci\xF3n autom\xE1tica"],autoPageSpeedTooltip:["In Pagination read mode, Auto Page Speed means how many seconds it takes to flip the page automatically.<br>In Continuous read mode, Auto Page Speed means the scrolling speed.","\u5F53\u9605\u8BFB\u6A21\u5F0F\u4E3A\u7FFB\u9875\u6A21\u5F0F\u65F6\uFF0C\u81EA\u52A8\u7FFB\u9875\u901F\u5EA6\u8868\u793A\u4E3A\u591A\u5C11\u79D2\u540E\u7FFB\u9875\u3002<br>\u5F53\u9605\u8BFB\u6A21\u5F0F\u4E3A\u8FDE\u7EED\u6A21\u5F0F\u65F6\uFF0C\u81EA\u52A8\u7FFB\u9875\u901F\u5EA6\u8868\u793A\u4E3A\u6EDA\u52A8\u901F\u5EA6\u3002","\uD398\uC774\uC9C0 \uB118\uAE40 \uBAA8\uB4DC\uC5D0\uC11C \uC790\uB3D9 \uD398\uC774\uC9C0 \uB118\uAE40 \uC18D\uB3C4\uB294 \uBA87 \uCD08 \uD6C4\uC5D0 \uC790\uB3D9\uC73C\uB85C \uD398\uC774\uC9C0\uAC00 \uB118\uC5B4\uAC08\uC9C0\uB97C \uC758\uBBF8\uD569\uB2C8\uB2E4.<br>\uC5F0\uC18D \uC77D\uAE30 \uBAA8\uB4DC\uC5D0\uC11C \uC790\uB3D9 \uD398\uC774\uC9C0 \uB118\uAE40 \uC18D\uB3C4\uB294 \uC790\uB3D9 \uC2A4\uD06C\uB864 \uC18D\uB3C4\uB97C \uC758\uBBF8\uD569\uB2C8\uB2E4.","En el modo de lectura por paginaci\xF3n, la velocidad de p\xE1gina autom\xE1tica indica cu\xE1ntos segundos toma cambiar la p\xE1gina autom\xE1ticamente.<br>En el modo de lectura continua, la velocidad de p\xE1gina autom\xE1tica indica la velocidad de desplazamiento."],scrollingDelta:["Scrolling Delta","\u6EDA\u52A8\u8DDD\u79BB","Scrolling Delta","Scrolling Delta"],scrollingDeltaTooltip:["During non-native scrolling (custom keyboard scrolling, horizontal scrolling), the distance of each scroll.","\u975E\u6D4F\u89C8\u5668\u539F\u751F\u7684\u6EDA\u52A8\u65F6\uFF08\u6309\u952E\u6EDA\u52A8\u3001\u6A2A\u5411\u6EDA\u52A8\uFF09\uFF0C\u6BCF\u6B21\u6EDA\u52A8\u7684\u8DDD\u79BB\u3002","\uBE44\uAE30\uBCF8 \uC2A4\uD06C\uB864(\uC0AC\uC6A9\uC790 \uC815\uC758 \uD0A4\uBCF4\uB4DC \uC2A4\uD06C\uB864, \uAC00\uB85C \uC2A4\uD06C\uB864) \uC911 \uAC01 \uC2A4\uD06C\uB864\uC758 \uAC70\uB9AC\uC785\uB2C8\uB2E4.","Durante el desplazamiento no nativo (desplazamiento con teclado personalizado, desplazamiento horizontal), la distancia de cada desplazamiento."],scrollingSpeed:["Scrolling Speed","\u6EDA\u52A8\u901F\u5EA6","\uC2A4\uD06C\uB864 \uC18D\uB3C4","Velocidad de desplazamiento"],scrollingSpeedTooltip:["During non-native scrolling (custom keyboard scrolling, horizontal scrolling), the speed of scrolling.","\u975E\u6D4F\u89C8\u5668\u539F\u751F\u7684\u6EDA\u52A8\u65F6\uFF08\u6309\u952E\u6EDA\u52A8\u3001\u6A2A\u5411\u6EDA\u52A8\uFF09\uFF0C\u6EDA\u52A8\u7684\u901F\u5EA6\u3002","\uBE44\uAE30\uBCF8 \uC2A4\uD06C\uB864(\uC0AC\uC6A9\uC790 \uC815\uC758 \uD0A4\uBCF4\uB4DC \uC2A4\uD06C\uB864, \uAC00\uB85C \uC2A4\uD06C\uB864) \uC911 \uC2A4\uD06C\uB864 \uC18D\uB3C4\uC785\uB2C8\uB2E4.","Durante el desplazamiento no nativo (desplazamiento con teclado personalizado, desplazamiento horizontal), la velocidad de desplazamiento."],fetchOriginal:["Raw Image","\u6700\u4F73\u8D28\u91CF","\uC6D0\uBCF8 \uC774\uBBF8\uC9C0","Imagen sin procesar"],fetchOriginalTooltip:["enable will download the original source, cost more traffic and quotas","\u542F\u7528\u540E\uFF0C\u5C06\u52A0\u8F7D\u672A\u7ECF\u8FC7\u538B\u7F29\u7684\u539F\u6863\u6587\u4EF6\uFF0C\u4E0B\u8F7D\u6253\u5305\u540E\u7684\u4F53\u79EF\u4E5F\u4E0E\u753B\u5ECA\u6240\u6807\u4F53\u79EF\u4E00\u81F4\u3002<br>\u6CE8\u610F\uFF1A\u8FD9\u5C06\u6D88\u8017\u66F4\u591A\u7684\u6D41\u91CF\u4E0E\u914D\u989D\uFF0C\u8BF7\u914C\u60C5\u542F\u7528\u3002","\uD65C\uC131\uD654\uD558\uBA74 \uC6D0\uBCF8 \uD30C\uC77C\uC774 \uB2E4\uC6B4\uB85C\uB4DC\uB429\uB2C8\uB2E4. \uB354 \uB9CE\uC740 \uD2B8\uB798\uD53D\uACFC \uD560\uB2F9\uB7C9\uC774 \uC18C\uBE44\uB429\uB2C8\uB2E4.","Activar descargar\xE1 la fuente original, lo que consumir\xE1 m\xE1s tr\xE1fico y cuotas"],autoLoad:["Auto Load","\u81EA\u52A8\u52A0\u8F7D","\uC790\uB3D9 \uB85C\uB4DC","Carga autom\xE1tica"],autoLoadTooltip:["Automatically start loading images after entering this script's view","\u8FDB\u5165\u672C\u811A\u672C\u7684\u6D4F\u89C8\u6A21\u5F0F\u540E\uFF0C\u5373\u4F7F\u4E0D\u6D4F\u89C8\u4E5F\u4F1A\u4E00\u5F20\u63A5\u4E00\u5F20\u7684\u52A0\u8F7D\u56FE\u7247\u3002\u76F4\u81F3\u6240\u6709\u56FE\u7247\u52A0\u8F7D\u5B8C\u6BD5\u3002","\uBCF4\uAE30 \uBAA8\uB4DC\uC5D0 \uC9C4\uC785\uD558\uBA74, \uC0AC\uC6A9\uC790\uAC00 \uD0D0\uC0C9 \uC911\uC774 \uC544\uB2D0 \uB54C\uB3C4 \uC774\uBBF8\uC9C0\uAC00 \uD558\uB098\uC529 \uC790\uB3D9\uC73C\uB85C \uB85C\uB4DC\uB429\uB2C8\uB2E4. \uBAA8\uB4E0 \uC774\uBBF8\uC9C0\uAC00 \uB85C\uB4DC\uB420 \uB54C\uAE4C\uC9C0 \uACC4\uC18D\uB429\uB2C8\uB2E4.","Comience a cargar im\xE1genes autom\xE1ticamente despu\xE9s de ingresar a la vista de este script."],reversePages:["Reverse Pages","\u53CD\u5411\u7FFB\u9875","\uD398\uC774\uC9C0 \uC21C\uC11C \uB4A4\uC9D1\uAE30","Revertir p\xE1ginas"],reversePagesTooltip:["Clicking on the side navigation, if enable then reverse paging, which is a reading style similar to Japanese manga where pages are read from right to left.","\u70B9\u51FB\u4FA7\u8FB9\u5BFC\u822A\u65F6\uFF0C\u662F\u5426\u53CD\u5411\u7FFB\u9875\uFF0C\u53CD\u5411\u7FFB\u9875\u7C7B\u4F3C\u65E5\u672C\u6F2B\u753B\u90A3\u6837\u7684\u4ECE\u53F3\u5230\u5DE6\u7684\u9605\u8BFB\u65B9\u5F0F\u3002","\uCE21\uBA74 \uB0B4\uBE44\uAC8C\uC774\uC158\uC744 \uD074\uB9AD\uD588\uC744 \uB54C \uC774\uBBF8\uC9C0\uB4E4\uC744 \uAC70\uAFB8\uB85C \uBC30\uCE58\uD560 \uC9C0 \uC120\uD0DD\uD569\uB2C8\uB2E4. \uC77C\uBCF8 \uB9CC\uD654\uCC98\uB7FC \uC624\uB978\uCABD\uC5D0\uC11C \uC67C\uCABD\uC73C\uB85C \uC77D\uB294 \uC2A4\uD0C0\uC77C\uC758 \uC774\uBBF8\uC9C0\uC5D0 \uC801\uC6A9\uD558\uBA74 \uC88B\uC2B5\uB2C8\uB2E4.","Hacer clic en la navegaci\xF3n lateral, si est\xE1 habilitado, revertir\xE1 la paginaci\xF3n, que es un estilo de lectura similar al manga japon\xE9s, donde las p\xE1ginas se leen de derecha a izquierda."],autoPlay:["Auto Page","\u81EA\u52A8\u7FFB\u9875","\uC790\uB3D9 \uD398\uC774\uC9C0 \uB118\uAE40","Paginaci\xF3n autom\xE1tica"],autoPlayTooltip:["Auto Page when entering the big image readmode.","\u5F53\u9605\u8BFB\u5927\u56FE\u65F6\uFF0C\u5F00\u542F\u81EA\u52A8\u64AD\u653E\u6A21\u5F0F\u3002","\uC774\uBBF8\uC9C0 \uD06C\uAC8C \uBCF4\uAE30 \uBAA8\uB4DC\uC5D0 \uB4E4\uC5B4\uAC00\uBA74 \uBC14\uB85C \uC790\uB3D9 \uD398\uC774\uC9C0 \uB118\uAE40\uC744 \uD65C\uC131\uD654\uD569\uB2C8\uB2E4.","Paginaci\xF3n autom\xE1tica al entrar en el modo de lectura de imagen grande."],autoLoadInBackground:["Keep Loading","\u540E\u53F0\u52A0\u8F7D","\uBC31\uADF8\uB77C\uC6B4\uB4DC \uB85C\uB529","Sigue cargando"],autoLoadInBackgroundTooltip:["Keep Auto-Loading after the tab loses focus","\u5F53\u6807\u7B7E\u9875\u5931\u53BB\u7126\u70B9\u540E\u4FDD\u6301\u81EA\u52A8\u52A0\u8F7D\u3002","\uC0AC\uC6A9\uC790\uAC00 \uB2E4\uB978 \uCC3D\uC744 \uBCFC \uB54C\uB3C4 \uC790\uB3D9 \uB85C\uB529\uC744 \uACC4\uC18D\uD569\uB2C8\uB2E4.","Mantener la carga autom\xE1tica despu\xE9s de que la pesta\xF1a pierda el enfoque"],autoOpen:["Auto Open","\u81EA\u52A8\u5C55\u5F00","\uC790\uB3D9 \uC774\uBBF8\uC9C0 \uC5F4\uAE30","Abrir autom\xE1ticamente"],autoOpenTooltip:["Automatically open after the gallery page is loaded","\u8FDB\u5165\u753B\u5ECA\u9875\u9762\u540E\uFF0C\u81EA\u52A8\u5C55\u5F00\u9605\u8BFB\u89C6\u56FE\u3002","\uAC24\uB7EC\uB9AC \uD398\uC774\uC9C0\uAC00 \uB85C\uB4DC\uB41C \uD6C4 \uCCAB \uD398\uC774\uC9C0\uB97C \uC790\uB3D9\uC73C\uB85C \uC5FD\uB2C8\uB2E4.","Abrir autom\xE1ticamente despu\xE9s de que la p\xE1gina de la galer\xEDa se cargue"],autoCollapsePanel:["Auto Fold Control Panel","\u81EA\u52A8\u6536\u8D77\u63A7\u5236\u9762\u677F","\uC124\uC815 \uCC3D \uC790\uB3D9\uC73C\uB85C \uB2EB\uAE30","Plegar autom\xE1ticamente el panel de control"],autoCollapsePanelTooltip:["When the mouse is moved out of the control panel, the control panel will automatically fold. If disabled, the display of the control panel can only be toggled through the button on the control bar.","\u5F53\u9F20\u6807\u79FB\u51FA\u63A7\u5236\u9762\u677F\u65F6\uFF0C\u81EA\u52A8\u6536\u8D77\u63A7\u5236\u9762\u677F\u3002\u7981\u7528\u6B64\u9009\u9879\u540E\uFF0C\u53EA\u80FD\u901A\u8FC7\u63A7\u5236\u680F\u4E0A\u7684\u6309\u94AE\u5207\u6362\u63A7\u5236\u9762\u677F\u7684\u663E\u793A\u3002","\uB9C8\uC6B0\uC2A4\uAC00 \uC124\uC815 \uCC3D\uC774\uB098 \uCEE8\uD2B8\uB864 \uBC14\uB97C \uBC97\uC5B4\uB098\uBA74 \uC124\uC815 \uCC3D\uC774 \uC790\uB3D9\uC73C\uB85C \uB2EB\uD799\uB2C8\uB2E4. \uBE44\uD65C\uC131\uD654\uB41C \uACBD\uC6B0, \uCEE8\uD2B8\uB864 \uBC14\uC758 \uBC84\uD2BC\uC744 \uD1B5\uD574\uC11C\uB9CC \uCC3D\uC744 \uC5EC\uB2EB\uC744 \uC218 \uC788\uC2B5\uB2C8\uB2E4.","Cuando el mouse se mueve fuera del panel de control, este se plegar\xE1 autom\xE1ticamente. Si est\xE1 desactivado, la visualizaci\xF3n del panel de control solo se puede alternar mediante el bot\xF3n en la barra de control."],magnifier:["Magnifier","\u653E\u5927\u955C","\uB3CB\uBCF4\uAE30","Lupa"],magnifierTooltip:["In the pagination reading mode, you can temporarily zoom in on an image by dragging it with the mouse click, and the image will follow the movement of the cursor.","\u5728\u7FFB\u9875\u9605\u8BFB\u6A21\u5F0F\u4E0B\uFF0C\u4F60\u53EF\u4EE5\u901A\u8FC7\u9F20\u6807\u5DE6\u952E\u62D6\u52A8\u56FE\u7247\u4E34\u65F6\u653E\u5927\u56FE\u7247\u4EE5\u53CA\u56FE\u7247\u8DDF\u968F\u6307\u9488\u79FB\u52A8\u3002","Pagination \uC77D\uAE30 \uBAA8\uB4DC\uC5D0\uC11C \uB9C8\uC6B0\uC2A4 \uD074\uB9AD\uC73C\uB85C \uC774\uBBF8\uC9C0\uB97C \uB4DC\uB798\uADF8\uD558\uBA74 \uC77C\uC2DC\uC801\uC73C\uB85C \uC774\uBBF8\uC9C0\uB97C \uD655\uB300\uD560 \uC218 \uC788\uC73C\uBA70, \uC774\uBBF8\uC9C0\uAC00 \uB9C8\uC6B0\uC2A4 \uCEE4\uC11C\uC758 \uC6C0\uC9C1\uC784\uC744 \uB530\uB77C \uC774\uB3D9\uD569\uB2C8\uB2E4.","En el modo de lectura por paginaci\xF3n, puedes hacer un zoom temporal en una imagen arrastr\xE1ndola con el clic del mouse, y la imagen seguir\xE1 el movimiento del cursor."],autoEnterBig:["Auto Big","\u81EA\u52A8\u5927\u56FE","\uC774\uBBF8\uC9C0 \uBC14\uB85C \uBCF4\uAE30","Auto Grande"],dragImageOut:["Drag Image Out","\u62D6\u62FD\u56FE\u7247\u5230\u5916\u90E8","\uC774\uBBF8\uC9C0\uB97C \uBC16\uC73C\uB85C \uB4DC\uB798\uADF8","Arrastrar imagen hacia afuera"],dragImageOutTooltip:[`Enabling this option will restore the browser's default dragging behavior for images (saving the image to the directory where it was dragged), 
but will disable the magnifier and the ability to drag and move images.`,"\u542F\u7528\u6B64\u9879\u5C06\u6062\u590D\u6D4F\u89C8\u5668\u9ED8\u8BA4\u5BF9\u56FE\u7247\u7684\u62D6\u62FD\u884C\u4E3A(\u4FDD\u5B58\u56FE\u7247\u5230\u6240\u62D6\u62FD\u5230\u7684\u76EE\u5F55)\uFF0C\u4F46\u4F1A\u7981\u7528\u653E\u5927\u955C\u529F\u80FD\u4EE5\u53CA\u62D6\u62FD\u79FB\u52A8\u56FE\u7247\u4F4D\u7F6E\u7684\u529F\u80FD\u3002",`\uC774 \uC635\uC158\uC744 \uD65C\uC131\uD654\uD558\uBA74 \uC774\uBBF8\uC9C0\uC5D0 \uB300\uD55C \uBE0C\uB77C\uC6B0\uC800\uC758 \uAE30\uBCF8 \uB4DC\uB798\uADF8 \uB3D9\uC791(\uC774\uBBF8\uC9C0\uB97C \uB4DC\uB798\uADF8\uD55C \uB514\uB809\uD1A0\uB9AC\uC5D0 \uC774\uBBF8\uC9C0 \uC800\uC7A5)\uC774 \uBCF5\uC6D0\uB429\uB2C8\uB2E4. 
\uD558\uC9C0\uB9CC \uB3CB\uBCF4\uAE30\uC640 \uC774\uBBF8\uC9C0 \uB4DC\uB798\uADF8 \uBC0F \uC774\uB3D9 \uAE30\uB2A5\uC740 \uBE44\uD65C\uC131\uD654\uB429\uB2C8\uB2E4.`,`Habilitar esta opci\xF3n restaurar\xE1 el comportamiento de arrastre predeterminado del navegador para im\xE1genes (guardando la imagen en el directorio donde fue arrastrada). 
pero desactivar\xE1 la lupa y la capacidad de arrastrar y mover im\xE1genes.`],autoEnterBigTooltip:["Directly enter the Big image view when the script's entry is clicked or auto-opened","\u70B9\u51FB\u811A\u672C\u5165\u53E3\u6216\u81EA\u52A8\u6253\u5F00\u811A\u672C\u540E\u76F4\u63A5\u8FDB\u5165\u5927\u56FE\u9605\u8BFB\u89C6\u56FE\u3002","\uC774\uBBF8\uC9C0 \uBDF0\uC5B4\uAC00 \uC5F4\uB9AC\uBA74 \uC989\uC2DC \uD070 \uC774\uBBF8\uC9C0 \uBCF4\uAE30 \uBAA8\uB4DC\uB85C \uC804\uD658\uB429\uB2C8\uB2E4.","Entrar directamente en la vista de imagen grande cuando se haga clic en la entrada del script o se abra autom\xE1ticamente"],hdThumbnails:["HD Thumbnails","\u9AD8\u6E05\u7F29\u7565\u56FE","HD \uC378\uB124\uC77C","Miniaturas HD"],hdThumbnailsTooltip:["When the large image is loaded, whether to resample a clearer image from the large image as a thumbnail, will affect performance.","\u5F53\u56FE\u7247\u52A0\u8F7D\u5B8C\u6BD5\u540E\uFF0C\u662F\u5426\u4ECE\u6E90\u56FE\u91CD\u65B0\u91C7\u6837\u66F4\u52A0\u6E05\u6670\u7684\u56FE\u7247\u4F5C\u4E3A\u7F29\u7565\u56FE\uFF0C\u6B64\u9879\u4F1A\u5F71\u54CD\u6027\u80FD\u3002","\uD070 \uC774\uBBF8\uC9C0\uAC00 \uB85C\uB4DC\uB420 \uB54C \uD070 \uC774\uBBF8\uC9C0\uC5D0\uC11C \uBCF4\uB2E4 \uC120\uBA85\uD55C \uC774\uBBF8\uC9C0\uB97C \uC378\uB124\uC77C\uB85C \uB9AC\uC0D8\uD50C\uB9C1\uD560\uC9C0 \uC5EC\uBD80\uAC00 \uC131\uB2A5\uC5D0 \uC601\uD5A5\uC744 \uBBF8\uCE69\uB2C8\uB2E4.","Cuando se carga la imagen grande, el hecho de volver a muestrear una imagen m\xE1s clara de la imagen grande como miniatura afectar\xE1 el rendimiento."],pixivJustCurrPage:["Pixiv Only Load Current Page","Pixiv \u4EC5\u52A0\u8F7D\u5F53\u524D\u4F5C\u54C1\u9875","Pixiv \uD604\uC7AC \uD398\uC774\uC9C0\uB9CC \uB85C\uB4DC","Pixiv: Cargar solo la p\xE1gina actual"],pixivJustCurrPageTooltip:[`In Pixiv, if the current page is on a artwork page, only load the images from current page. Disable this option or the current page is on the artist's homepage, all images by that author will be loaded. <br>Note: You can continue loading all the remaining images by the author by scrolling on the page or pressing "Try Fetch Next Page" key after disabling this option.`,"\u5728Pixiv\u4E2D\uFF0C\u5982\u679C\u5F53\u524D\u9875\u662F\u4F5C\u54C1\u9875\u5219\u53EA\u52A0\u8F7D\u5F53\u524D\u9875\u4E2D\u7684\u56FE\u7247\uFF0C\u5982\u679C\u8BE5\u9009\u9879\u7981\u7528\u6216\u8005\u5F53\u524D\u9875\u662F\u4F5C\u8005\u4E3B\u9875\uFF0C\u5219\u52A0\u8F7D\u8BE5\u4F5C\u8005\u6240\u6709\u7684\u4F5C\u54C1\u3002<br>\u6CE8\uFF1A\u4F60\u53EF\u4EE5\u7981\u7528\u8BE5\u9009\u9879\u540E\uFF0C\u7136\u540E\u901A\u8FC7\u9875\u9762\u6EDA\u52A8\u6216\u6309\u4E0BShift+n\u6765\u7EE7\u7EED\u52A0\u8F7D\u8BE5\u4F5C\u8005\u6240\u6709\u7684\u56FE\u7247\u3002",'Pixiv\uC5D0\uC11C \uD604\uC7AC \uD398\uC774\uC9C0\uAC00 \uC791\uD488 \uD398\uC774\uC9C0\uC77C \uACBD\uC6B0, \uD574\uB2F9 \uD398\uC774\uC9C0\uC758 \uC774\uBBF8\uC9C0\uB4E4\uB9CC \uB85C\uB4DC\uD569\uB2C8\uB2E4. \uC774 \uC635\uC158\uC744 \uBE44\uD65C\uC131\uD654\uD558\uAC70\uB098 \uD604\uC7AC \uD398\uC774\uC9C0\uAC00 \uC791\uAC00\uC758 \uD648 \uD398\uC774\uC9C0\uC77C \uACBD\uC6B0, \uD574\uB2F9 \uC791\uAC00\uC758 \uBAA8\uB4E0 \uC774\uBBF8\uC9C0\uB97C \uB85C\uB4DC\uD569\uB2C8\uB2E4. <br>\uCC38\uACE0: \uC774 \uC635\uC158\uC744 \uBE44\uD65C\uC131\uD654\uD55C \uD6C4, \uD398\uC774\uC9C0\uB97C \uC2A4\uD06C\uB864\uD558\uAC70\uB098 "\uB2E4\uC74C \uD398\uC774\uC9C0 \uB85C\uB529 \uC7AC\uC2DC\uB3C4" \uD0A4\uB97C \uB20C\uB7EC \uC791\uAC00\uC758 \uB098\uBA38\uC9C0 \uC774\uBBF8\uC9C0\uB97C \uACC4\uC18D \uB85C\uB4DC\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.','En Pixiv, si la p\xE1gina actual est\xE1 en una p\xE1gina de una obra, solo se cargar\xE1n las im\xE1genes de la p\xE1gina actual. Desactive esta opci\xF3n si la p\xE1gina actual est\xE1 en la p\xE1gina de inicio del artista; en ese caso, se cargar\xE1n todas las im\xE1genes de ese autor. <br>Nota: Puedes continuar cargando todas las im\xE1genes restantes del autor desplaz\xE1ndote por la p\xE1gina o presionando la tecla "Intentar cargar la siguiente p\xE1gina" despu\xE9s de desactivar esta opci\xF3n.'],pixivRecordReading:["Pixiv Record Reading","Pixiv \u8BB0\u5F55\u9605\u8BFB\u4F4D\u7F6E","Pixiv \uAE30\uB85D\uC77D\uAE30","Pixiv Lectura de registros"],pixivRecordReadingTooltip:["Reading position recorded. A new chapter continuing from this position will be provided next time.","\u8BB0\u5F55\u9605\u8BFB\u4F4D\u7F6E\uFF0C\u518D\u6B21\u9605\u8BFB\u65F6\uFF0C\u5C06\u51FA\u73B0\u4E00\u4E2A\u65B0\u7684\u7AE0\u8282\u8868\u793A\u4ECE\u8BE5\u4F4D\u7F6E\u7EE7\u7EED\u9605\u8BFB\u3002","\uC77D\uAE30 \uC704\uCE58\uAC00 \uAE30\uB85D\uB418\uC5C8\uC2B5\uB2C8\uB2E4. \uC774 \uC704\uCE58\uC5D0\uC11C \uC774\uC5B4\uC9C0\uB294 \uC0C8\uB85C\uC6B4 \uC7A5\uC740 \uB2E4\uC74C\uC5D0 \uC81C\uACF5\uB420 \uC608\uC815\uC785\uB2C8\uB2E4.","Posici\xF3n de lectura registrada. La pr\xF3xima vez se publicar\xE1 un nuevo cap\xEDtulo a partir de esta posici\xF3n."],pixivAscendWorks:["Pixiv Ascending Works","Pixiv \u5347\u5E8F\u6392\u5217\u4F5C\u54C1","Pixiv \uC624\uB984\uCC28\uC21C \uC791\uD488","Obras Ascendentes Pixiv"],pixivAscendWorksTooltip:["Sort the artist's works in ascending order, from oldest to newest. (need refresh)","\u5C06\u753B\u5E08\u7684\u4F5C\u54C1\u4EE5\u5347\u5E8F\u65B9\u5F0F\u6392\u5E8F\uFF0C\u4ECE\u65E7\u5230\u65B0\u3002(\u9700\u8981\u5237\u65B0)","\uC544\uD2F0\uC2A4\uD2B8\uC758 \uC791\uD488\uC744 \uC624\uB984\uCC28\uC21C\uC73C\uB85C \uC815\uB82C\uD569\uB2C8\uB2E4. \uC624\uB798\uB41C \uAC83\uBD80\uD130 \uCD5C\uC2E0 \uC21C\uC73C\uB85C. (need refresh)","Ordena las obras del artista en orden ascendente, de las m\xE1s antiguas a las m\xE1s recientes. (need refresh)"],pixivImageServer:["Pixiv Img Server","Pixiv \u56FE\u7247\u670D\u52A1\u5668","Pixiv \uC774\uBBF8\uC9C0 \uC11C\uBC84","Pixiv Img Server"],pixivImageServerTooltip:["Replace Pixiv\u2019s default image server i.pximg.net with the proxy server you specify, such as i.pixiv.re, to achieve better loading speeds","\u5C06Pixiv\u9ED8\u8BA4\u7684\u56FE\u7247\u670D\u52A1\u5668 i.pximg.net \u66FF\u6362\u4E3A\u4F60\u6240\u6307\u5B9A\u7684\u4EE3\u7406\u670D\u52A1\u5668\uFF0C\u5982\uFF1A i.pixiv.re\uFF0C\u4EE5\u83B7\u5F97\u66F4\u4F73\u7684\u52A0\u8F7D\u901F\u5EA6\u3002","Pixiv\uC758 \uAE30\uBCF8 \uC774\uBBF8\uC9C0 \uC11C\uBC84 i.pximg.net\uC744(\uB97C) \uC9C0\uC815\uD55C \uD504\uB85D\uC2DC \uC11C\uBC84(\uC608: i.pixiv.re)\uB85C \uAD50\uCCB4\uD558\uC5EC \uB354 \uBE60\uB978 \uB85C\uB529 \uC18D\uB3C4\uB97C \uC5BB\uC73C\uC138\uC694.","Reemplaza el servidor de im\xE1genes predeterminado de Pixiv, i.pximg.net, por el servidor proxy que especifiques, como i.pixiv.re, para obtener una velocidad de carga mejor."],readMode:["Read Mode","\u9605\u8BFB\u6A21\u5F0F","\uC77D\uAE30 \uBAA8\uB4DC","Modo de lectura"],gridMode:["Thumbnail Mode","\u7F29\u7565\u56FE\u6A21\u5F0F","Thumbnail Mode","Thumbnail Mode"],readModeTooltip:["Switch to the next picture when scrolling, otherwise read continuously","\u6EDA\u52A8\u65F6\u5207\u6362\u5230\u4E0B\u4E00\u5F20\u56FE\u7247\uFF0C\u5426\u5219\u8FDE\u7EED\u9605\u8BFB","\uC2A4\uD06C\uB864 \uC2DC \uB2E4\uC74C \uC774\uBBF8\uC9C0\uB85C \uC804\uD658\uD558\uAC70\uB098, \uC774\uBBF8\uC9C0\uB4E4\uC744 \uC5F0\uC18D\uC73C\uB85C \uBC30\uCE58\uD569\uB2C8\uB2E4.","Cambiar a la siguiente imagen al desplazarse, de lo contrario, leer de manera continua"],stickyMouse:["Sticky Mouse","\u9ECF\u7CCA\u7CCA\u9F20\u6807","\uB9C8\uC6B0\uC2A4 \uACE0\uC815","Mouse adhesivo"],stickyMouseTooltip:["In pagination reading mode, scroll a single image automatically by moving the mouse.","\u975E\u8FDE\u7EED\u9605\u8BFB\u6A21\u5F0F\u4E0B\uFF0C\u901A\u8FC7\u9F20\u6807\u79FB\u52A8\u6765\u81EA\u52A8\u6EDA\u52A8\u5355\u5F20\u56FE\u7247\u3002","\uD398\uC774\uC9C0 \uC77D\uAE30 \uBAA8\uB4DC\uC5D0\uC11C \uB9C8\uC6B0\uC2A4 \uCEE4\uC11C\uB97C \uC6C0\uC9C1\uC5EC \uD558\uB098\uC758 \uC774\uBBF8\uC9C0\uB97C \uC790\uB3D9\uC73C\uB85C \uC2A4\uD06C\uB864\uD569\uB2C8\uB2E4.","En el modo de lectura por paginaci\xF3n, desplaza una sola imagen autom\xE1ticamente moviendo el mouse."],minifyPageHelper:["Minify Control Bar","\u6700\u5C0F\u5316\u63A7\u5236\u680F","\uCEE8\uD2B8\uB864 \uBC14 \uCD5C\uC18C\uD654","Minimizar barra de control"],minifyPageHelperTooltip:["Minify Control Bar","\u6700\u5C0F\u5316\u63A7\u5236\u680F","\uC5B8\uC81C \uCEE8\uD2B8\uB864 \uBC14\uB97C \uCD5C\uC18C\uD654\uD560\uC9C0 \uC120\uD0DD\uD569\uB2C8\uB2E4.","Minimizar barra de control"],hitomiFormat:["Hitomi Image Format","Hitomi \u56FE\u7247\u683C\u5F0F","Hitomi \uC774\uBBF8\uC9C0 \uD615\uC2DD","Formato de imagen de Hitomi"],hitomiFormatTooltip:["In Hitomi, Fetch images by the format.<br>if Auto then try Avif > Jxl > Webp, Requires Refresh","\u5728Hitomi\u4E2D\u7684\u6E90\u56FE\u683C\u5F0F\u3002<br>\u5982\u679C\u662FAuto\uFF0C\u5219\u4F18\u5148\u83B7\u53D6Avif > Jxl > Webp\uFF0C\u4FEE\u6539\u540E\u9700\u8981\u5237\u65B0\u751F\u6548\u3002","Hitomi\uC5D0\uC11C \uC774\uBBF8\uC9C0\uB97C \uC5B4\uB5A4 \uC885\uB958\uC758 \uD30C\uC77C\uB85C \uAC00\uC838\uC62C \uC9C0 \uC120\uD0DD\uD569\uB2C8\uB2E4.<br>Auto \uC124\uC815 \uC2DC Avif > Jxl > Webp \uC21C\uC73C\uB85C \uC2DC\uB3C4\uD558\uBA70, \uBCC0\uACBD \uD6C4 \uC0C8\uB85C\uACE0\uCE68\uC774 \uD544\uC694\uD569\uB2C8\uB2E4.","En Hitomi, obtener im\xE1genes por formato.<br>Si est\xE1 en autom\xE1tico, intentar\xE1 Avif > Jxl > Webp. Requiere actualizaci\xF3n."],ehentaiTitlePrefer:["Title Language Prefer","\u6807\u9898\u8BED\u8A00\u504F\u597D","\uC81C\uBAA9 \uC5B8\uC5B4 \uC120\uD638","Idioma del t\xEDtulo preferido"],ehentaiTitlePreferTooltip:["Many galleries have both an English/Romanized title and a title in Japanese script. <br>Which one do you want to use as the archive filename?","\u8BB8\u591A\u56FE\u5E93\u90FD\u540C\u65F6\u62E5\u6709\u82F1\u6587/\u7F57\u9A6C\u97F3\u6807\u9898\u548C\u65E5\u6587\u6807\u9898\uFF0C<br>\u60A8\u5E0C\u671B\u4E0B\u8F7D\u65F6\u54EA\u4E2A\u4F5C\u4E3A\u6587\u4EF6\u540D\uFF1F","\uB9CE\uC740 \uAC24\uB7EC\uB9AC\uAC00 \uC601\uC5B4/\uB85C\uB9C8\uC790 \uC81C\uBAA9\uACFC \uC77C\uBCF8\uC5B4 \uC81C\uBAA9\uC744 \uBAA8\uB450 \uAC00\uC9C0\uACE0 \uC788\uC2B5\uB2C8\uB2E4. <br>\uC5B4\uB5A4 \uAC83\uC744 \uC544\uCE74\uC774\uBE0C \uD30C\uC77C \uC774\uB984\uC73C\uB85C \uC0AC\uC6A9\uD560\uC9C0 \uC120\uD0DD\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.","Muchas galer\xEDas tienen tanto un t\xEDtulo en ingl\xE9s/romanizado como un t\xEDtulo en script japon\xE9s.<br>\xBFCu\xE1l quieres usar como nombre de archivo?"],reverseMultipleImagesPost:["Descending Images In Post","\u53CD\u8F6C\u63A8\u6587\u56FE\u7247\u987A\u5E8F","\uD3EC\uC2A4\uD2B8 \uC774\uBBF8\uC9C0 \uB0B4\uB9BC\uCC28\uC21C \uC815\uB82C","Im\xE1genes descendentes en la publicaci\xF3n"],reverseMultipleImagesPostTooltip:["Reverse order for post with multiple images attatched","\u53CD\u8F6C\u63A8\u6587\u56FE\u7247\u987A\u5E8F","\uC5EC\uB7EC \uC774\uBBF8\uC9C0\uAC00 \uCCA8\uBD80\uB41C \uD3EC\uC2A4\uD2B8 \uB0B4 \uC774\uBBF8\uC9C0\uB4E4\uC758 \uC21C\uC11C\uB97C \uC5ED\uC21C\uC73C\uB85C \uC815\uB82C\uD569\uB2C8\uB2E4.","Orden inverso para publicaciones con m\xFAltiples im\xE1genes adjuntas"],excludeVideo:["Exclude Videos","\u6392\u9664\u89C6\u9891","\uBE44\uB514\uC624 \uC81C\uC678","Excluir videos"],excludeVideoTooltip:["Exclude videos, now only applies to x.com and kemono.su.","\u6392\u9664\u89C6\u9891\uFF0C\u73B0\u5728\u4EC5\u4F5C\u7528\u4E8Ex.com\u548Ckemono.su","\uBE44\uB514\uC624 \uC81C\uC678, \uD604\uC7AC x.com\uACFC kemono.su\uC5D0\uB9CC \uC801\uC6A9\uB429\uB2C8\uB2E4.","Excluir videos, ahora solo se aplica a x.com y kemono.su."],filenameOrder:["Filename Order","\u6587\u4EF6\u540D\u6392\u5E8F","\uD30C\uC77C\uBA85 \uC21C\uC11C","Orden de nombres de archivo"],filenameOrderTooltip:[`Filename Sorting Rules for Downloaded Files:
<br>  Auto: Detect whether the original filenames are consistent with the reading order under natural sorting (Windows). If consistent, keep the original filenames; otherwise, prepend a number to the original filenames to ensure the correct order.
<br>  Numbers: Ignore the original filenames and rename the files directly according to the reading order.
<br>  Original: Keep only the original filenames without ensuring the reading order, which may result in overwriting files with the same name.
<br>  Alphabetically: Detect whether the original filenames are consistent with the reading order under alphabetical sorting (Linux). If consistent, keep the original filenames; otherwise, prepend a number to the original filenames to ensure the correct order. `,`\u4E0B\u8F7D\u6587\u4EF6\u5185\u7684\u6587\u4EF6\u540D\u6392\u5E8F\u89C4\u5219\uFF1A
<br>  Auto: \u68C0\u6D4B\u539F\u6587\u4EF6\u540D\u5728\u81EA\u7136\u6392\u5E8F(Windows)\u4E0B\u662F\u5426\u4E0E\u9605\u8BFB\u987A\u5E8F\u4E00\u81F4\uFF0C\u5982\u679C\u4E00\u81F4\u4FDD\u7559\u539F\u6587\u4EF6\u540D\uFF0C\u5426\u5219\u5C06\u5728\u539F\u6587\u4EF6\u540D\u524D\u6DFB\u52A0\u5E8F\u53F7\u4EE5\u4FDD\u8BC1\u987A\u5E8F\u3002
<br>  Numbers: \u5FFD\u7565\u539F\u6587\u4EF6\u540D\uFF0C\u76F4\u63A5\u4EE5\u9605\u8BFB\u987A\u5E8F\u4E3A\u6587\u4EF6\u547D\u540D\u3002
<br>  Original: \u53EA\u4FDD\u7559\u539F\u6587\u4EF6\u540D\uFF0C\u4E0D\u80FD\u4FDD\u8BC1\u9605\u8BFB\u987A\u5E8F\u4EE5\u53CA\u540C\u540D\u6587\u4EF6\u8986\u76D6\u3002
<br>  Alphabetically: \u68C0\u6D4B\u539F\u6587\u4EF6\u540D\u5728\u5B57\u6BCD\u6392\u5E8F\u4E0B(Linux)\u662F\u5426\u4E0E\u9605\u8BFB\u987A\u5E8F\u4E00\u81F4\uFF0C\u5982\u679C\u4E00\u81F4\u4FDD\u7559\u539F\u6587\u4EF6\u540D\uFF0C\u5426\u5219\u5C06\u5728\u539F\u6587\u4EF6\u540D\u524D\u6DFB\u52A0\u5E8F\u53F7\u4EE5\u4FDD\u8BC1\u987A\u5E8F\u3002`,`\uB2E4\uC6B4\uB85C\uB4DC \uD30C\uC77C\uC758 \uD30C\uC77C\uBA85 \uC815\uB82C \uADDC\uCE59:
<br>  Auto: \uC6D0\uBCF8 \uD30C\uC77C\uBA85\uC774 \uAE30\uBCF8 \uC815\uB82C(Windows)\uC5D0\uC11C \uC77D\uAE30 \uC21C\uC11C\uC640 \uC77C\uCE58\uD558\uB294\uC9C0 \uAC10\uC9C0\uD569\uB2C8\uB2E4. \uC77C\uCE58\uD558\uB294 \uACBD\uC6B0 \uC6D0\uBCF8 \uD30C\uC77C\uBA85\uC744 \uC720\uC9C0\uD558\uACE0, \uADF8\uB807\uC9C0 \uC54A\uC73C\uBA74 \uC21C\uC11C\uB97C \uBCF4\uC7A5\uD558\uAE30 \uC704\uD574 \uD30C\uC77C\uBA85 \uC55E\uC5D0 \uBC88\uD638\uB97C \uCD94\uAC00\uD569\uB2C8\uB2E4.
<br>  Numbers: \uC6D0\uBCF8 \uD30C\uC77C\uBA85\uC744 \uBB34\uC2DC\uD558\uACE0 \uC77D\uAE30 \uC21C\uC11C\uC5D0 \uB530\uB77C \uD30C\uC77C\uBA85\uC744 \uC9C1\uC811 \uC9C0\uC815\uD569\uB2C8\uB2E4.
<br>  Original: \uC6D0\uBCF8 \uD30C\uC77C\uBA85\uB9CC \uC720\uC9C0\uD558\uBA70, \uC77D\uAE30 \uC21C\uC11C\uAC00 \uBCF4\uC7A5\uB418\uC9C0 \uC54A\uC73C\uBA70 \uB3D9\uC77C\uD55C \uC774\uB984\uC758 \uD30C\uC77C\uC774 \uB36E\uC5B4\uC4F0\uC77C \uC218 \uC788\uC2B5\uB2C8\uB2E4.
<br>  Alphabetically: \uC6D0\uBCF8 \uD30C\uC77C\uBA85\uC774 \uC54C\uD30C\uBCB3 \uC815\uB82C(Linux)\uC5D0\uC11C \uC77D\uAE30 \uC21C\uC11C\uC640 \uC77C\uCE58\uD558\uB294\uC9C0 \uAC10\uC9C0\uD569\uB2C8\uB2E4. \uC77C\uCE58\uD558\uB294 \uACBD\uC6B0 \uC6D0\uBCF8 \uD30C\uC77C\uBA85\uC744 \uC720\uC9C0\uD558\uACE0, \uADF8\uB807\uC9C0 \uC54A\uC73C\uBA74 \uC21C\uC11C\uB97C \uBCF4\uC7A5\uD558\uAE30 \uC704\uD574 \uD30C\uC77C\uBA85 \uC55E\uC5D0 \uBC88\uD638\uB97C \uCD94\uAC00\uD569\uB2C8\uB2E4. `,`Reglas de ordenamiento de nombres de archivos para archivos descargados:
<br>  Auto: Detecta si los nombres de archivo originales son consistentes con el orden de lectura bajo el ordenamiento natural (Windows). Si son consistentes, conserva los nombres de archivo originales; de lo contrario, antepone un n\xFAmero a los nombres originales para garantizar el orden correcto.
<br>  Numbers: Ignora los nombres de archivo originales y renombra los archivos directamente seg\xFAn el orden de lectura.
<br>  Original: Conserva \xFAnicamente los nombres de archivo originales sin garantizar el orden de lectura, lo que puede resultar en sobrescribir archivos con el mismo nombre.
<br>  Alphabetically: Detecta si los nombres de archivo originales son consistentes con el orden de lectura bajo el orden alfab\xE9tico (Linux). Si son consistentes, conserva los nombres de archivo originales; de lo contrario, antepone un n\xFAmero a los nombres originales para garantizar el orden correcto. `],dragToMove:["Drag to Move the control bar","\u62D6\u52A8\u79FB\u52A8","\uB4DC\uB798\uADF8\uD574\uC11C \uCEE8\uD2B8\uB864 \uBC14 \uC774\uB3D9","Arrastra para mover la barra de control"],resetDownloaded:["Reset Downloaded Images","\u91CD\u7F6E\u5DF2\u4E0B\u8F7D\u7684\u56FE\u7247","\uB2E4\uC6B4\uB85C\uB4DC\uD55C \uC774\uBBF8\uC9C0 \uCD08\uAE30\uD654","Restablecer im\xE1genes descargadas"],resetDownloadedConfirm:["You will reset Downloaded Images!","\u5DF2\u4E0B\u8F7D\u7684\u56FE\u7247\u5C06\u4F1A\u88AB\u91CD\u7F6E\u4E3A\u672A\u4E0B\u8F7D\uFF01","\uC774\uBBF8\uC9C0\uB4E4\uC740 \uB2E4\uC6B4\uB85C\uB4DC\uD558\uC9C0 \uC54A\uC740 \uC0C1\uD0DC\uB85C \uCD08\uAE30\uD654\uB429\uB2C8\uB2E4!","\xA1Vas a restablecer las im\xE1genes descargadas!"],resetFailed:["Reset Failed Images","\u91CD\u7F6E\u4E0B\u8F7D\u9519\u8BEF\u7684\u56FE\u7247","\uB85C\uB529 \uC2E4\uD328\uD55C \uC774\uBBF8\uC9C0 \uCD08\uAE30\uD654","Restablecer im\xE1genes fallidas"],showHelp:["Help","\u5E2E\u52A9","\uB3C4\uC6C0\uB9D0","Ayuda"],showKeyboard:["Keyboard","\u5FEB\u6377\u952E","\uB2E8\uCD95\uD0A4","Teclado"],showSiteProfiles:["Site Profiles","\u7AD9\u70B9\u914D\u7F6E","\uC0AC\uC774\uD2B8 \uC124\uC815","Perfiles del sitio"],showStyleCustom:["Style","\u6837\u5F0F","\uC2A4\uD0C0\uC77C","Estilo"],showActionCustom:["Image Actions","\u56FE\u7247\u64CD\u4F5C","\uC774\uBBF8\uC9C0 \uC791\uC5C5","Acciones de imagen"],example:["Example","\u793A\u4F8B","\uC608\uC2DC","Ejemplo"],description:["Description","\u63CF\u8FF0","\uC124\uBA85","Descripci\xF3n"],function:["Function","\u51FD\u6570","\uD568\uC218","Funci\xF3n"],parameters:["Parameters","\u53C2\u6570","\uB9E4\uAC1C\uBCC0\uC218","Par\xE1metros"],body:["Body","\u4F53","\uBCF8\uBB38","Cuerpo"],icon:["ICON","\u56FE\u6807","\uC544\uC774\uCF58","ICONO"],optional:["Optional","\u53EF\u9009","\uC120\uD0DD\uC801","Opcional"],regexp:["Regexp","\u6B63\u5219","\uC815\uADDC\uC2DD","Regexp"],workon:["Work On Sites","\u751F\u6548\u7AD9\u70B9","\uC0AC\uC774\uD2B8\uC5D0\uC11C \uC791\uB3D9","Funciona en sitios"],global:["Global","\u5168\u5C40","\uAE00\uB85C\uBC8C","Global"],controlBarStyleTooltip:["Click on an item to modify its display text, such as emoji or personalized text. Changes will take effect after restarting.","\u70B9\u51FB\u67D0\u9879\u540E\u4FEE\u6539\u5176\u663E\u793A\u6587\u672C\uFF0C\u6BD4\u5982emoji\u6216\u4E2A\u6027\u6587\u5B57\uFF0C\u4E5F\u8BB8svg\uFF0C\u91CD\u542F\u540E\u751F\u6548\u3002","\uC544\uC774\uD15C\uC744 \uD074\uB9AD\uD558\uC5EC \uC774\uBAA8\uD2F0\uCF58\uC774\uB098 \uD14D\uC2A4\uD2B8 \uB4F1\uC744 \uC218\uC815\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uBCC0\uACBD \uC0AC\uD56D\uC740 \uC7AC\uC2DC\uC791 \uD6C4 \uC801\uC6A9\uB429\uB2C8\uB2E4.","Haga clic en un elemento para modificar el texto que se muestra, como emoji o texto personalizado. Los cambios entrar\xE1n en vigor despu\xE9s de reiniciar."],resetConfig:["Reset Config","\u91CD\u7F6E\u914D\u7F6E","\uAD6C\uC131 \uC7AC\uC124\uC815","Restablecer configuraci\xF3n"],letUsStar:["Let's Star","\u70B9\u661F","\uBCC4 \uB20C\uB7EC\uC918","Presiona la estrella"],download:["DL","\u4E0B\u8F7D","\uB2E4\uC6B4\uB85C\uB4DC","Descargar"],forceDownload:["Take Loaded","\u83B7\u53D6\u5DF2\u4E0B\u8F7D\u7684","\uB2E4\uC6B4\uB85C\uB4DC\uB41C \uC774\uBBF8\uC9C0 \uAC00\uC838\uC624\uAE30","Tomar cargado"],downloadStart:["Start Download","\u5F00\u59CB\u4E0B\u8F7D","\uB2E4\uC6B4\uB85C\uB4DC \uC2DC\uC791","Comenzar descarga"],downloading:["Downloading...","\u4E0B\u8F7D\u4E2D...","\uB2E4\uC6B4\uB85C\uB4DC \uC911...","Descargando..."],downloadFailed:["Failed(Retry)","\u4E0B\u8F7D\u5931\u8D25(\u91CD\u8BD5)","\uC2E4\uD328(\uC7AC\uC2DC\uB3C4)","Fallido(Reintentar)"],downloaded:["Downloaded","\u4E0B\u8F7D\u5B8C\u6210","\uB2E4\uC6B4\uB85C\uB4DC \uC644\uB8CC","Descargado"],packaging:["Packaging...","\u6253\u5305\u4E2D...","\uC555\uCD95 \uC911...","Empaquetando..."],status:["Status","\u72B6\u6001","\uC0C1\uD0DC","Estado"],selectChapters:["Chapters","\u7AE0\u8282","\uCC55\uD130","cap\xEDtulos"],cherryPick:["Cherry Pick","\u8303\u56F4\u9009\u62E9","\uBC94\uC704 \uC120\uD0DD","Seleccionar individualmente"],enable:["Enable","\u542F\u7528","\uD65C\uC131\uD654","Habilitar"],enableTooltips:["Enable the script on this site.","\u5728\u6B64\u7AD9\u70B9\u4E0A\u542F\u7528\u672C\u811A\u672C\u7684\u529F\u80FD\u3002","\uC120\uD0DD\uB41C \uC0AC\uC774\uD2B8\uC5D0\uC11C\uB9CC \uC2A4\uD06C\uB9BD\uD2B8\uB97C \uD65C\uC131\uD654\uD569\uB2C8\uB2E4.","Habilitar el script en este sitio."],enableAutoOpen:["Auto Open","\u81EA\u52A8\u6253\u5F00","\uC790\uB3D9 \uD06C\uAC8C \uBCF4\uAE30","Apertura autom\xE1tica"],enableAutoOpenTooltips:["Automatically open the interface of this script when entering the corresponding page.","\u5F53\u8FDB\u5165\u5BF9\u5E94\u7684\u751F\u6548\u9875\u9762\u540E\uFF0C\u81EA\u52A8\u6253\u5F00\u672C\u811A\u672C\u754C\u9762\u3002","\uD574\uB2F9 \uD398\uC774\uC9C0\uC5D0 \uB4E4\uC5B4\uAC08 \uB54C \uC774 \uC2A4\uD06C\uB9BD\uD2B8\uC758 \uC778\uD130\uD398\uC774\uC2A4\uB97C \uC790\uB3D9\uC73C\uB85C \uC5FD\uB2C8\uB2E4.","Abrir autom\xE1ticamente la interfaz de este script al ingresar a la p\xE1gina correspondiente."],enableFlowVision:["Flow Vision","\u81EA\u9002\u5E94\u89C6\u56FE","Flow Vision","Flow Vision"],enableFlowVisionTooltips:[`Enable a new thumbnail list layout where the images in each row have uniform height, but the number of images per row is automatically adjusted. 
    <br>The overall appearance is more compact and comfortable, suitable for illustration-based websites with irregular image aspect ratios.
    <br>Note: Since some websites cannot retrieve image aspect ratio information, the effect may be impacted.`,`\u542F\u7528\u4E00\u79CD\u65B0\u7684\u7F29\u7565\u56FE\u5217\u8868\u5E03\u5C40\uFF0C\u4F7F\u6BCF\u884C\u7684\u56FE\u7247\u9AD8\u5EA6\u4E00\u81F4\uFF0C\u4F46\u81EA\u52A8\u5206\u914D\u6BCF\u884C\u7684\u56FE\u7247\u6570\u91CF\u3002
    <br>\u6574\u4F53\u770B\u8D77\u6765\u66F4\u7D27\u51D1\u8212\u9002\uFF0C\u9002\u5408\u56FE\u7247\u5BBD\u9AD8\u6BD4\u4E0D\u89C4\u5219\u7684\u63D2\u753B\u7C7B\u7AD9\u70B9\u3002
    <br>\u6CE8\u610F\uFF1A\u7531\u4E8E\u4E00\u4E9B\u7AD9\u70B9\u65E0\u6CD5\u63D0\u53D6\u5F97\u77E5\u56FE\u7247\u7684\u5BBD\u9AD8\u6BD4\uFF0C\u56E0\u6B64\u6548\u679C\u53EF\u80FD\u4F1A\u53D7\u5230\u5F71\u54CD\u3002`,`\uC0C8\uB85C\uC6B4 \uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8 \uB808\uC774\uC544\uC6C3\uC744 \uD65C\uC131\uD654\uD558\uC5EC \uAC01\uAC01\uC758 \uD589\uC5D0 \uC788\uB294 \uC774\uBBF8\uC9C0\uB4E4\uC774 \uB3D9\uC77C\uD55C \uB192\uC774\uB97C \uAC00\uC9C0\uB3C4\uB85D \uD569\uB2C8\uB2E4. \uB300\uC2E0 \uD589\uB2F9 \uC774\uBBF8\uC9C0\uC758 \uC218\uB294 \uC790\uB3D9\uC73C\uB85C \uC870\uC815\uB429\uB2C8\uB2E4. 
    <br>\uC804\uCCB4\uC801\uC778 \uC678\uAD00\uC740 \uB354 \uAC04\uACB0\uD558\uACE0 \uD3B8\uC548\uD558\uBA70, \uBD88\uADDC\uCE59\uD55C \uC774\uBBF8\uC9C0 \uBE44\uC728\uC744 \uAC00\uC9C4 \uC77C\uB7EC\uC2A4\uD2B8 \uAE30\uBC18 \uC6F9\uC0AC\uC774\uD2B8\uC5D0 \uC801\uD569\uD569\uB2C8\uB2E4. 
    <br>\uCC38\uACE0: \uC77C\uBD80 \uC6F9\uC0AC\uC774\uD2B8\uB294 \uC774\uBBF8\uC9C0 \uBE44\uC728 \uC815\uBCF4\uB97C \uAC00\uC838\uC62C \uC218 \uC5C6\uC73C\uBBC0\uB85C, \uC774\uB85C \uC778\uD574 \uD6A8\uACFC\uC5D0 \uC601\uD5A5\uC744 \uBC1B\uC744 \uC218 \uC788\uC2B5\uB2C8\uB2E4.`,`Activar un nuevo dise\xF1o de lista de miniaturas donde las im\xE1genes en cada fila tienen altura uniforme, pero el n\xFAmero de im\xE1genes por fila se ajusta autom\xE1ticamente. 
    <br>La apariencia general es m\xE1s compacta y c\xF3moda, adecuada para sitios web basados en ilustraciones con relaciones de aspecto de imagen irregulares.
    <br>Nota: Dado que algunos sitios web no pueden recuperar la informaci\xF3n de la relaci\xF3n de aspecto de las im\xE1genes, el efecto puede verse afectado.`],addRegexp:["Add Work URL Regexp","\u6DFB\u52A0\u751F\u6548\u5730\u5740\u89C4\u5219","URL \uC815\uADDC\uC2DD \uCD94\uAC00","Agregar expresi\xF3n regular de URL"],failFetchReason1:["Refused to connect {{domain}}(origin image url), Please check the domain blacklist: Tampermonkey > Comic Looms > Settings > XHR Security > User domain blacklist","\u88AB\u62D2\u7EDD\u8FDE\u63A5{{domain}}(\u5927\u56FE\u5730\u5740)\uFF0C\u8BF7\u68C0\u67E5\u57DF\u540D\u9ED1\u540D\u5355: Tampermonkey(\u7BE1\u6539\u7334) > \u6F2B\u753B\u7EC7\u673A > \u8BBE\u7F6E > XHR Security >  User domain blacklist","Refused to connect {{domain}}(origin image url), Please check the domain blacklist: Tampermonkey > Comic Looms > Settings > XHR Security > User domain blacklist","Refused to connect {{domain}}(origin image url), Please check the domain blacklist: Tampermonkey > Comic Looms > Settings > XHR Security > User domain blacklist"],latestArtWorks:["The Latest Artworks","\u6700\u65B0\u4F5C\u54C1","\uCD5C\uC2E0 \uC608\uC220 \uC791\uD488","Las \xFAltimas obras de arte"],afterLastReading:["After  Last Reading","\u4E0A\u6B21\u9605\u8BFB\u4E4B\u540E","\uB9C8\uC9C0\uB9C9\uC73C\uB85C \uC77D\uC740 \uD6C4","Despu\xE9s de la \xFAltima lectura"],beforeLastReading:["Before Last Reading","\u4E0A\u6B21\u9605\u8BFB\u4E4B\u524D","\uB9C8\uC9C0\uB9C9\uC73C\uB85C \uC77D\uAE30 \uC804\uC5D0","Antes de la \xFAltima lectura"],allArtWorks:["All Artworks","\u5168\u90E8\u4F5C\u54C1","\uBAA8\uB4E0 \uC791\uD488","Todas las obras de arte"],currentArtWorks:["Artwork On The Current Page","\u5F53\u524D\u9875\u7684\u4F5C\u54C1","\uD604\uC7AC \uD398\uC774\uC9C0\uC758 \uC544\uD2B8\uC6CC\uD06C","Obra de arte en la p\xE1gina actual"],help:[`
<h2>[How to Use? Where is the Entry?]</h2>
<p>The script typically activates on gallery homepages or artist homepages. For example, on E-Hentai, it activates on the gallery detail page, or on Twitter, it activates on the user&#39;s homepage or tweets.</p>
<p>When active, a <strong>&lt;\u{1F391}&gt;</strong> icon will appear at the bottom left of the page. Click it to enter the script&#39;s reading interface.</p>
<h2 style="color:red;">[Some existing issues and their solutions.]</h2>
<ul>
<li>When using Firefox to browse Twitter|X, after navigating to some pages, you need to refresh the page for this script to work on that page.</li>
<li>When using Firefox to browse Twitter|X, the download function of this script may not work.</li>
</ul>
<h4>Solution:</h4>
<p>These issues are caused by Twitter|X&#39;s Content Security Policy (CSP), which disables URL mutation detection and the Zip creation functionality.</p>
<p>You can modify Twitter|X&#39;s response header <strong>Content-Security-Policy</strong> to <strong>Content-Security-Policy: object-src '*'</strong> using other extensions.</p>
<p>For example, in the extension <strong>Header Editor</strong>, click the Add button:</p>
<ul>
<li>Name: csp-remove(any name)</li>
<li>Rule type: Modify response header</li>
<li>Match type: domain</li>
<li>Match rules: x.com</li>
<li>Execute type: normal</li>
<li>Header name: content-security-policy</li>
<li>Header value: object-src '*'</li>
</ul>
<h2>[Can the Script&#39;s Entry Point or Control Bar be Relocated?]</h2>
<p>Yes! At the bottom of the configuration panel, there&#39;s a <strong>Drag to Move</strong> option. Drag the icon to reposition the control bar anywhere on the page.</p>
<h2>[Can the Script Auto-Open When Navigating to the Corresponding Page?]</h2>
<p>Yes! There is an <strong>Auto Open</strong> option in the configuration panel. Enable it to activate this feature.</p>
<h2>[How to Zoom Images?]</h2>
<p>There are several ways to zoom images in big image reading mode:</p>
<ul>
<li>Right-click + mouse wheel</li>
<li>Keyboard shortcuts</li>
<li>Zoom controls on the control bar: click the -/+ buttons, scroll the mouse wheel over the numbers, or drag the numbers left or right.</li>
</ul>
<h2>[How to maintain spacing between large images?]</h2>
<p>In CONF > Style, modify or add: .ehvp-root { --ehvp-big-images-gap: 2px; }</p>
<h2>[How to Open Images from a Specific Page?]</h2>
<p>In the thumbnail list interface, simply type the desired page number on your keyboard (without any prompt) and press Enter or your custom shortcuts.</p>
<h2>[About the Thumbnail List]</h2>
<p>The thumbnail list interface is the script&#39;s most important feature, allowing you to quickly get an overview of the entire gallery.</p>
<p>Thumbnails are also lazy-loaded, typically loading about 20 images, which is comparable to or even fewer requests than normal browsing.</p>
<p>Pagination is also lazy-loaded, meaning not all gallery pages load at once. Only when you scroll near the bottom does the next page load.</p>
<p>Don&#39;t worry about generating a lot of requests by quickly scrolling through the thumbnail list; the script is designed to handle this efficiently.</p>
<h2>[About Auto-Loading and Pre-Loading]</h2>
<p>By default, the script automatically and slowly loads large images one by one.</p>
<p>You can still click any thumbnail to start loading and reading from that point, at which time auto-loading will stop and pre-load 3 images from the reading position.</p>
<p>Just like the thumbnail list, you don&#39;t need to worry about generating a lot of loading requests by fast scrolling.</p>
<h2>[About Downloading]</h2>
<p>Downloading is integrated with large image loading. When you finish browsing a gallery and want to save and download the images, you can click <strong>Start Download</strong> in the download panel. don&#39;t worry about re-downloading already loaded images.</p>
<p>You can also directly click <strong>Start Download</strong> in the download panel without reading.</p>
<p>Alternatively, click the <strong>Take Loaded</strong> button in the download panel if some images consistently fail to load. This will save the images that have already been loaded.</p>
<p>The download panel&#39;s status indicators provide a clear view of image loading progress.</p>
<p><strong>Note:</strong> When the download file size exceeds 1.2GB, split compression will be automatically enabled. If you encounter errors while extracting the files, please update your extraction software or use 7-Zip.</p>
<h2>[Can I Select the Download Range?]</h2>
<p>Yes, the download panel has an option to select the download range(Cherry Pick), which applies to downloading, auto-loading, and pre-loading.</p>
<p>Even if an image is excluded from the download range, you can still click its thumbnail to view it, which will load the corresponding large image.</p>
<h2>[How to Select Images on Some Illustration Sites?]</h2>
<p>In the thumbnail list, you can use some hotkeys to select images:</p>
<ul>
<li><strong>Ctrl + Left Click:</strong> Selects the image. The first selection will exclude all other images.</li>
<li><strong>Ctrl + Shift + Left Click:</strong> Selects the range of images between this image and the last selected image.</li>
<li><strong>Alt + Left Click:</strong> Excludes the image. The first exclusion will select all other images.</li>
<li><strong>Alt + Shift + Left Click:</strong> Excludes the range of images between this image and the last excluded image.</li>
</ul>
<p>In addition, there are several other methods:</p>
<ul>
<li>Middle-click on a thumbnail to open the original image url, then right-click to save the image.</li>
<li>Set the download range to 1 in the download panel. This excludes all images except the first one. Then, click on thumbnails of interest in the list, which will load the corresponding large images. After selecting, clear the download range and click <strong>Take Loaded</strong> to package and download your selected images.</li>
<li>Turn off auto-loading and set pre-loading to 1 in the configuration panel, then proceed as described above.</li>
</ul>
<h2>[Can I Operate the Script via Keyboard?]</h2>
<p>Yes! There&#39;s a <strong>Keyboard</strong> button at the bottom of the configuration panel. Click it to view or configure keyboard operations.</p>
<p>You can even configure it for one-handed full keyboard operation, freeing up your other hand!</p>
<h2>[How to Feed the Author]</h2>
<p>Give me a star on <a target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance">Github</a> or a good review on <a target="_blank" href="https://greasyfork.org/scripts/397848-e-hentai-view-enhance">Greasyfork</a>.</p>
<p>Please do not review on Greasyfork, as its notification system cannot track subsequent feedback. Many people leave an issue and never back.
Report issues here: <a target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance/issues">issue</a></p>
<h2>[How to Reopen the Guide?]</h2>
<p>Click the <strong>Help</strong> button at the bottom of the configuration panel.</p>
`,`
<h2>[\u5982\u4F55\u4F7F\u7528\uFF1F\u5165\u53E3\u5728\u54EA\u91CC\uFF1F]</h2>
<p>\u811A\u672C\u4E00\u822C\u751F\u6548\u4E8E\u753B\u5ECA\u8BE6\u60C5\u9875\u6216\u753B\u5BB6\u7684\u4E3B\u9875\u6216\u4F5C\u54C1\u9875\u3002\u6BD4\u5982\u5728E-Hentai\u4E0A\uFF0C\u751F\u6548\u4E8E\u753B\u5ECA\u8BE6\u60C5\u9875\uFF0C\u6216\u8005\u5728Twitter\u4E0A\uFF0C\u751F\u6548\u4E8E\u63A8\u4E3B\u7684\u4E3B\u9875\u6216\u63A8\u6587\u3002</p>
<p>\u751F\u6548\u65F6\uFF0C\u5728\u9875\u9762\u7684\u5DE6\u4E0B\u65B9\u4F1A\u6709\u4E00\u4E2A<strong>&lt;\u{1F391}&gt;</strong>\u56FE\u6807\uFF0C\u70B9\u51FB\u540E\u5373\u53EF\u8FDB\u5165\u811A\u672C\u7684\u9605\u8BFB\u754C\u9762\u3002</p>
<h2 style="color:red;">[\u4E00\u4E9B\u73B0\u5B58\u7684\u95EE\u9898\uFF0C\u4EE5\u53CA\u89E3\u51B3\u65B9\u5F0F\u3002]</h2>
<ul>
<li>\u4F7F\u7528Firefox\u6D4F\u89C8Twitter|X\u65F6\uFF0C\u8DF3\u8F6C\u5230\u5176\u4ED6\u9875\u9762\u540E\uFF0C\u9700\u8981\u5237\u65B0\u624D\u53EF\u4EE5\u4F7F\u6B64\u811A\u672C\u5728\u8BE5\u9875\u9762\u751F\u6548\u3002</li>
<li>\u4F7F\u7528Firefox\u6D4F\u89C8Twitter|X\u65F6\uFF0C\u6B64\u811A\u672C\u7684\u4E0B\u8F7D\u529F\u80FD\u53EF\u80FD\u65E0\u6CD5\u4F7F\u7528\u3002</li>
</ul>
<h4>\u89E3\u51B3\u65B9\u5F0F:</h4>
<p>\u8FD9\u4E9B\u95EE\u9898\u662F\u7531\u4E8ETwitter|X\u7684\u5185\u5BB9\u5B89\u5168\u7B56\u7565(CSP)\u5BFC\u81F4\uFF0C\u5B83\u4F7FURL\u7684\u53D8\u52A8\u68C0\u6D4B\u548C\u521B\u5EFAZip\u529F\u80FD\u5931\u6548\u3002</p>
<p>\u53EF\u4EE5\u901A\u8FC7\u5176\u4ED6\u62D3\u5C55\u4FEE\u6539Twitter|X\u7684\u54CD\u5E94\u5934<strong>Content-Security-Policy</strong>\u4E3A<strong>Content-Security-Policy: object-src '*'</strong></p>
<p>\u4F8B\u5982\u5728\u62D3\u5C55<strong>Header Editor</strong>\u4E2D\uFF0C\u70B9\u51FB\u6DFB\u52A0\u6309\u94AE:</p>
<ul>
<li>Name: csp-remove(\u968F\u610F)</li>
<li>Rule type: Modify response header</li>
<li>Match type: domain</li>
<li>Match rules: x.com</li>
<li>Execute type: normal</li>
<li>Header name: content-security-policy</li>
<li>Header value: object-src '*'</li>
</ul>
<h2>[\u811A\u672C\u7684\u5165\u53E3\u6216\u63A7\u5236\u680F\u53EF\u4EE5\u66F4\u6539\u4F4D\u7F6E\u5417\uFF1F]</h2>
<p>\u53EF\u4EE5\uFF01\u5728\u914D\u7F6E\u9762\u677F\u7684\u4E0B\u65B9\uFF0C\u6709\u4E00\u4E2A<strong>\u62D6\u62FD\u79FB\u52A8</strong>\u7684\u9009\u9879\uFF0C\u5BF9\u7740\u56FE\u6807\u8FDB\u884C\u62D6\u52A8\uFF0C\u4F60\u53EF\u4EE5\u5C06\u63A7\u5236\u680F\u79FB\u52A8\u5230\u9875\u9762\u4E0A\u7684\u4EFB\u610F\u4F4D\u7F6E\u3002</p>
<h2>[\u8FDB\u5165\u5BF9\u5E94\u7684\u9875\u9762\u7684\uFF0C\u53EF\u4EE5\u81EA\u52A8\u6253\u5F00\u811A\u672C\u5417\uFF1F]</h2>
<p>\u53EF\u4EE5\uFF01\u5728\u914D\u7F6E\u9762\u677F\u4E2D\uFF0C\u6709\u4E00\u4E2A<strong>\u81EA\u52A8\u6253\u5F00</strong>\u7684\u9009\u9879\uFF0C\u542F\u7528\u5373\u53EF\u3002</p>
<h2>[\u5982\u4F55\u7F29\u653E\u56FE\u7247\uFF1F]</h2>
<p>\u6709\u51E0\u79CD\u65B9\u5F0F\u53EF\u4EE5\u5728\u5927\u56FE\u9605\u8BFB\u6A21\u5F0F\u4E2D\u7F29\u653E\u56FE\u7247\uFF1A</p>
<ul>
<li>\u9F20\u6807\u53F3\u952E+\u6EDA\u8F6E</li>
<li>\u952E\u76D8\u5FEB\u6377\u952E</li>
<li>\u63A7\u5236\u680F\u4E0A\u7684\u7F29\u653E\u63A7\u5236\uFF0C\u70B9\u51FB-/+\u6309\u94AE\uFF0C\u6216\u8005\u5728\u6570\u5B57\u4E0A\u6EDA\u52A8\u6EDA\u8F6E\uFF0C\u6216\u8005\u5DE6\u53F3\u62D6\u52A8\u6570\u5B57\u3002</li>
</ul>
<h2>[\u5982\u4F55\u8BA9\u5927\u56FE\u4E4B\u95F4\u4FDD\u6301\u95F4\u9694\uFF1F]</h2>
<p>\u5728CONF > Style\u4E2D\uFF0C\u4FEE\u6539\u6216\u6DFB\u52A0 .ehvp-root { --ehvp-big-images-gap: 2px; }</p>
<h2>[\u5982\u4F55\u6253\u5F00\u6307\u5B9A\u9875\u6570\u7684\u56FE\u7247\uFF1F]</h2>
<p>\u5728\u7F29\u7565\u56FE\u5217\u8868\u754C\u9762\u4E2D\uFF0C\u76F4\u63A5\u5728\u952E\u76D8\u4E0A\u8F93\u5165\u6570\u5B57(\u6CA1\u6709\u63D0\u793A)\uFF0C\u7136\u540E\u6309\u4E0B\u56DE\u8F66\u6216\u81EA\u5B9A\u4E49\u7684\u5FEB\u6377\u952E\u3002</p>
<h2>[\u5173\u4E8E\u7F29\u7565\u56FE\u5217\u8868\u3002]</h2>
<p>\u7F29\u7565\u56FE\u5217\u8868\u662F\u811A\u672C\u6700\u91CD\u8981\u7684\u7279\u6027\uFF0C\u53EF\u4EE5\u8BA9\u4F60\u5FEB\u901F\u5730\u4E86\u89E3\u6574\u4E2A\u753B\u5ECA\u7684\u60C5\u51B5\u3002</p>
<p>\u5E76\u4E14\u7F29\u7565\u56FE\u4E5F\u662F\u5EF6\u8FDF\u52A0\u8F7D\u7684\uFF0C\u901A\u5E38\u4F1A\u52A0\u8F7D20\u5F20\u5DE6\u53F3\uFF0C\u4E0E\u6B63\u5E38\u6D4F\u89C8\u6240\u53D1\u51FA\u7684\u8BF7\u6C42\u76F8\u5F53\uFF0C\u751A\u81F3\u66F4\u4F4E\u3002</p>
<p>\u5E76\u4E14\u5206\u9875\u4E5F\u662F\u5EF6\u8FDF\u52A0\u8F7D\u7684\uFF0C\u5E76\u4E0D\u4F1A\u4E00\u6B21\u6027\u52A0\u8F7D\u753B\u5ECA\u7684\u6240\u6709\u5206\u9875\uFF0C\u53EA\u6709\u6EDA\u52A8\u5230\u63A5\u8FD1\u5E95\u90E8\u65F6\uFF0C\u624D\u4F1A\u52A0\u8F7D\u4E0B\u4E00\u9875\u3002</p>
<p>\u4E0D\u7528\u62C5\u5FC3\u56E0\u4E3A\u5728\u7F29\u7565\u56FE\u5217\u8868\u4E2D\u5FEB\u901F\u6EDA\u52A8\u800C\u5BFC\u81F4\u53D1\u51FA\u5927\u91CF\u7684\u8BF7\u6C42\uFF0C\u811A\u672C\u5145\u5206\u8003\u8651\u5230\u4E86\u8FD9\u4E00\u70B9\u3002</p>
<h2>[\u5173\u4E8E\u81EA\u52A8\u52A0\u8F7D\u548C\u9884\u52A0\u8F7D\u3002]</h2>
<p>\u9ED8\u8BA4\u914D\u7F6E\u4E0B\uFF0C\u811A\u672C\u4F1A\u81EA\u52A8\u4E14\u7F13\u6162\u5730\u4E00\u5F20\u63A5\u4E00\u5F20\u5730\u52A0\u8F7D\u5927\u56FE\u3002</p>
<p>\u4F60\u4ECD\u7136\u53EF\u4EE5\u70B9\u51FB\u4EFB\u610F\u4F4D\u7F6E\u7684\u7F29\u7565\u56FE\uFF0C\u5E76\u4ECE\u8BE5\u5904\u5F00\u59CB\u52A0\u8F7D\u5E76\u9605\u8BFB\uFF0C\u6B64\u65F6\u4F1A\u81EA\u52A8\u52A0\u8F7D\u4F1A\u505C\u6B62\u5E76\u4ECE\u9605\u8BFB\u7684\u4F4D\u7F6E\u9884\u52A0\u8F7D3\u5F20\u56FE\u7247\u3002</p>
<p>\u540C\u7F29\u7565\u56FE\u5217\u8868\u4E00\u6837\uFF0C\u65E0\u9700\u62C5\u5FC3\u56E0\u4E3A\u5FEB\u901F\u6EDA\u52A8\u800C\u5BFC\u81F4\u53D1\u51FA\u5927\u91CF\u7684\u52A0\u8F7D\u8BF7\u6C42\u3002</p>
<h2>[\u5173\u4E8E\u4E0B\u8F7D\u3002]</h2>
<p>\u4E0B\u8F7D\u4E0E\u5927\u56FE\u52A0\u8F7D\u662F\u4E00\u4F53\u7684\uFF0C\u5F53\u4F60\u6D4F\u89C8\u5B8C\u753B\u5ECA\u65F6\uFF0C\u7A81\u7136\u60F3\u8D77\u6765\u8981\u4FDD\u5B58\u4E0B\u8F7D\uFF0C\u6B64\u65F6\u4F60\u53EF\u4EE5\u5728\u4E0B\u8F7D\u9762\u677F\u4E2D\u70B9\u51FB<strong>\u5F00\u59CB\u4E0B\u8F7D</strong>\uFF0C\u4E0D\u5FC5\u62C5\u5FC3\u4F1A\u91CD\u590D\u4E0B\u8F7D\u5DF2\u7ECF\u52A0\u8F7D\u8FC7\u7684\u56FE\u7247\u3002</p>
<p>\u5F53\u7136\u4F60\u4E5F\u53EF\u4EE5\u4E0D\u6D4F\u89C8\uFF0C\u76F4\u63A5\u5728\u4E0B\u8F7D\u9762\u677F\u4E2D\u70B9\u51FB<strong>\u5F00\u59CB\u4E0B\u8F7D</strong>\u3002</p>
<p>\u6216\u8005\u70B9\u51FB\u4E0B\u8F7D\u9762\u677F\u4E2D\u7684<strong>\u83B7\u53D6\u5DF2\u4E0B\u8F7D\u7684</strong>\u6309\u94AE\uFF0C\u5F53\u4E00\u4E9B\u56FE\u7247\u603B\u662F\u52A0\u8F7D\u5931\u8D25\u7684\u65F6\u5019\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528\u6B64\u529F\u80FD\u6765\u4FDD\u5B58\u5DF2\u7ECF\u52A0\u8F7D\u8FC7\u7684\u56FE\u7247\u3002</p>
<p>\u901A\u8FC7\u4E0B\u8F7D\u9762\u677F\u4E2D\u7684\u72B6\u6001\u53EF\u4EE5\u76F4\u89C2\u5730\u770B\u5230\u56FE\u7247\u52A0\u8F7D\u7684\u60C5\u51B5\u3002</p>
<p><strong>\u6CE8\u610F\uFF1A</strong>\u5F53\u4E0B\u8F7D\u6587\u4EF6\u5927\u5C0F\u8D85\u8FC71.2G\u540E\uFF0C\u4F1A\u81EA\u52A8\u542F\u7528\u5206\u5377\u538B\u7F29\u3002\u5F53\u4F7F\u7528\u89E3\u538B\u8F6F\u4EF6\u89E3\u538B\u51FA\u9519\u65F6\uFF0C\u8BF7\u66F4\u65B0\u89E3\u538B\u8F6F\u4EF6\u6216\u4F7F\u75287-Zip\u3002</p>
<h2>[\u53EF\u4EE5\u9009\u62E9\u4E0B\u8F7D\u8303\u56F4\u5417\uFF1F]</h2>
<p>\u53EF\u4EE5\uFF0C\u5728\u4E0B\u8F7D\u9762\u677F\u4E2D\u6709\u9009\u62E9\u4E0B\u8F7D\u8303\u56F4\u7684\u529F\u80FD\uFF0C\u8BE5\u529F\u80FD\u5BF9\u4E0B\u8F7D\u3001\u81EA\u52A8\u52A0\u8F7D\u3001\u9884\u52A0\u8F7D\u90FD\u751F\u6548\u3002</p>
<p>\u53E6\u5916\uFF0C\u5982\u679C\u4E00\u5F20\u56FE\u7247\u88AB\u6392\u9664\u5728\u4E0B\u8F7D\u8303\u56F4\u4E4B\u5916\uFF0C\u4F60\u4ECD\u7136\u53EF\u4EE5\u70B9\u51FB\u8BE5\u56FE\u7247\u7684\u7F29\u7565\u56FE\u8FDB\u884C\u6D4F\u89C8\uFF0C\u8FD9\u4F1A\u52A0\u8F7D\u5BF9\u5E94\u7684\u5927\u56FE\u3002</p>
<h2>[\u5982\u4F55\u5728\u4E00\u4E9B\u63D2\u753B\u7F51\u7AD9\u4E0A\u6311\u9009\u56FE\u7247\uFF1F]</h2>
<p>\u5728\u7F29\u7565\u56FE\u5217\u8868\u4E2D\u4F7F\u7528\u4E00\u4E9B\u5FEB\u6377\u952E\u53EF\u4EE5\u8FDB\u884C\u56FE\u7247\u7684\u6311\u9009\u3002</p>
<ul>
<li><strong>Ctrl+\u9F20\u6807\u5DE6\u952E\uFF1A</strong> \u9009\u4E2D\u8BE5\u56FE\u7247\uFF0C\u5F53\u7B2C\u4E00\u6B21\u9009\u4E2D\u65F6\uFF0C\u5176\u4ED6\u7684\u56FE\u7247\u90FD\u4F1A\u88AB\u6392\u9664\u3002</li>
<li><strong>Ctrl+Shift+\u9F20\u6807\u5DE6\u952E\uFF1A</strong> \u9009\u4E2D\u8BE5\u56FE\u7247\u4E0E\u4E0A\u4E00\u5F20\u9009\u4E2D\u7684\u56FE\u7247\u4E4B\u95F4\u7684\u8303\u56F4\u3002</li>
<li><strong>Alt+\u9F20\u6807\u5DE6\u952E\uFF1A</strong> \u6392\u9664\u8BE5\u56FE\u7247\uFF0C\u5F53\u7B2C\u4E00\u6B21\u6392\u9664\u65F6\uFF0C\u5176\u4ED6\u7684\u56FE\u7247\u90FD\u4F1A\u88AB\u9009\u4E2D\u3002</li>
<li><strong>Alt+Shift+\u9F20\u6807\u5DE6\u952E\uFF1A</strong> \u6392\u9664\u8BE5\u56FE\u7247\u4E0E\u4E0A\u4E00\u5F20\u6392\u9664\u7684\u56FE\u7247\u4E4B\u95F4\u7684\u8303\u56F4\u3002</li>
</ul>
<p>\u9664\u6B64\u4E4B\u5916\u8FD8\u6709\u51E0\u79CD\u65B9\u5F0F\uFF1A</p>
<ul>
<li>\u5728\u7F29\u7565\u56FE\u4E0A\u6309\u4E0B\u9F20\u6807\u4E2D\u952E\uFF0C\u5373\u53EF\u6253\u5F00\u56FE\u7247\u7684\u539F\u59CB\u5730\u5740\uFF0C\u4E4B\u540E\u4F60\u53EF\u4EE5\u53F3\u952E\u4FDD\u5B58\u56FE\u7247\u3002</li>
<li>\u5728\u4E0B\u8F7D\u9762\u677F\u4E2D\u8BBE\u7F6E\u4E0B\u8F7D\u8303\u56F4\u4E3A1\uFF0C\u8FD9\u6837\u4F1A\u6392\u9664\u7B2C\u4E00\u5F20\u56FE\u7247\u4EE5\u5916\u7684\u6240\u6709\u56FE\u7247\uFF0C\u4E4B\u540E\u5728\u7F29\u7565\u56FE\u5217\u8868\u4E0A\u70B9\u51FB\u4F60\u611F\u5174\u8DA3\u7684\u56FE\u7247\uFF0C\u5BF9\u5E94\u7684\u5927\u56FE\u4F1A\u88AB\u52A0\u8F7D\uFF0C\u6700\u7EC8\u6311\u9009\u5B8C\u6BD5\u540E\uFF0C\u5220\u9664\u6389\u4E0B\u8F7D\u8303\u56F4\u5E76\u70B9\u51FB<strong>\u83B7\u53D6\u5DF2\u4E0B\u8F7D\u7684</strong>\uFF0C\u8FD9\u6837\u4F60\u6311\u9009\u7684\u56FE\u7247\u4F1A\u88AB\u6253\u5305\u4E0B\u8F7D\u3002</li>
<li>\u5728\u914D\u7F6E\u9762\u677F\u4E2D\u5173\u95ED\u81EA\u52A8\u52A0\u8F7D\uFF0C\u5E76\u8BBE\u7F6E\u9884\u52A0\u8F7D\u6570\u91CF\u4E3A1\uFF0C\u4E4B\u540E\u4E0E\u4E0A\u9762\u7684\u65B9\u6CD5\u7C7B\u4F3C\u3002</li>
</ul>
<h2>[\u53EF\u4EE5\u901A\u8FC7\u952E\u76D8\u6765\u64CD\u4F5C\u5417\uFF1F]</h2>
<p>\u53EF\u4EE5\uFF01\u5728\u914D\u7F6E\u9762\u677F\u7684\u4E0B\u65B9\uFF0C\u6709\u4E00\u4E2A<strong>\u5FEB\u6377\u952E</strong>\u6309\u94AE\uFF0C\u70B9\u51FB\u540E\u53EF\u4EE5\u67E5\u770B\u952E\u76D8\u64CD\u4F5C\uFF0C\u6216\u8FDB\u884C\u914D\u7F6E\u3002</p>
<p>\u751A\u81F3\u53EF\u4EE5\u914D\u7F6E\u4E3A\u5355\u624B\u5168\u952E\u76D8\u64CD\u4F5C\uFF0C\u89E3\u653E\u53E6\u4E00\u53EA\u624B\uFF01</p>
<h2>[\u5982\u4F55Feed\u4F5C\u8005\u3002]</h2>
<p>\u7ED9\u6211<a target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance">Github</a>\u661F\u661F\uFF0C\u6216\u8005<a target="_blank" href="https://greasyfork.org/scripts/397848-e-hentai-view-enhance">Greasyfork</a>\u4E0A\u597D\u8BC4\u3002</p>
<p>\u8BF7\u52FF\u5728Greasyfork\u4E0A\u53CD\u9988\u95EE\u9898\uFF0C\u56E0\u4E3A\u8BE5\u7AD9\u70B9\u7684\u901A\u77E5\u7CFB\u7EDF\u65E0\u6CD5\u8DDF\u8E2A\u540E\u7EED\u7684\u53CD\u9988\u3002\u5F88\u591A\u4EBA\u53EA\u662F\u7559\u4E0B\u4E00\u4E2A\u95EE\u9898\uFF0C\u518D\u4E5F\u6CA1\u6709\u56DE\u6765\u8FC7\u3002
\u8BF7\u5728\u6B64\u53CD\u9988\u95EE\u9898: <a target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance/issues">issue</a></p>
<h2>[\u5982\u4F55\u518D\u6B21\u6253\u5F00\u6307\u5357\uFF1F]</h2>
<p>\u5728\u914D\u7F6E\u9762\u677F\u7684\u4E0B\u65B9\uFF0C\u70B9\u51FB<strong>\u5E2E\u52A9</strong>\u6309\u94AE\u3002</p>
`,`
<h2>[\uC0AC\uC6A9 \uBC29\uBC95? \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uC5B4\uB5BB\uAC8C \uC2E4\uD589\uB418\uB098\uC694?]</h2>
<p>\uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uC8FC\uB85C \uAC24\uB7EC\uB9AC \uD648\uD398\uC774\uC9C0\uB098 \uC544\uD2F0\uC2A4\uD2B8 \uD648\uD398\uC774\uC9C0\uC5D0\uC11C \uD65C\uC131\uD654\uB429\uB2C8\uB2E4. \uC608\uB97C \uB4E4\uC5B4, E-Hentai\uC5D0\uC11C\uB294 \uAC24\uB7EC\uB9AC \uC0C1\uC138 \uD398\uC774\uC9C0\uC5D0\uC11C, Twitter\uC5D0\uC11C\uB294 \uC0AC\uC6A9\uC790\uC758 \uD648 \uB610\uB294 \uD2B8\uC717\uC5D0\uC11C, arca.live\uC5D0\uC11C\uB294 \uC791\uC131\uB41C \uAE00\uC5D0\uC11C \uD65C\uC131\uD654\uB429\uB2C8\uB2E4.</p>
<p>\uC2A4\uD06C\uB9BD\uD2B8\uAC00 \uD65C\uC131\uD654\uB418\uBA74 \uD398\uC774\uC9C0\uC758 \uC67C\uCABD \uD558\uB2E8\uC5D0 <strong>&lt;\u{1F391}&gt;</strong> \uC544\uC774\uCF58\uC774 \uB098\uD0C0\uB0A9\uB2C8\uB2E4. \uC774 \uC544\uC774\uCF58\uC744 \uD074\uB9AD\uD558\uBA74 \uC2A4\uD06C\uB9BD\uD2B8\uC758 \uC77D\uAE30 \uD654\uBA74\uC73C\uB85C \uC9C4\uC785\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>

<h2>[\uC2A4\uD06C\uB9BD\uD2B8\uC758 \uC9C4\uC785\uC810 \uB610\uB294 \uCEE8\uD2B8\uB864 \uBC14\uB97C \uC774\uB3D9\uD560 \uC218 \uC788\uB098\uC694?]</h2>
<p>\uB124! \uC124\uC815 \uD328\uB110 \uD558\uB2E8\uC5D0 <strong>\uB4DC\uB798\uADF8\uD574\uC11C \uCEE8\uD2B8\uB864 \uBC14 \uC774\uB3D9</strong> \uC635\uC158\uC774 \uC788\uC2B5\uB2C8\uB2E4. \uC774 \uC544\uC774\uCF58\uC744 \uB4DC\uB798\uADF8\uD558\uC5EC \uD398\uC774\uC9C0 \uB0B4 \uC6D0\uD558\uB294 \uC704\uCE58\uB85C \uCEE8\uD2B8\uB864 \uBC14\uB97C \uC774\uB3D9\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>

<h2>[\uD574\uB2F9 \uD398\uC774\uC9C0\uB85C \uC774\uB3D9\uD560 \uB54C \uC2A4\uD06C\uB9BD\uD2B8\uAC00 \uC790\uB3D9\uC73C\uB85C \uC5F4\uB9AC\uAC8C \uD560 \uC218 \uC788\uB098\uC694?]</h2>
<p>\uB124! \uC124\uC815 \uD328\uB110\uC5D0\uC11C <strong>\uC790\uB3D9\uC73C\uB85C \uC774\uBBF8\uC9C0 \uC5F4\uAE30</strong> \uC635\uC158\uC744 \uD65C\uC131\uD654\uD558\uBA74 \uC774 \uAE30\uB2A5\uC774 \uCF1C\uC9D1\uB2C8\uB2E4.</p>

<h2>[\uC774\uBBF8\uC9C0\uB97C \uD655\uB300\uD558\uB824\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD558\uB098\uC694?]</h2>
<p>\uD070 \uC774\uBBF8\uC9C0 \uBCF4\uAE30 \uBAA8\uB4DC\uC5D0\uC11C \uC774\uBBF8\uC9C0\uB97C \uD655\uB300\uD558\uB294 \uBC29\uBC95\uC740 \uC5EC\uB7EC \uAC00\uC9C0\uAC00 \uC788\uC2B5\uB2C8\uB2E4:</p>
<ul>
<li>\uC624\uB978\uCABD \uD074\uB9AD + \uB9C8\uC6B0\uC2A4 \uD720</li>
<li>\uD0A4\uBCF4\uB4DC \uB2E8\uCD95\uD0A4</li>
<li>\uCEE8\uD2B8\uB864 \uBC14\uC758 \uD655\uB300/\uCD95\uC18C \uCEE8\uD2B8\uB864: -/+ \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uAC70\uB098, \uC22B\uC790 \uC704\uC5D0\uC11C \uB9C8\uC6B0\uC2A4 \uD720\uC744 \uC2A4\uD06C\uB864\uD558\uAC70\uB098, \uC22B\uC790\uB97C \uC88C\uC6B0\uB85C \uB4DC\uB798\uADF8\uD558\uC138\uC694.</li>
</ul>

<h2>[\uD070 \uC774\uBBF8\uC9C0 \uAC04\uC758 \uAC04\uACA9\uC744 \uC720\uC9C0\uD558\uB824\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD558\uB098\uC694?]</h2>
<p>CONF > Style\uC5D0\uC11C \uB2E4\uC74C\uC744 \uC218\uC815\uD558\uAC70\uB098 \uCD94\uAC00\uD558\uC138\uC694: .ehvp-root { --ehvp-big-images-gap: 2px; }</p>

<h2>[\uD2B9\uC815 \uD398\uC774\uC9C0\uC758 \uC774\uBBF8\uC9C0\uB97C \uC5F4\uB824\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD558\uB098\uC694?]</h2>
<p>\uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8 \uD654\uBA74\uC5D0\uC11C \uC6D0\uD558\uB294 \uD398\uC774\uC9C0 \uBC88\uD638\uB97C \uD0A4\uBCF4\uB4DC\uB85C \uC785\uB825\uD558\uACE0 Enter \uD0A4\uB098 \uC0AC\uC6A9\uC790 \uC9C0\uC815 \uB2E8\uCD95\uD0A4\uB97C \uB204\uB974\uC138\uC694.</p>

<h2>[\uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8\uC5D0 \uB300\uD558\uC5EC]</h2>
<p>\uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8 \uD654\uBA74\uC740 \uC2A4\uD06C\uB9BD\uD2B8\uC758 \uAC00\uC7A5 \uC911\uC694\uD55C \uAE30\uB2A5\uC73C\uB85C, \uC804\uCCB4 \uAC24\uB7EC\uB9AC\uB97C \uBE60\uB974\uAC8C \uB458\uB7EC\uBCFC \uC218 \uC788\uAC8C \uD574\uC90D\uB2C8\uB2E4.</p>
<p>\uC378\uB124\uC77C\uC740 \uC9C0\uC5F0 \uB85C\uB529\uB418\uBA70, \uC77C\uBC18\uC801\uC73C\uB85C \uC57D 20\uAC1C\uC758 \uC774\uBBF8\uC9C0\uB97C \uB85C\uB4DC\uD569\uB2C8\uB2E4. \uC774\uB294 \uC77C\uBC18\uC801\uC778 \uBE0C\uB77C\uC6B0\uC9D5\uBCF4\uB2E4 \uC694\uCCAD \uC218\uAC00 \uC801\uAC70\uB098 \uBE44\uC2B7\uD55C \uC815\uB3C4\uC785\uB2C8\uB2E4.</p>
<p>\uD398\uC774\uC9D5 \uB610\uD55C \uC9C0\uC5F0 \uB85C\uB529\uB429\uB2C8\uB2E4. \uC989, \uBAA8\uB4E0 \uAC24\uB7EC\uB9AC\uC758 \uD398\uC774\uC9C0\uAC00 \uD55C \uBC88\uC5D0 \uB85C\uB4DC\uB418\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4. \uD558\uB2E8 \uADFC\uCC98\uB85C \uC2A4\uD06C\uB864\uD560 \uB54C\uB9CC \uB2E4\uC74C \uD398\uC774\uC9C0\uAC00 \uB85C\uB4DC\uB429\uB2C8\uB2E4.</p>
<p>\uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8\uB97C \uBE60\uB974\uAC8C \uC2A4\uD06C\uB864\uD574\uB3C4 \uAD1C\uCC2E\uC2B5\uB2C8\uB2E4. \uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uADF8\uB7F0 \uACBD\uC6B0\uC5D0\uB3C4 \uB9CE\uC740 \uC694\uCCAD\uC774 \uBC1C\uC0DD\uD558\uC9C0 \uC54A\uB3C4\uB85D \uD6A8\uC728\uC801\uC73C\uB85C \uC124\uACC4\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.</p>

<h2>[\uC790\uB3D9 \uB85C\uB529 \uBC0F \uC0AC\uC804 \uB85C\uB529\uC5D0 \uB300\uD558\uC5EC]</h2>
<p>\uAE30\uBCF8\uC801\uC73C\uB85C \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uD070 \uC774\uBBF8\uC9C0\uB97C \uD558\uB098\uC529 \uC790\uB3D9\uC73C\uB85C \uCC9C\uCC9C\uD788 \uB85C\uB4DC\uD569\uB2C8\uB2E4.</p>
<p>\uC6D0\uD558\uB294 \uC378\uB124\uC77C\uC744 \uD074\uB9AD\uD558\uC5EC \uADF8 \uC9C0\uC810\uC5D0\uC11C \uB85C\uB529 \uBC0F \uC77D\uAE30\uB97C \uC2DC\uC791\uD560 \uC218 \uC788\uC73C\uBA70, \uC774\uB54C \uC790\uB3D9 \uB85C\uB529\uC774 \uC911\uC9C0\uB418\uACE0 \uC77D\uAE30 \uC704\uCE58\uC5D0\uC11C 3\uAC1C\uC758 \uC774\uBBF8\uC9C0\uB97C \uC0AC\uC804 \uB85C\uB529\uD569\uB2C8\uB2E4.</p>
<p>\uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8\uC640 \uB9C8\uCC2C\uAC00\uC9C0\uB85C \uBE60\uB974\uAC8C \uC2A4\uD06C\uB864\uD574\uB3C4 \uB9CE\uC740 \uB85C\uB529 \uC694\uCCAD\uC774 \uBC1C\uC0DD\uD558\uC9C0 \uC54A\uB3C4\uB85D \uC124\uACC4\uB418\uC5B4 \uC788\uC73C\uB2C8 \uAC71\uC815\uD558\uC9C0 \uC54A\uC73C\uC154\uB3C4 \uB429\uB2C8\uB2E4.</p>

<h2>[\uB2E4\uC6B4\uB85C\uB4DC\uC5D0 \uB300\uD558\uC5EC]</h2>
<p>\uB2E4\uC6B4\uB85C\uB4DC\uB294 \uD070 \uC774\uBBF8\uC9C0 \uB85C\uB529\uACFC \uD1B5\uD569\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4. \uAC24\uB7EC\uB9AC\uB97C \uBAA8\uB450 \uBCF8 \uD6C4 \uC774\uBBF8\uC9C0\uB97C \uC800\uC7A5\uD558\uACE0 \uB2E4\uC6B4\uB85C\uB4DC\uD558\uB824\uBA74 \uB2E4\uC6B4\uB85C\uB4DC \uD328\uB110\uC5D0\uC11C <strong>\uB2E4\uC6B4\uB85C\uB4DC \uC2DC\uC791</strong>\uC744 \uD074\uB9AD\uD558\uC138\uC694. \uC774\uBBF8 \uB85C\uB4DC\uB41C \uC774\uBBF8\uC9C0\uB97C \uB2E4\uC2DC \uB2E4\uC6B4\uB85C\uB4DC\uD558\uB294 \uAC83\uC5D0 \uB300\uD574\uC11C\uB294 \uAC71\uC815 \uC548 \uD558\uC154\uB3C4 \uB429\uB2C8\uB2E4.</p>
<p>\uC774\uBBF8\uC9C0\uB97C \uBCF4\uC9C0 \uC54A\uACE0 \uBC14\uB85C \uB2E4\uC6B4\uB85C\uB4DC \uD328\uB110\uC5D0\uC11C <strong>\uB2E4\uC6B4\uB85C\uB4DC \uC2DC\uC791</strong>\uC744 \uD074\uB9AD\uD560 \uC218\uB3C4 \uC788\uC2B5\uB2C8\uB2E4.</p>
<p>\uB610\uD55C \uC77C\uBD80 \uC774\uBBF8\uC9C0\uAC00 \uB85C\uB4DC\uB418\uC9C0 \uC54A\uC744 \uB54C\uB294 \uB2E4\uC6B4\uB85C\uB4DC \uD328\uB110\uC5D0\uC11C <strong>\uC774\uBBF8 \uB2E4\uC6B4\uB85C\uB4DC\uD55C \uC774\uBBF8\uC9C0 \uAC00\uC838\uC624\uAE30</strong> \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC5EC \uC774\uBBF8 \uB85C\uB4DC\uB41C \uC774\uBBF8\uC9C0\uB97C \uC800\uC7A5\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>
<p>\uB2E4\uC6B4\uB85C\uB4DC \uD328\uB110\uC758 \uC0C1\uD0DC \uD45C\uC2DC\uAE30\uB97C \uD1B5\uD574 \uC774\uBBF8\uC9C0 \uB85C\uB529 \uC9C4\uD589 \uC0C1\uD669\uC744 \uBA85\uD655\uD788 \uBCFC \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>
<p><strong>\uCC38\uACE0:</strong> \uB2E4\uC6B4\uB85C\uB4DC \uD30C\uC77C \uD06C\uAE30\uAC00 1.2GB\uB97C \uCD08\uACFC\uD560 \uACBD\uC6B0, \uBD84\uD560 \uC555\uCD95\uC774 \uC790\uB3D9\uC73C\uB85C \uD65C\uC131\uD654\uB429\uB2C8\uB2E4. \uD30C\uC77C\uC744 \uCD94\uCD9C\uD558\uB294 \uB3D9\uC548 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uBA74 \uCD94\uCD9C \uC18C\uD504\uD2B8\uC6E8\uC5B4\uB97C \uC5C5\uB370\uC774\uD2B8\uD558\uAC70\uB098 7-Zip\uC744 \uC0AC\uC6A9\uD558\uC138\uC694.</p>

<h2>[\uB2E4\uC6B4\uB85C\uB4DC \uBC94\uC704\uB97C \uC120\uD0DD\uD560 \uC218 \uC788\uB098\uC694?]</h2>
<p>\uB124, \uB2E4\uC6B4\uB85C\uB4DC \uD328\uB110\uC5D0\uB294 \uB2E4\uC6B4\uB85C\uB4DC \uBC94\uC704\uB97C \uC120\uD0DD\uD560 \uC218 \uC788\uB294 \uC635\uC158(Cherry Pick)\uC774 \uC788\uC73C\uBA70, \uC774\uB294 \uB2E4\uC6B4\uB85C\uB4DC, \uC790\uB3D9 \uB85C\uB529 \uBC0F \uC0AC\uC804 \uB85C\uB529\uC5D0 \uC801\uC6A9\uB429\uB2C8\uB2E4.</p>
<p>\uB2E4\uC6B4\uB85C\uB4DC \uBC94\uC704\uC5D0\uC11C \uC81C\uC678\uB41C \uC774\uBBF8\uC9C0\uB77C\uB3C4 \uC378\uB124\uC77C\uC744 \uD074\uB9AD\uD558\uC5EC \uD574\uB2F9 \uD070 \uC774\uBBF8\uC9C0\uB97C \uB85C\uB4DC\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>

<h2>[\uC77C\uB7EC\uC2A4\uD2B8 \uC0AC\uC774\uD2B8\uC5D0\uC11C \uC774\uBBF8\uC9C0\uB97C \uC120\uD0DD\uD558\uB824\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD558\uB098\uC694?]</h2>
<p>\uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8\uC5D0\uC11C \uB2E4\uC74C \uD56B\uD0A4\uB97C \uC0AC\uC6A9\uD558\uC5EC \uC774\uBBF8\uC9C0\uB97C \uC120\uD0DD\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4:</p>
<ul>
<li><strong>Ctrl + \uC67C\uCABD \uD074\uB9AD:</strong> \uC774\uBBF8\uC9C0\uB97C \uC120\uD0DD\uD569\uB2C8\uB2E4. \uCCAB \uBC88\uC9F8 \uC120\uD0DD\uC740 \uB2E4\uB978 \uBAA8\uB4E0 \uC774\uBBF8\uC9C0\uB97C \uC81C\uC678\uD569\uB2C8\uB2E4.</li>
<li><strong>Ctrl + Shift + \uC67C\uCABD \uD074\uB9AD:</strong> \uC774 \uC774\uBBF8\uC9C0\uC640 \uB9C8\uC9C0\uB9C9\uC73C\uB85C \uC120\uD0DD\uB41C \uC774\uBBF8\uC9C0 \uC0AC\uC774\uC758 \uC774\uBBF8\uC9C0\uB97C \uC120\uD0DD\uD569\uB2C8\uB2E4.</li>
<li><strong>Alt + \uC67C\uCABD \uD074\uB9AD:</strong> \uC774\uBBF8\uC9C0\uB97C \uC81C\uC678\uD569\uB2C8\uB2E4. \uCCAB \uBC88\uC9F8 \uC81C\uC678\uB294 \uB2E4\uB978 \uBAA8\uB4E0 \uC774\uBBF8\uC9C0\uB97C \uC120\uD0DD\uD569\uB2C8\uB2E4.</li>
<li><strong>Alt + Shift + \uC67C\uCABD \uD074\uB9AD:</strong> \uC774 \uC774\uBBF8\uC9C0\uC640 \uB9C8\uC9C0\uB9C9\uC73C\uB85C \uC81C\uC678\uB41C \uC774\uBBF8\uC9C0 \uC0AC\uC774\uC758 \uC774\uBBF8\uC9C0\uB97C \uC81C\uC678\uD569\uB2C8\uB2E4.</li>
</ul>
<p>\uCD94\uAC00\uC801\uC73C\uB85C \uBA87 \uAC00\uC9C0 \uBC29\uBC95\uC774 \uB354 \uC788\uC2B5\uB2C8\uB2E4:</p>
<ul>
<li>\uC378\uB124\uC77C\uC5D0\uC11C \uC911\uAC04 \uD074\uB9AD\uC73C\uB85C \uC6D0\uBCF8 \uC774\uBBF8\uC9C0 URL\uC744 \uC5F4\uACE0, \uADF8 \uD6C4 \uC624\uB978\uCABD \uD074\uB9AD\uD558\uC5EC \uC774\uBBF8\uC9C0\uB97C \uC800\uC7A5\uD569\uB2C8\uB2E4.</li>
<li>\uB2E4\uC6B4\uB85C\uB4DC \uD328\uB110\uC5D0\uC11C \uB2E4\uC6B4\uB85C\uB4DC \uBC94\uC704\uB97C 1\uB85C \uC124\uC815\uD558\uC138\uC694. \uC774\uB294 \uCCAB \uBC88\uC9F8 \uC774\uBBF8\uC9C0 \uC774\uC678\uC758 \uBAA8\uB4E0 \uC774\uBBF8\uC9C0\uB97C \uC81C\uC678\uD569\uB2C8\uB2E4. \uADF8\uB7F0 \uB2E4\uC74C \uBAA9\uB85D\uC5D0\uC11C \uAD00\uC2EC \uC788\uB294 \uC378\uB124\uC77C\uC744 \uD074\uB9AD\uD558\uC5EC \uD574\uB2F9 \uD070 \uC774\uBBF8\uC9C0\uB97C \uB85C\uB4DC\uD569\uB2C8\uB2E4. \uC120\uD0DD\uD55C \uD6C4, \uB2E4\uC6B4\uB85C\uB4DC \uBC94\uC704\uB97C \uD574\uC81C\uD558\uACE0 <strong>\uC774\uBBF8 \uB2E4\uC6B4\uB85C\uB4DC\uD55C \uC774\uBBF8\uC9C0 \uAC00\uC838\uC624\uAE30</strong>\uB97C \uD074\uB9AD\uD558\uC5EC \uC120\uD0DD\uD55C \uC774\uBBF8\uC9C0\uB97C \uD328\uD0A4\uC9D5\uD558\uACE0 \uB2E4\uC6B4\uB85C\uB4DC\uD569\uB2C8\uB2E4.</li>
<li>\uC790\uB3D9 \uB85C\uB529\uC744 \uB044\uACE0 \uC124\uC815 \uD328\uB110\uC5D0\uC11C \uC0AC\uC804 \uB85C\uB529\uC744 1\uB85C \uC124\uC815\uD55C \uB2E4\uC74C, \uC704\uC758 \uBC29\uBC95\uB300\uB85C \uC9C4\uD589\uD569\uB2C8\uB2E4.</li>
</ul>

<h2>[\uD0A4\uBCF4\uB4DC\uB85C \uC2A4\uD06C\uB9BD\uD2B8\uB97C \uC870\uC791\uD560 \uC218 \uC788\uB098\uC694?]</h2>
<p>\uB124! \uC124\uC815 \uD328\uB110 \uD558\uB2E8\uC5D0 <strong>\uB2E8\uCD95\uD0A4</strong> \uBC84\uD2BC\uC774 \uC788\uC2B5\uB2C8\uB2E4. \uC774 \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC5EC \uD0A4\uBCF4\uB4DC \uC870\uC791\uC744 \uD655\uC778\uD558\uAC70\uB098 \uC124\uC815\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>
<p>\uD55C \uC190\uC73C\uB85C \uBAA8\uB4E0 \uD0A4\uBCF4\uB4DC \uC870\uC791\uC744 \uD560 \uC218 \uC788\uB3C4\uB85D \uC124\uC815\uD560 \uC218\uB3C4 \uC788\uC5B4, \uB2E4\uB978 \uC190\uC744 \uC790\uC720\uB86D\uAC8C \uC4F8 \uC218 \uC788\uC2B5\uB2C8\uB2E4!</p>

<h2>[\uD2B9\uC815 \uC0AC\uC774\uD2B8\uC5D0\uC11C \uC790\uB3D9 \uC5F4\uAE30\uB97C \uBE44\uD65C\uC131\uD654\uD558\uB824\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD558\uB098\uC694?]</h2>
<p>\uC124\uC815 \uD328\uB110 \uD558\uB2E8\uC5D0 \uC788\uB294 <strong>\uC0AC\uC774\uD2B8 \uC124\uC815</strong> \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC5EC \uD2B9\uC815 \uC0AC\uC774\uD2B8\uC5D0\uC11C \uC790\uB3D9 \uC5F4\uAE30\uB97C \uC81C\uC678\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uC608\uB97C \uB4E4\uC5B4, Twitter\uB098 Booru \uD0C0\uC785\uC758 \uC0AC\uC774\uD2B8\uB97C \uC81C\uC678\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>

<h2>[\uD2B9\uC815 \uC0AC\uC774\uD2B8\uC5D0\uC11C \uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB97C \uBE44\uD65C\uC131\uD654\uD558\uB824\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD558\uB098\uC694?]</h2>
<p>\uC124\uC815 \uD328\uB110 \uD558\uB2E8\uC758 <strong>\uC0AC\uC774\uD2B8 \uC124\uC815</strong> \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC5EC \uD2B9\uC815 \uC0AC\uC774\uD2B8\uB97C \uC81C\uC678\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uC81C\uC678\uB41C \uC0AC\uC774\uD2B8\uC5D0\uC11C\uB294 \uB354 \uC774\uC0C1 \uC2A4\uD06C\uB9BD\uD2B8\uAC00 \uD65C\uC131\uD654\uB418\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.</p>
<p>\uC0AC\uC774\uD2B8\uB97C \uB2E4\uC2DC \uD65C\uC131\uD654\uD558\uB824\uBA74 \uC81C\uC678\uB418\uC9C0 \uC54A\uC740 \uC0AC\uC774\uD2B8\uC5D0\uC11C \uC124\uC815\uD574\uC57C \uD569\uB2C8\uB2E4.</p>

<h2>[\uAC1C\uBC1C\uC790\uC5D0\uAC8C \uB3C4\uC6C0\uC744 \uC8FC\uACE0 \uC2F6\uB2E4\uBA74?]</h2>
<p><a target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance">Github</a>\uC5D0 \uBCC4\uC744 \uC8FC\uC2DC\uAC70\uB098, <a target="_blank" href="https://greasyfork.org/scripts/397848-e-hentai-view-enhance">Greasyfork</a>\uC5D0\uC11C \uC88B\uC740 \uB9AC\uBDF0\uB97C \uB0A8\uACA8\uC8FC\uC138\uC694.</p>
<p>\uB2E8, Greasyfork\uC5D0 \uBC84\uADF8 \uC81C\uBCF4 \uB0B4\uC6A9\uC758 \uB9AC\uBDF0\uB97C \uB0A8\uAE30\uC9C0 \uB9C8\uC138\uC694. \uD574\uB2F9 \uD50C\uB7AB\uD3FC\uC758 \uC54C\uB9BC \uC2DC\uC2A4\uD15C\uC774 \uD6C4\uC18D \uD53C\uB4DC\uBC31\uC744 \uCD94\uC801\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4. \uB9CE\uC740 \uC0AC\uB78C\uB4E4\uC774 \uBB38\uC81C\uB97C \uC81C\uAE30\uD558\uACE0 \uB2E4\uC2DC \uB3CC\uC544\uC624\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.<br> \uBB38\uC81C\uB294 \uC5EC\uAE30\uC5D0 \uBCF4\uACE0\uD574 \uC8FC\uC138\uC694: <a target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance/issues">\uC774\uC288</a></p>

<h2>[\uAC00\uC774\uB4DC\uB97C \uB2E4\uC2DC \uC5F4\uB824\uBA74?]</h2>
<p>\uC124\uC815 \uD328\uB110 \uD558\uB2E8\uC5D0 \uC788\uB294 <strong>\uB3C4\uC6C0\uB9D0</strong> \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC138\uC694.</p>

<h2>[\uD574\uACB0\uB418\uC9C0 \uC54A\uC740 \uBB38\uC81C\uB4E4]</h2>
<ul>
<li>Firefox\uB97C \uC0AC\uC6A9\uD558\uC5EC Twitter\uC758 \uD648\uD398\uC774\uC9C0\uB97C \uC0C8 \uD0ED\uC5D0\uC11C \uC5F0 \uD6C4 \uC0AC\uC6A9\uC790\uC758 \uD648\uD398\uC774\uC9C0\uB85C \uC774\uB3D9\uD558\uBA74 \uC2A4\uD06C\uB9BD\uD2B8\uAC00 \uD65C\uC131\uD654\uB418\uC9C0 \uC54A\uC73C\uBA70 \uD398\uC774\uC9C0 \uC0C8\uB85C\uACE0\uCE68\uC774 \uD544\uC694\uD569\uB2C8\uB2E4.</li>
<li>Chrome\uACFC Firefox\uC758 \uD504\uB808\uC784\uB0B4\uC5D0\uC11C \uC0AC\uC774\uD2B8\uB97C \uC5EC\uB294 \uAC83\uC744 \uBC29\uC9C0\uD558\uB294 \uD655\uC7A5 \uD504\uB85C\uADF8\uB7A8\uC744 \uC0AC\uC6A9\uD558\uB294 \uACBD\uC6B0, E-Hentai\uC5D0\uC11C \uAC24\uB7EC\uB9AC \uB0B4 \uC774\uBBF8\uC9C0\uB97C \uC5F4 \uC218 \uC5C6\uAC8C \uB418\uBA70 \uC124\uC815 \uBA54\uB274 \uB610\uD55C \uD45C\uC2DC\uB418\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4. \uC774 \uBB38\uC81C\uB97C \uD574\uACB0\uD558\uB824\uBA74 \uD655\uC7A5 \uD504\uB85C\uADF8\uB7A8\uC744 \uBE44\uD65C\uC131\uD654\uD558\uAC70\uB098 \uC608\uC678 \uD56D\uBAA9\uC744 \uCD94\uAC00\uD558\uC138\uC694.</li>
</ul>

<h2>[\uC791\uB3D9 \uC6D0\uB9AC]</h2>
<p>\uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uB2E8\uC21C\uD55C jQuery(\uAD6C\uD615 \uC2A4\uD06C\uB9BD\uD2B8)\uC5D0\uC11C\uBD80\uD130 \uCD5C\uCCA8\uB2E8 Vue.js \uD504\uB808\uC784\uC6CC\uD06C\uC5D0 \uC774\uB974\uAE30\uAE4C\uC9C0 \uB9E4\uC6B0 \uB2E4\uC591\uD55C \uC6F9 \uAE30\uC220\uC5D0\uC11C \uC791\uB3D9\uD569\uB2C8\uB2E4. \uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uD574\uB2F9 \uAE30\uC220\uB4E4\uC744 \uD574\uD0B9\uD558\uC9C0 \uC54A\uACE0\uB3C4 \uC0C1\uD638\uC791\uC6A9\uD560 \uC218 \uC788\uB3C4\uB85D \uCD5C\uC801\uD654\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.</p>
<p>\uC124\uC815 \uD328\uB110\uC758 \uC790\uB3D9 \uC800\uC7A5 \uBC0F \uC0AC\uC774\uD2B8\uBCC4 \uC124\uC815 \uAE30\uB2A5\uC740 \uC2A4\uD06C\uB9BD\uD2B8\uC758 \uBCF8\uCCB4 \uCF54\uB4DC\uC5D0 \uC800\uC7A5\uB418\uC9C0 \uC54A\uC73C\uBA70, \uC2A4\uD06C\uB9BD\uD2B8\uC5D0\uC11C \uC218\uC9D1\uD558\uB294 \uC815\uBCF4\uB294 \uB85C\uCEEC \uCEF4\uD4E8\uD130\uC5D0\uB9CC \uC800\uC7A5\uB429\uB2C8\uB2E4.</p>
<p>\uB610\uD55C \uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uB9CE\uC740 \uC774\uBBF8\uC9C0\uB97C \uCC98\uB9AC\uD560 \uC218 \uC788\uB3C4\uB85D \uD6A8\uC728\uC801\uC73C\uB85C \uC124\uACC4\uB418\uC5C8\uC2B5\uB2C8\uB2E4. \uC774\uBBF8\uC9C0 \uB85C\uB529 \uC2DC\uC810\uC5D0\uC11C\uB294 \uBE0C\uB77C\uC6B0\uC800\uC5D0 \uC758\uC874\uD558\uBA70, \uC774\uBBF8\uC9C0 \uAD00\uB828 \uB370\uC774\uD130\uB294 \uC0AC\uC6A9\uC790 \uC2DC\uC2A4\uD15C\uC758 \uBA54\uBAA8\uB9AC\uB85C \uC9C1\uC811 \uB85C\uB4DC\uB429\uB2C8\uB2E4. \uC774\uB294 \uB370\uC774\uD130 \uC804\uC1A1\uB7C9\uACFC \uC11C\uBC84 \uC694\uCCAD \uC218\uB97C \uC904\uC774\uBA74\uC11C\uB3C4 \uBE60\uB974\uACE0 \uC720\uC5F0\uD55C \uC774\uBBF8\uC9D5\uC744 \uAC00\uB2A5\uD558\uAC8C \uD569\uB2C8\uB2E4.</p>

<h2>[\uC2A4\uD06C\uB9BD\uD2B8\uAC00 \uC791\uB3D9\uD558\uC9C0 \uC54A\uB294 \uC774\uC720\uB294 \uBB34\uC5C7\uC778\uAC00\uC694?]</h2>
<p>\uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uC6F9\uD398\uC774\uC9C0\uC758 HTML \uAD6C\uC870\uC640 \uC0C1\uD638\uC791\uC6A9\uD558\uAE30 \uB54C\uBB38\uC5D0 \uD398\uC774\uC9C0\uAC00 \uBCC0\uACBD\uB420 \uACBD\uC6B0(\uC608: \uAC1C\uBC1C\uC790\uAC00 \uC5C5\uB370\uC774\uD2B8\uB97C \uD558\uAC70\uB098 \uAD11\uACE0\uB97C \uC0BD\uC785\uD560 \uB54C) \uC608\uC0C1\uB300\uB85C \uC791\uB3D9\uD558\uC9C0 \uC54A\uC744 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uC774 \uACBD\uC6B0, \uBE0C\uB77C\uC6B0\uC800 \uCF58\uC194\uC744 \uC5F4\uC5B4 \uC624\uB958 \uBA54\uC2DC\uC9C0\uB97C \uD655\uC778\uD558\uC138\uC694. \uC624\uB958 \uBA54\uC2DC\uC9C0\uAC00 \uD45C\uC2DC\uB418\uBA74 GitHub \uC774\uC288 \uC139\uC158\uC5D0 \uBCF4\uACE0\uD574 \uC8FC\uC138\uC694.</p>

<h2>[\uAE30\uD0C0 \uC815\uBCF4]</h2>
<p>\uC124\uC815 \uD328\uB110\uC5D0\uC11C \uB2E4\uC591\uD55C \uC124\uC815 \uC635\uC158\uC744 \uC0AC\uC6A9\uD560 \uC218 \uC788\uC73C\uBA70, \uAC01 \uC124\uC815\uC740 \uC0AC\uC6A9\uC790 \uD658\uACBD\uC744 \uCD5C\uC801\uD654\uD558\uB294 \uB370 \uB3C4\uC6C0\uC774 \uB429\uB2C8\uB2E4. \uC2A4\uD06C\uB9BD\uD2B8\uAC00 \uC758\uB3C4\uB300\uB85C \uC791\uB3D9\uD558\uC9C0 \uC54A\uB294 \uACBD\uC6B0 GitHub \uC774\uC288\uC5D0\uC11C \uD574\uACB0 \uBC29\uBC95\uC744 \uCC3E\uC544\uBCF4\uC138\uC694.</p>
`,`
<h2>\xBFC\xF3mo se usa? \xBFD\xF3nde est\xE1 la entrada</h2>
<p>El script generalmente se activa en las p\xE1ginas principales de galer\xEDas o en las p\xE1ginas principales de artistas. Por ejemplo, en E-Hentai, se activa en la p\xE1gina de detalles de la galer\xEDa, o en Twitter, se activa en la p\xE1gina principal del usuario o en los tweets.p>
<p>Cuando est\xE9 activo, aparecer\xE1 un \xEDcono de <strong>&lt;\u{1F391}&gt;</strong> en la parte inferior izquierda de la p\xE1gina.</p>
<h2 style="color:red;">[Algunos problemas no resueltos]</h2>
<ul>
<li>Al usar Firefox para abrir la p\xE1gina principal de Twitter en una nueva pesta\xF1a y luego navegar a la p\xE1gina principal del usuario, el script no se activa y requiere actualizar la p\xE1gina.</li>
<li>En Firefox, la funci\xF3n de descarga no funciona en el dominio twitter.com. Firefox no redirige twitter.com a x.com cuando se abre en una nueva pesta\xF1a. Debes usar x.com en lugar de twitter.com.</li>
</ul>
<h2>[\xBFSe puede reubicar el punto de entrada o la barra de control del script?]</h2>
<p>\xA1S\xED! En la parte inferior del panel de configuraci\xF3n, hay una opci\xF3n de <strong>Arrastrar para mover</strong>. Arrastra el \xEDcono para reposicionar la barra de control en cualquier parte de la p\xE1gina.</p>
<h2>[\xBFPuede el script abrirse autom\xE1ticamente al navegar a la p\xE1gina correspondiente?]</h2>
<p>\xA1S\xED! Hay una opci\xF3n de <strong>Apertura Autom\xE1tica</strong> en el panel de configuraci\xF3n. Act\xEDvala para habilitar esta funci\xF3n.</p>
<h2>[\xBFC\xF3mo hacer zoom en las im\xE1genes?]</h2>
<p>Hay varias formas de hacer zoom en las im\xE1genes en el modo de lectura de im\xE1genes grandes:</p>
<ul>
<li>Clic derecho + rueda del rat\xF3n</li>
<li>Atajos de teclado</li>
<li>Controles de zoom en la barra de control: haz clic en los botones -/+, desplaza la rueda del rat\xF3n sobre los n\xFAmeros o arrastra los n\xFAmeros hacia la izquierda o derecha.</li>
</ul>
<h2>[\xBFC\xF3mo mantener el espacio entre im\xE1genes grandes?]</h2>
<p>En CONF > Style, modifique o a\xF1ada: .ehvp-root { --ehvp-big-images-gap: 2px; }</p>
<h2>[\xBFC\xF3mo abrir im\xE1genes de una p\xE1gina espec\xEDfica?]</h2>
<p>En la interfaz de lista de miniaturas, simplemente escribe el n\xFAmero de p\xE1gina deseado en tu teclado (sin necesidad de un aviso) y presiona Enter o utiliza tus atajos personalizados.</p>
<h2>[Acerca de la Lista de Miniaturas]</h2>
<p>La interfaz de lista de miniaturas es la caracter\xEDstica m\xE1s importante del script, ya que te permite obtener r\xE1pidamente una vista general de toda la galer\xEDa.</p>
<p>Las miniaturas se cargan de forma diferida, normalmente cargando alrededor de 20 im\xE1genes, lo que es comparable o incluso implica menos solicitudes que la navegaci\xF3n normal.</p>
<p>La paginaci\xF3n tambi\xE9n se carga de manera diferida, lo que significa que no todas las p\xE1ginas de la galer\xEDa se cargan a la vez. Solo cuando te acercas al final de la p\xE1gina, se carga la siguiente.</p>
<p>No te preocupes por generar muchas solicitudes al desplazarte r\xE1pidamente por la lista de miniaturas; el script est\xE1 dise\xF1ado para manejar esto de manera eficiente.</p>
<h2>[Acerca de la Carga Autom\xE1tica y la Carga Anticipada]</h2>
<p>Por defecto, el script carga autom\xE1ticamente y de manera gradual las im\xE1genes grandes una por una.</p>
<p>A\xFAn puedes hacer clic en cualquier miniatura para comenzar a cargar y leer desde ese punto, momento en el cual la carga autom\xE1tica se detendr\xE1 y se pre-cargar\xE1n 3 im\xE1genes desde la posici\xF3n de lectura.</p>
<p>Al igual que con la lista de miniaturas, no necesitas preocuparte por generar muchas solicitudes de carga al desplazarte r\xE1pidamente.</p>
<h2>[Acerca de la Descarga]</h2>
<p>La descarga est\xE1 integrada con la carga de im\xE1genes grandes. Cuando termines de navegar por una galer\xEDa y quieras guardar y descargar las im\xE1genes, puedes hacer clic en <strong>Iniciar Descarga</strong> en el panel de descargas. No te preocupes por volver a descargar las im\xE1genes ya cargadas.</p>
<p>Tambi\xE9n puedes hacer clic directamente en <strong>Iniciar Descarga</strong> en el panel de descargas sin necesidad de leer.</p>
<p>Alternativamente, haz clic en el bot\xF3n <strong>Tomar Cargadas</strong> en el panel de descargas si algunas im\xE1genes no se cargan consistentemente. Esto guardar\xE1 las im\xE1genes que ya se han cargado.</p>
<p>Los indicadores de estado del panel de descargas proporcionan una visi\xF3n clara del progreso de la carga de im\xE1genes.</p>
<p><strong>Nota:</strong> Cuando el tama\xF1o del archivo de descarga supere los 1.2 GB, se habilitar\xE1 autom\xE1ticamente la compresi\xF3n dividida. Si encuentras errores al extraer los archivos, por favor actualiza tu software de extracci\xF3n o usa 7-Zip.</p>
<h2>[\xBFPuedo seleccionar el rango de descarga?]</h2>
<p>S\xED, el panel de descargas tiene una opci\xF3n para seleccionar el rango de descarga (Cherry Pick), que se aplica a la descarga, carga autom\xE1tica y carga anticipada.</p>
<p>Incluso si una imagen est\xE1 excluida del rango de descarga, a\xFAn puedes hacer clic en su miniatura para verla, lo que cargar\xE1 la imagen grande correspondiente.</p>
<h2>[\xBFC\xF3mo seleccionar im\xE1genes en algunos sitios de ilustraci\xF3n?]</h2>
<p>En la lista de miniaturas, puedes usar algunas teclas de acceso r\xE1pido para seleccionar im\xE1genes:</p>
<ul>
<li><strong>Ctrl + Clic Izquierdo:</strong> Selecciona la imagen. La primera selecci\xF3n excluir\xE1 todas las dem\xE1s im\xE1genes.</li>
<li><strong>Ctrl + Shift + Clic Izquierdo:</strong> Selecciona el rango de im\xE1genes entre esta imagen y la \xFAltima imagen seleccionada.</li>
<li><strong>Alt + Clic Izquierdo:</strong> Excluye la imagen. La primera exclusi\xF3n seleccionar\xE1 todas las dem\xE1s im\xE1genes.</li>
<li><strong>Alt + Shift + Clic Izquierdo:</strong> Excluye el rango de im\xE1genes entre esta imagen y la \xFAltima imagen excluida.</li>
</ul>
<p>Adem\xE1s, hay otros m\xE9todos:</p>
<ul>
<li>Haz clic en el bot\xF3n del medio en una miniatura para abrir la URL de la imagen original, luego haz clic derecho para guardar la imagen.</li>
<li>Establece el rango de descarga en 1 en el panel de descargas. Esto excluir\xE1 todas las im\xE1genes excepto la primera. Luego, haz clic en las miniaturas de inter\xE9s en la lista, lo que cargar\xE1 las im\xE1genes grandes correspondientes. Despu\xE9s de seleccionar, borra el rango de descarga y haz clic en <strong>Tomar Cargadas</strong> para empaquetar y descargar tus im\xE1genes seleccionadas.</li>
<li>Desactiva la carga autom\xE1tica y establece la carga anticipada en 1 en el panel de configuraci\xF3n, luego procede como se describe anteriormente.</li>
</ul>
<h2>[\xBFPuedo operar el script mediante el teclado?]</h2>
<p>\xA1S\xED! Hay un bot\xF3n del <strong>Teclado</strong> en la parte inferior del panel de configuraci\xF3n. Haz clic en \xE9l para ver o configurar las operaciones del teclado.</p>
<p>\xA1Incluso puedes configurarlo para operar con una sola mano, liberando as\xED tu otra mano!</p>
<h2>[\xBFC\xF3mo apoyar al autor?]</h2>
<p>D\xE9jame una estrella en <a target='_blank' href='https://github.com/MapoMagpie/eh-view-enhance'>Github</a> o una buena rese\xF1a en <a target='_blank' href='https://greasyfork.org/scripts/397848-e-hentai-view-enhance'>Greasyfork</a>.</p>
<p>Por favor, no dejes rese\xF1as en Greasyfork, ya que su sistema de notificaciones no puede rastrear comentarios posteriores. Muchas personas dejan un problema y nunca vuelven.
Reporta problemas aqu\xED: <a target='_blank' href='https://github.com/MapoMagpie/eh-view-enhance/issues'>issue</a></p>
<h2>[\xBFC\xF3mo reabrir la gu\xEDa?]</h2>
<p>Haz clic en el bot\xF3n de <strong>Ayuda</strong> en la parte inferior del panel de configuraci\xF3n.</p>
`]},Mt={"open-full-view-grid":["Enter Read Mode","\u8FDB\u5165\u9605\u8BFB\u6A21\u5F0F","\uC77D\uAE30 \uBAA8\uB4DC \uC2DC\uC791","Entrar en modo de lectura"],"start-download":["Start Download","\u5F00\u59CB\u4E0B\u8F7D","\uB2E4\uC6B4\uB85C\uB4DC \uC2DC\uC791","Iniciar Descarga"],"step-image-prev":["Go Prev Image","\u5207\u6362\u5230\u4E0A\u4E00\u5F20\u56FE\u7247","\uC774\uC804 \uC774\uBBF8\uC9C0","Ir a la imagen anterior"],"step-image-next":["Go Next Image","\u5207\u6362\u5230\u4E0B\u4E00\u5F20\u56FE\u7247","\uB2E4\uC74C \uC774\uBBF8\uC9C0","Ir a la imagen siguiente"],"exit-big-image-mode":["Exit Big Image Mode","\u9000\u51FA\u5927\u56FE\u6A21\u5F0F","\uC774\uBBF8\uC9C0 \uD06C\uAC8C \uBCF4\uAE30 \uC885\uB8CC","Salir del modo de imagen grande"],"step-to-first-image":["Go First Image","\u8DF3\u8F6C\u5230\u7B2C\u4E00\u5F20\u56FE\u7247","\uCCAB \uC774\uBBF8\uC9C0\uB85C \uC774\uB3D9","Ir a la primera imagen"],"step-to-last-image":["Go Last Image","\u8DF3\u8F6C\u5230\u6700\u540E\u4E00\u5F20\u56FE\u7247","\uB9C8\uC9C0\uB9C9 \uC774\uBBF8\uC9C0\uB85C \uC774\uB3D9","Ir a la \xFAltima imagen"],"scale-image-increase":["Increase Image Scale","\u653E\u5927\u56FE\u7247","\uC774\uBBF8\uC9C0 \uD655\uB300","Aumentar la escala de la imagen"],"scale-image-decrease":["Decrease Image Scale","\u7F29\u5C0F\u56FE\u7247","\uC774\uBBF8\uC9C0 \uCD95\uC18C","Disminuir la escala de la imagen"],"scroll-image-up":["Scroll Image Up (Please Keep Default Keys)","\u5411\u4E0A\u6EDA\u52A8\u56FE\u7247 (\u8BF7\u4FDD\u7559\u9ED8\u8BA4\u6309\u952E)","\uC774\uBBF8\uC9C0 \uC704\uB85C \uC2A4\uD06C\uB864 (\uAE30\uBCF8 \uD0A4\uB294 \uADF8\uB300\uB85C \uB450\uC2ED\uC2DC\uC624)","Desplazar la imagen hacia arriba (Por favor, mantener las teclas predeterminadas)"],"scroll-image-down":["Scroll Image Down (Please Keep Default Keys)","\u5411\u4E0B\u6EDA\u52A8\u56FE\u7247 (\u8BF7\u4FDD\u7559\u9ED8\u8BA4\u6309\u952E)","\uC774\uBBF8\uC9C0 \uC544\uB798\uB85C \uC2A4\uD06C\uB864 (\uAE30\uBCF8 \uD0A4\uB294 \uADF8\uB300\uB85C \uB450\uC2ED\uC2DC\uC624)","Desplazar la imagen hacia abajo (Por favor, mantener las teclas predeterminadas)"],"toggle-auto-play":["Toggle Auto Play","\u5207\u6362\u81EA\u52A8\u64AD\u653E","\uC790\uB3D9 \uC7AC\uC0DD \uC2DC\uC791/\uC911\uC9C0","Alternar reproducci\xF3n autom\xE1tica"],"round-read-mode":["Switch Reading mode (Loop)","\u5207\u6362\u9605\u8BFB\u6A21\u5F0F(\u5FAA\u73AF)","\uC77D\uAE30 \uBAA8\uB4DC \uC804\uD658(\uB8E8\uD504)","Cambiar modo de lectura (bucle)"],"toggle-reverse-pages":["Toggle Pages Reverse","\u5207\u6362\u9605\u8BFB\u65B9\u5411","\uD398\uC774\uC9C0 \uBC18\uC804 \uC804\uD658","Alternar p\xE1ginas hacia atr\xE1s"],"rotate-image":["Rotate Image","\u65CB\u8F6C\u56FE\u7247","\uC774\uBBF8\uC9C0 \uD68C\uC804","Girar imagen"],"cherry-pick-current":["Cherry Pick Current Images","\u9009\u62E9\u5F53\u524D\u56FE\u7247","\uCCB4\uB9AC\uD53D \uD604\uC7AC \uC774\uBBF8\uC9C0","Im\xE1genes actuales de Cherry Pick"],"exclude-current":["Exclude current images","\u6392\u9664\u5F53\u524D\u56FE\u7247","\uD604\uC7AC \uC774\uBBF8\uC9C0 \uC81C\uC678","Excluir im\xE1genes actuales"],"open-big-image-mode":["Enter Big Image Mode","\u8FDB\u5165\u5927\u56FE\u9605\u8BFB\u6A21\u5F0F","\uC774\uBBF8\uC9C0 \uD06C\uAC8C \uBCF4\uAE30","Entrar al modo de imagen grande"],"pause-auto-load-temporarily":["Pause Auto Load Temporarily","\u4E34\u65F6\u505C\u6B62\u81EA\u52A8\u52A0\u8F7D","\uC790\uB3D9 \uC774\uBBF8\uC9C0 \uB85C\uB529 \uC77C\uC2DC \uC911\uC9C0","Pausar carga autom\xE1tica temporalmente"],"exit-full-view-grid":["Exit Read Mode","\u9000\u51FA\u9605\u8BFB\u6A21\u5F0F","\uC77D\uAE30 \uBAA8\uB4DC \uC885\uB8CC","Salir del modo de lectura"],"columns-increase":["Increase Columns ","\u589E\u52A0\u6BCF\u884C\u6570\u91CF","\uC5F4 \uC218 \uB298\uB9AC\uAE30","Aumentar columnas"],"columns-decrease":["Decrease Columns ","\u51CF\u5C11\u6BCF\u884C\u6570\u91CF","\uC5F4 \uC218 \uC904\uC774\uAE30","Disminuir columnas"],"retry-fetch-next-page":["Try Fetch Next Page","\u91CD\u65B0\u52A0\u8F7D\u4E0B\u4E00\u5206\u9875","\uB2E4\uC74C \uD398\uC774\uC9C0 \uB85C\uB529 \uC7AC\uC2DC\uB3C4","Intentar cargar la siguiente p\xE1gina"],"go-prev-chapter":["Switch To Previous Chapter","\u5207\u6362\u5230\u4E0A\u4E00\u7AE0\u8282","\uC774\uC804 \uC7A5\uC73C\uB85C \uC804\uD658","Cambiar al cap\xEDtulo anterior"],"go-next-chapter":["Switch To Next Chapter","\u5207\u6362\u5230\u4E0B\u4E00\u7AE0\u8282","\uB2E4\uC74C \uC7A5\uC73C\uB85C \uC804\uD658","cambiar al siguiente cap\xEDtulo"],"resize-flow-vision":["Resize Thumbnail Grid Layout","Resize Thumbnail Grid Layout","Resize Thumbnail Grid Layout","Resize Thumbnail Grid Layout"]};function He(s){return Object.entries(s).reduce((i,[n,r])=>(i[n]=new Rt(r),i),{})}const _={...He(Pt),keyboard:He(Mt)};function te(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}function Ce(){return window.btoa(te())}function xe(s){return btoa(encodeURIComponent(s).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}))}const X=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile/i.test(navigator.userAgent);function We(){const s=window.screen.width;return s>2500?7:s>1900?6:s>700?5:3}function Nt(){const s=window.screen.availHeight;return Math.floor(s/3.4)}function ge(){return{colCount:We(),rowHeight:Nt(),readMode:"pagination",gridMode:"flow",autoLoad:!0,fetchOriginal:!1,restartIdleLoader:2e3,threads:3,downloadThreads:4,timeout:10,version:Ze,debug:!0,first:!0,reversePages:!1,pageHelperAbTop:"unset",pageHelperAbLeft:"20px",pageHelperAbBottom:"20px",pageHelperAbRight:"unset",imgScale:100,defaultImgScaleModeC:60,autoPageSpeed:5,autoPlay:!1,hdThumbnails:!1,filenameTemplate:"{number}-{title}",preventScrollPageTime:100,archiveVolumeSize:1200,pixivConvertTo:"GIF",pixivImageServer:void 0,autoCollapsePanel:!0,minifyPageHelper:X?"never":"inBigMode",keyboards:{inBigImageMode:{},inFullViewGrid:{},inMain:{}},muted:!1,volume:50,paginationIMGCount:1,hitomiFormat:"auto",autoOpen:!1,autoLoadInBackground:!0,reverseMultipleImagesPost:!0,ehentaiTitlePrefer:"japanese",scrollingDelta:300,scrollingSpeed:20,id:te(),configPatchVersion:0,displayText:{},customStyle:"",magnifier:!1,autoEnterBig:!1,pixivRecordReading:!1,pixivAscendWorks:!1,filenameOrder:"auto",dragImageOut:!1,excludeVideo:!1,enableFilter:!1,imgNodeActions:[],minRatio:.5}}const Ze="4.4.0",Ie="ehvh_cfg_";function $t(){if(typeof je=="function"&&typeof Fe=="function")return{setItem:(s,e)=>Fe(s,e),getItem:s=>je(s)};if(typeof localStorage<"u")return{setItem:(s,e)=>localStorage.setItem(s,e),getItem:s=>localStorage.getItem(s)};throw new Error("No supported storage method found")}const ae=$t();function Ot(){const s=ae.getItem(Ie);if(s){let t=JSON.parse(s);if(t.version===Ze)return Dt(t)}const e=ge();return q(e),e}function Ae(s){const e=ae.getItem(Se(s));return e?JSON.parse(e):{}}function Dt(s){let e=!1;const t=ge(),i=Object.keys(t);i.forEach(o=>{s[o]===void 0&&(s[o]=t[o],e=!0)});const n=Object.keys(s);for(const o of n)i.includes(o)||(delete s[o],e=!0);["pageHelperAbTop","pageHelperAbLeft","pageHelperAbBottom","pageHelperAbRight"].forEach(o=>{if(s[o]!=="unset"){const a=parseInt(s[o]),l=o.endsWith("Right")||o.endsWith("Left")?window.screen.width:window.screen.height;(isNaN(a)||a<5||a>l)&&(s[o]="5px",e=!0)}}),["pagination","continuous","horizontal"].includes(s.readMode)||(s.readMode="pagination",e=!0),(s.imgScale===void 0||isNaN(s.imgScale)||s.imgScale===0)&&(s.imgScale=s.readMode==="continuous"?s.defaultImgScaleModeC:100,e=!0),s.imgNodeActions&&!(s.imgNodeActions instanceof Array)&&(s.imgNodeActions=[],e=!0);const r=Ut(s);return r&&(s=r,e=!0),e&&q(s),s}function Ut(s){let e=!1;return s.configPatchVersion<8&&(s.configPatchVersion=8,s.colCount=We(),s.keyboards={inBigImageMode:{},inFullViewGrid:{},inMain:{}},e=!0),s.configPatchVersion<10&&(s.configPatchVersion=10,s.customStyle="",e=!0),e?s:null}function qt(s){const e=confirm(`${_.resetConfig.get()}${s?" On "+s:" On "+_.global.get()} ?`);return e&&(s?ae.setItem(Se(s),""):q(ge())),e}function q(s,e){const t=Se(e),i=ae.getItem(t),n=i?JSON.parse(i):{};["selectedSiteNameConfig"].forEach(r=>delete n[r]),e&&["keyboards","siteProfiles"].forEach(r=>delete n[r]),ae.setItem(t,JSON.stringify({...n,...s}))}function Se(s){return s?Ie+xe(s).replaceAll(/[+=\/]/g,"-"):Ie}const Xe={imgSrcCSP:!1,originalPolicy:""},Ke=[{key:"colCount",typ:"number"},{key:"rowHeight",typ:"number"},{key:"threads",typ:"number"},{key:"downloadThreads",typ:"number"},{key:"paginationIMGCount",typ:"number"},{key:"timeout",typ:"number"},{key:"preventScrollPageTime",typ:"number"},{key:"autoPageSpeed",typ:"number"},{key:"scrollingDelta",typ:"number"},{key:"scrollingSpeed",typ:"number"},{key:"fetchOriginal",typ:"boolean",gridColumnRange:[1,6]},{key:"autoLoad",typ:"boolean",gridColumnRange:[6,11]},{key:"reversePages",typ:"boolean",gridColumnRange:[1,6]},{key:"autoPlay",typ:"boolean",gridColumnRange:[6,11]},{key:"autoLoadInBackground",typ:"boolean",gridColumnRange:[1,6]},{key:"autoOpen",typ:"boolean",gridColumnRange:[6,11]},{key:"magnifier",typ:"boolean",gridColumnRange:[1,6]},{key:"autoEnterBig",typ:"boolean",gridColumnRange:[6,11]},{key:"dragImageOut",typ:"boolean",gridColumnRange:[1,6]},{key:"hdThumbnails",typ:"boolean",gridColumnRange:[6,11]},{key:"autoCollapsePanel",typ:"boolean",gridColumnRange:[1,11]},{key:"pixivRecordReading",typ:"boolean",gridColumnRange:[1,11],displayInSite:/pixiv.net/},{key:"pixivAscendWorks",typ:"boolean",gridColumnRange:[1,11],displayInSite:/pixiv.net/},{key:"pixivImageServer",typ:"input",gridColumnRange:[1,11],placeholder:"https://i.pixiv.re",displayInSite:/pixiv.net/},{key:"reverseMultipleImagesPost",typ:"boolean",gridColumnRange:[1,11],displayInSite:/(x.com|twitter.com)\//},{key:"excludeVideo",typ:"boolean",gridColumnRange:[1,11],displayInSite:/(x.com|twitter.com|kemono.cr)\//},{key:"readMode",typ:"select",options:[{value:"pagination",display:"Pagination"},{value:"continuous",display:"Continuous"},{value:"horizontal",display:"Horizontal"}]},{key:"gridMode",typ:"select",options:[{value:"grid",display:"Grid"},{value:"flow",display:"Flow"}]},{key:"minifyPageHelper",typ:"select",options:[{value:"always",display:"Always"},{value:"inBigMode",display:"InBigMode"},{value:"never",display:"Never"}]},{key:"hitomiFormat",typ:"select",options:[{value:"auto",display:"Auto"},{value:"avif",display:"Avif"},{value:"webp",display:"Webp"},{value:"jxl",display:"Jxl"}],displayInSite:/hitomi.la\//},{key:"ehentaiTitlePrefer",typ:"select",options:[{value:"english",display:"English"},{value:"japanese",display:"Japanese"}],displayInSite:/e[-x]hentai(.*)?.(org|onion)\/|imhentai.xxx/},{key:"filenameOrder",typ:"select",options:[{value:"auto",display:"Auto"},{value:"numbers",display:"Numbers"},{value:"original",display:"Original"},{value:"alphabetically",display:"Alphabetically"}]}];class Bt{ready;resolve;reject;matchers;matcher;conf;globalConf;constructor(){this.ready=new Promise((e,t)=>this.resolve=e),this.matchers=[],this.globalConf=this.conf=Ot()}addSetup(e){this.matchers.push(e);const t=Ae(e.name);if(!(t.enable??!0))return;let i=t.workURLs?.map(n=>new RegExp(n))??[];i.length===0&&(i=e.workURLs),i.find(n=>n.test(window.location.href))&&(this.conf={...this.conf,...t},this.matcher=e,this.resolve?.(e))}}const h=new Bt;function A(s,e,...t){s==="debug"&&!h.conf.debug||(s==="error"?console.warn(new Date().toLocaleString(),"EHVP:"+e,...t):console.info(new Date().toLocaleString(),"EHVP:"+e,...t))}class zt{events;constructor(){this.events=new Map}emit(e,...t){["imf-download-state-change","imf-check-picked"].includes(e)||A("debug","event bus emitted: ",e);const i=this.events.get(e);let n;return i&&i.forEach(r=>n=r(...t)),n}subscribe(e,t){const i=this.events.get(e);i?i.push(t):this.events.set(e,[t])}reset(){this.events=new Map}}const f=new zt;class W{tids;mode;lastExecTime;constructor(e){this.tids={},this.lastExecTime=Date.now(),this.mode=e||"debounce"}addEvent(e,t,i){if(this.mode==="throttle"){const n=Date.now();n-this.lastExecTime>=i&&(this.lastExecTime=n,t())}else this.mode==="debounce"&&(window.clearTimeout(this.tids[e]),this.tids[e]=window.setTimeout(t,i))}}const Gt=new It({features:["wasm"]}),Vt={filter:"box"};async function jt(s,e){return Gt.resize(s,e,Vt).then()}const ie="data:image/gif;base64,R0lGODlhAQABAIAAAMLCwgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==",ke=document.createElement("div");ke.classList.add("img-node"),ke.innerHTML=`
<a>
  <img decoding="async" loading="eager" title="untitle.jpg" src="" style="display: none;" />
  <canvas id="sample-canvas" width="100" height="100"></canvas>
</a>`;const Ee=document.createElement("div");Ee.classList.add("overlay-tip"),Ee.innerHTML="<span>GIF</span>";const Ft=/\.(\w+)[^\/]*$|twimg.*format=(\w+)/;class se{icon;description;func;reueable=!1;done=!1;processing=!1;constructor(e,t,i,n){this.icon=e,this.description=t,this.func=i,this.reueable=n??!1}}class k{root;thumbnailSrc;href;title;onclick;imgElement;canvasElement;canvasCtx;delaySRC;_originSrc;blobSrc;mimeType;downloadBar;picked=!0;debouncer=new W;rect;tags;actions=[];get originSrc(){return this._originSrc}set originSrc(e){this._originSrc=e,this.updateTagByExtension()}constructor(e,t,i,n,r,o){this.href=t,this.title=i,this.delaySRC=n,this.rect=o,this.tags=new Set,this.thumbnailSrc=e,this.originSrc=r}setTags(...e){e.forEach(t=>this.tags.add(t))}updateTagByExtension(){let e=this.originSrc||this.thumbnailSrc;if(!e)return;const t=e.match(Ft)?.find((i,n)=>n>0&&i);t&&this.updateTagByPrefix("ext:"+t)}updateTagByPrefix(e){if(this.tags.has(e))return;const t=e.split(":").shift();if(!t)return;const i=Array.from(this.tags.entries()).find(([n])=>n.startsWith(t));i?.[0]&&this.tags.delete(i?.[0]),this.tags.add(e)}create(){this.root=ke.cloneNode(!0);const e=this.root.firstElementChild;e.href=this.href,e.target="_blank",this.imgElement=e.firstElementChild,this.canvasElement=e.lastElementChild,this.imgElement.setAttribute("title",this.title),this.canvasElement.id="canvas-"+this.title.replaceAll(/[^\w]/g,"_");const t=Math.max(h.conf.minRatio,this.ratio());return this.root.style.aspectRatio=t.toString(),this.root.setAttribute("data-ratio",t.toString()),this.canvasElement.width=512,this.canvasElement.height=Math.floor(512/t),this.canvasCtx=this.canvasElement.getContext("2d"),this.canvasCtx.fillStyle="#aaa",this.canvasCtx.fillRect(0,0,this.canvasElement.width,this.canvasElement.height),this.onclick&&e.addEventListener("click",i=>{i.preventDefault(),this.onclick(i)},{passive:!1,capture:!1}),this.root.addEventListener("mouseenter",()=>{if(this.actions.length===0||(this.root.addEventListener("mouseleave",()=>{this.root.querySelector(".img-node-actions > .img-node-action-btn-processing")||this.root.querySelector(".img-node-actions")?.remove()}),this.root.querySelector(".img-node-actions")))return;const i=document.createElement("div");i.classList.add("img-node-actions");for(const n of this.actions){const r=document.createElement("button");r.classList.add("img-node-action-btn"),n.done&&r.classList.add("img-node-action-btn-done"),r.textContent=n.icon,r.addEventListener("click",o=>{const a=o.target;a.disabled=!0,a.classList.add("img-node-action-btn-processing"),n.processing=!0,n.func(this).then(()=>{a.classList.remove("img-node-action-btn-processing"),a.classList.add("img-node-action-btn-done"),a.disabled=!1,n.done=!0}).catch(l=>{a.classList.remove("img-node-action-btn-processing"),a.classList.add("img-node-action-btn-error"),a.disabled=!1,f.emit("notify-message","error",`execute action [${n.icon}] failed, reason: ${l}`),console.error(l)}).finally(()=>n.processing=!1)},{passive:!1,capture:!0}),i.appendChild(r)}this.root.appendChild(i)}),this.root}resize(e,t){if(!this.root||!this.imgElement||!this.canvasElement)return e("undefined elements");if(!this.imgElement.src||this.imgElement.src===ie)return e("empty or default src");if(this.root.offsetWidth<=1)return e("element too small");if(this.imgElement.src===this.imgElement.getAttribute("data-rendered"))return;this.imgElement.onload=null,this.imgElement.onerror=null;const i=Math.max(h.conf.minRatio,this.ratio());this.rect={w:this.imgElement.naturalWidth,h:this.imgElement.naturalHeight};const n=Math.max(h.conf.minRatio,this.ratio()),r=this.root.parentElement?.classList.contains("fvg-sub-container");Math.abs(n-i)>.07&&(this.root.style.aspectRatio=n.toString(),this.root.setAttribute("data-ratio",n.toString()),r?(this.canvasElement.height=this.root.offsetHeight,this.canvasElement.width=Math.floor(this.root.offsetHeight/n)):(this.canvasElement.width=this.root.offsetWidth,this.canvasElement.height=Math.floor(this.root.offsetWidth*n)),t());const o=c=>{this.imgElement.src="",this.imgElement.setAttribute("data-rendered",c)},a=this.imgElement.naturalWidth/n,l=(this.imgElement.naturalHeight-a)/2;if(this.imgElement.src===this.thumbnailSrc)this.canvasCtx?.drawImage(this.imgElement,0,l,this.imgElement.naturalWidth,a,0,0,this.canvasElement.width,this.canvasElement.height),o(this.imgElement.src);else{const c=d=>{jt(d,this.canvasElement).then(()=>window.setTimeout(()=>o(this.imgElement.src),100)).catch(()=>o(this.canvasCtx?.drawImage(this.imgElement,0,l,this.imgElement.naturalWidth,a,0,0,this.canvasElement.width,this.canvasElement.height)||""))};this.ratio()<h.conf.minRatio?createImageBitmap(this.imgElement,0,l,this.imgElement.naturalWidth,a).then(c):c(this.imgElement)}}ratio(){return this.rect?Math.floor(this.rect.w/this.rect.h*1e3)/1e3:1}render(e,t,i){this.debouncer.addEvent("IMG-RENDER",()=>{if(!this.imgElement)return e("element undefined");let n=!i&&(!h.conf.hdThumbnails||!this.blobSrc);if(this.mimeType==="image/gif"||this.mimeType?.startsWith("video")){const r=Ee.cloneNode(!0);r.firstChild.textContent=this.mimeType.split("/")[1].toUpperCase(),this.root?.appendChild(r),n=!0}if(this.imgElement.onload=()=>this.resize(e,t),this.imgElement.onerror=()=>e("img load error"),n){const r=this.delaySRC;this.delaySRC=void 0,r?r.then(o=>(this.thumbnailSrc=o)&&this.render(e,t)).catch(e):this.imgElement.src=this.thumbnailSrc||this.blobSrc||ie}else this.imgElement.src=this.blobSrc||this.thumbnailSrc||ie},30)}unrender(){this.imgElement&&(this.imgElement.src="")}progress(e){if(this.root){if(e.readyState===4){this.downloadBar&&this.downloadBar.parentNode&&this.downloadBar.parentNode.removeChild(this.downloadBar);return}if(!this.downloadBar){const t=document.createElement("div");t.classList.add("download-bar"),t.innerHTML='<div style="width: 0%"></div>',this.downloadBar=t,this.root.firstElementChild.appendChild(this.downloadBar)}this.downloadBar&&(this.downloadBar.firstElementChild.style.width=e.loaded/e.total*100+"%")}}changeStyle(e,t){if(!this.root)return;const i=()=>this.root.classList.forEach(n=>["img-excluded","img-fetching","img-fetched","img-fetch-failed"].includes(n)&&this.root?.classList.remove(n));if(!this.picked)i(),this.root.classList.add("img-excluded");else switch(e){case"fetching":i(),this.root.classList.add("img-fetching");break;case"fetched":i(),this.root.classList.add("img-fetched");break;case"failed":i(),this.root.classList.add("img-fetch-failed");break;case"init":i();break}if(this.root.querySelector(".img-node-error-hint")?.remove(),t){const n=document.createElement("div");n.classList.add("img-node-error-hint"),n.innerHTML=`<span>${t}</span><br><span style="color: white;">You can click here retry again,<br>Or press mouse middle button to open origin image url</span>`,this.root.firstElementChild.appendChild(n)}}equal(e){return e===this.root||e===this.root?.firstElementChild||e===this.canvasElement||e===this.imgElement}}function Ye(s,e,t,i,n){if(ue===void 0)throw new Error("your userscript manager does not support Gm_xmlhttpRequest api");return ue({method:"GET",url:s,timeout:n||6e5,responseType:e,nocache:!1,revalidate:!1,headers:{Referer:window.location.href,"Cache-Control":"public, max-age=2592000, immutable",...i},...t})?.abort}function Le(s,e,t){return new Promise((i,n)=>{try{Ye(s,e,{onload:r=>i(r.response),onerror:r=>n(r)},t??{},10*1e3)}catch(r){n(r)}})}async function Te(s,e,t="text"){const i=new Array(s.length);let n=0;for(;n<s.length;){const o=s.slice(n,n+e).map((a,l)=>window.fetch(a).then(c=>{if(c.ok)try{switch(t){case"text":return c.text();case"json":return c.json();case"arraybuffer":return c.arrayBuffer()}}catch(d){throw new Error(`failed to fetch ${a}: ${c.status} ${d}`)}throw new Error(`failed to fetch ${a}: ${c.status} ${c.statusText}`)}).then(c=>i[l+n]=c).catch(c=>i[l+n]=new Error(c)));await Promise.all(o),n+=e}return i}var z=(s=>(s[s.FAILED=0]="FAILED",s[s.URL=1]="URL",s[s.DATA=2]="DATA",s[s.DONE=3]="DONE",s))(z||{});class Ht{index;node;stage=1;tryTimes=0;lock=!1;rendered=!1;data;contentType;downloadState;timeoutId;matcher;chapterIndex;chapterID;randomID;failedReason;abortSignal=void 0;constructor(e,t,i,n,r){this.index=e,this.node=t,this.node.onclick=o=>{o.ctrlKey||o.metaKey?f.emit("add-cherry-pick-range",this.chapterIndex,this.index,!0,o.shiftKey):o.altKey?f.emit("add-cherry-pick-range",this.chapterIndex,this.index,!1,o.shiftKey):f.emit("imf-on-click",this)},this.downloadState={total:100,loaded:0,readyState:0},this.matcher=i,this.chapterIndex=n,this.chapterID=r,this.randomID=n+Math.random().toString(16).slice(2)+this.node.href}create(){const e=this.node.create(),t=document.createElement("div");return t.classList.add("img-node-numtip"),t.innerHTML=`<span>${this.index+1}</span>`,e.firstElementChild.appendChild(t),e}setDownloadState(e){this.downloadState={...this.downloadState,...e},this.node.progress(this.downloadState),f.emit("imf-download-state-change",this)}async start(){if(!this.lock){this.lock=!0;try{this.node.changeStyle("fetching"),await this.fetchImage(),this.node.changeStyle("fetched"),f.emit("imf-on-finished",this.index,!0,this),this.failedReason=void 0}catch(e){this.failedReason=e.toString(),this.node.changeStyle("failed",this.failedReason),A("error","IMG-FETCHER ERROR:",e),this.stage=0,f.emit("imf-on-finished",this.index,!1,this)}finally{this.lock=!1}}}resetStage(){this.node.changeStyle("init"),this.stage=1}async fetchImage(){const e=async()=>{try{switch(this.stage){case 0:case 1:const i=await this.fetchOriginMeta();return this.node.originSrc=i.url,this.node.updateTagByExtension(),i.title&&(this.node.title=i.title,this.node.imgElement&&(this.node.imgElement.title=i.title)),this.node.href=i.href||this.node.href,this.stage=2,e();case 2:const n=await this.fetchImageData();if([this.data,this.contentType]=n,[this.data,this.contentType]=await this.matcher.processData(this.data,this.contentType,this.node),this.node.updateTagByPrefix("mime:"+(this.contentType??"unknown")),this.contentType.startsWith("text")){const r=new TextDecoder().decode(this.data);throw A("error",`unexpect content:
`,r),new Error(`expect image data, fetched wrong type: ${this.contentType}, the content is showing up in console(F12 open it).`)}this.node.blobSrc=Xe.imgSrcCSP?this.node.originSrc:URL.createObjectURL(new Blob([this.data],{type:this.contentType})),this.node.mimeType=this.contentType,this.node.render(r=>{A("error","render image failed, "+r),this.rendered=!1},()=>f.emit("imf-resize",this)),this.stage=3;case 3:return null}}catch(i){return this.stage=0,i}};this.tryTimes=0;let t;for(;this.tryTimes<3;){if(t=await e(),t===null)return;this.tryTimes++,A("error",`fetch image error, try times: ${this.tryTimes}, error:`,t)}throw t}async fetchOriginMeta(){return await this.matcher.fetchOriginMeta(this.node,this.tryTimes>0||this.stage===0,this.chapterID)}async fetchImageData(){const e=await this.fetchBigImage();if(e==null)throw new Error(`fetch image data is empty, image url:${this.node.originSrc}`);return e.arrayBuffer().then(t=>[new Uint8Array(t),e.type])}render(e){const t=f.emit("imf-check-picked",this.chapterIndex,this.index)??this.node.picked,i=t!==this.node.picked;if(this.node.picked=t,e&&(this.rendered=!1),!this.rendered)this.rendered=!0,this.node.render(n=>{A("error","render image failed, "+n),this.rendered=!1},()=>f.emit("imf-resize",this),e),this.node.changeStyle(this.stage===3?"fetched":void 0,this.failedReason);else if(i){let n;switch(this.stage){case 0:n="failed";break;case 1:n="init";break;case 2:n="fetching";break;case 3:n="fetched";break}this.node.changeStyle(n,this.failedReason)}}isRender(){return this.rendered}unrender(){this.rendered&&(this.rendered=!1,this.node.unrender(),this.node.changeStyle("init"))}ratio(){return this.node.ratio()}async fetchBigImage(){if(this.node.originSrc?.startsWith("blob:"))return await fetch(this.node.originSrc).then(t=>t.blob());const e=this;return new Promise(async(t,i)=>{const n=new W,r=()=>{n.addEvent("XHR_TIMEOUT",()=>{this.abort(),i(new Error("timeout"))},h.conf.timeout*1e3)};try{this.abortSignal=Ye(e.node.originSrc,"blob",{onload:function(o){const a=o.response;try{e.setDownloadState({readyState:o.readyState})}catch(l){A("error","warn: fetch big image data onload setDownloadState error:",l)}e.abortSignal=void 0,t(a)},onerror:function(o){if(e.abortSignal=void 0,o.status===0&&o.error?.includes("URL is not permitted")){const a=o.error.match(/(https?:\/\/.*?)\/.*/)?.[1]??"";i(new Error(_.failFetchReason1.get().replace("{{domain}}",a)))}else i(new Error(`response status:${o.status}, error:${o.error}, response:${o.response}`))},onprogress:function(o){e.setDownloadState({total:o.total,loaded:o.loaded,readyState:o.readyState}),r()},onloadstart:function(){e.setDownloadState(e.downloadState)}},this.matcher.headers()),r()}catch(o){i(o)}})}abort(){this.abortSignal?.(),this.abortSignal=void 0}}class O{id;title;source;queue;filteredQueue;thumbimg;sourceIter;done;onclick;meta;constructor(e,t,i,n){this.id=e,this.title=t,this.source=i,this.queue=[],this.thumbimg=n,this.filteredQueue=[]}}class Wt{chapters=[];chapterIndex=0;queue;matcher;filter;beforeInit;afterInit;nodeActionDesc=[];appendPageLock=!1;abortb=!1;constructor(e,t,i){this.queue=e,this.matcher=t,this.filter=i,this.filter.onChange=()=>this.changeToChapter(this.chapterIndex);const n=new W;f.subscribe("ifq-on-finished-report",r=>n.addEvent("APPEND-NEXT-PAGES",()=>this.appendPages(r),5)),f.subscribe("imf-on-finished",(r,o,a)=>{r===0&&o&&(this.chapters[a.chapterIndex].thumbimg=a.node.blobSrc)}),f.subscribe("pf-try-extend",()=>n.addEvent("APPEND-NEXT-PAGES",()=>!this.queue.downloading?.()&&this.appendNextPage(),5)),f.subscribe("pf-retry-extend",()=>!this.queue.downloading?.()&&this.appendNextPage(!0)),f.subscribe("pf-init",r=>this.init().then(r)),f.subscribe("pf-append-chapters",r=>this.appendNewChapters(r).then(()=>this.chapters)),f.subscribe("pf-step-chapters",r=>{if(r==="prev"){const o=this.chapterIndex-1;if(o<0)return;this.changeToChapter(o),f.emit("notify-message","info","switch to chapter: "+this.chapters[o].title,2e3)}else if(r==="next"){const o=this.chapterIndex+1;if(o>=this.chapters.length)return;this.changeToChapter(o),f.emit("notify-message","info","switch to chapter: "+this.chapters[o].title,2e3)}}),f.subscribe("filter-update-all-tags",async()=>{const r=this.chapters[this.chapterIndex],o=new Set;r.filteredQueue.forEach(a=>a.node.tags.forEach(l=>o.add(l))),this.filter.allTags=o})}appendToView(e,t,i,n){f.emit("pf-on-appended",e,t,i,n)}abort(){this.abortb=!0}async appendNewChapters(e){try{const t=await this.matcher.appendNewChapters(e,this.chapters);t&&t.length>0&&(t.forEach(i=>{i.sourceIter=this.matcher.fetchPagesSource(i),i.onclick=n=>this.changeToChapter(n)}),this.chapters.push(...t),f.emit("pf-update-chapters",this.chapters,!0))}catch(t){f.emit("notify-message","error",`${t}`)}}async init(){this.beforeInit?.();try{if(h.conf.imgNodeActions.length>0){const e=async function(){}.constructor;this.nodeActionDesc=h.conf.imgNodeActions.filter(t=>t.workon?new RegExp(t.workon).test(window.location.href):!0).map(t=>({icon:t.icon,description:t.description,fun:e("imf","imn","gm_xhr","EBUS",t.funcBody)}))}}catch(e){console.error(e),f.emit("notify-message","error","cannot create your node actions, "+e)}this.chapters=await this.matcher.fetchChapters().catch(e=>f.emit("notify-message","error",e.toString())||[]),this.afterInit?.(),this.chapters.forEach(e=>{e.sourceIter=this.matcher.fetchPagesSource(e),e.onclick=t=>this.changeToChapter(t)}),f.emit("pf-update-chapters",this.chapters),this.chapters.length===1&&this.changeToChapter(0)}changeToChapter(e){this.chapterIndex=e,f.emit("pf-change-chapter",e,this.chapters[e]);const t=this.chapters[e];t.filteredQueue=[...this.filter.filterNodes(t.queue,!0)],t.filteredQueue.forEach((i,n)=>i.index=n),t.filteredQueue.length>0&&this.appendToView(t.filteredQueue.length,t.filteredQueue,e,this.chapters[e].done),this.queue.downloading?.()||(this.beforeInit?.(),this.restoreChapter(e).then(this.afterInit).catch(this.onFailed))}async restoreChapter(e){this.chapterIndex=e;const t=this.chapters[this.chapterIndex];if(this.queue.restore(e,t.filteredQueue),!t.sourceIter){A("error","chapter sourceIter is not set!");return}if(t.queue.length===0){const i=await t.sourceIter.next();if(!i.done){if(i.value.error)throw i.value.error;await this.appendImages(i.value.value)}this.appendPages(this.queue.length)}}async appendPages(e){for(;!(e+60<this.queue.length||!await this.appendNextPage()););}async appendNextPage(e){if(this.appendPageLock)return!1;try{this.appendPageLock=!0;const t=this.chapters[this.chapterIndex];if(e&&(t.done=!1),t.done||this.abortb)return!1;const i=await t.sourceIter.next();if(i.done)return t.done=!0,this.appendToView(this.queue.length,[],this.chapterIndex,!0),!1;if(i.value.error)throw t.done=!0,i.value.error;return await this.appendImages(i.value.value)}catch(t){return A("error","PageFetcher:appendNextPage error: ",t),this.onFailed?.(t),!1}finally{this.appendPageLock=!1}}async appendImages(e){try{const t=await this.obtainImageNodeList(e);if(this.abortb||t.length===0)return!1;const i=this.chapters[this.chapterIndex],n=i.filteredQueue.length,r=t.map((a,l)=>{const c=new Ht(l+n,a,this.matcher,this.chapterIndex,this.chapters[this.chapterIndex].id);return this.nodeActionDesc.forEach(d=>{const p=async u=>{const g=await d.fun(c,u,ue,f);g?.data&&(c.contentType=g.data.type,c.data=new Uint8Array(await g.data.arrayBuffer()),c.node.blobSrc=URL.createObjectURL(new Blob([c.data],{type:c.contentType})),c.render(!0),f.emit("imf-on-finished",c.index,!0,c))};a.actions.push(new se(d.icon,d.description,p))}),c});i.queue.push(...r);const o=this.filter.filterNodes(r,!1);return o.forEach((a,l)=>a.index=n+l),i.filteredQueue.push(...o),this.queue.push(...o),this.appendToView(this.queue.length,o,this.chapterIndex),!0}catch(t){return A("error","page fetcher append images error: ",t),this.onFailed?.(t),!1}}async obtainImageNodeList(e){let t=0,i;for(;t<3;)try{return await this.matcher.parseImgNodes(e,this.chapters[this.chapterIndex].id)}catch(n){A("error","warn: parse image nodes failed, retrying: ",n),t++,i=n}throw A("error","warn: parse image nodes failed: reached max try times!"),i}onFailed(e){f.emit("notify-message","error",e.toString())}}class I{value;error;static ok(e){return{value:e}}static err(e){return{error:e}}}class R{async fetchChapters(){return[new O(0,"Default",window.location.href)]}title(e){const t=this.galleryMeta(e[0]);return t.originTitle||t.title||"unknown"}galleryMeta(e){return new P(window.location.href,document.title||"unknown")}async processData(e,t,i){return[e,t]}headers(){return{}}appendNewChapters(e,t){throw new Error("this site does not support add new chapters yet")}}function Zt(s){return md5(s)}function Xt(s,e){s=window.atob(s),e=window.atob(e);let t=Zt(s+e).slice(-1).charCodeAt(0);return parseInt(s)>=268850&&parseInt(s)<=421925?t%=10:parseInt(s)>=421926&&(t%=8),t<10?2+2*t:10}function Kt(s,e,t,i){const n=e.width,r=e.height,o=Xt(window.btoa(t),window.btoa(i)),a=parseInt((r%o).toString()),l=n;for(let c=0;c<o;c++){let d=Math.floor(r/o),p=d*c;const u=r-d*(c+1)-a;c==0?d+=a:p+=a,s.drawImage(e,0,u,l,d,0,p,l,d)}}class Yt extends R{meta;async fetchChapters(){const e=[],t=document.querySelector(".thumb-overlay > img"),i=Array.from(document.querySelectorAll(".visible-lg .episode > ul > a"));if(i.length>0)i.forEach((n,r)=>{const o=Array.from(n.querySelector("li")?.childNodes||[]).map(l=>l.textContent?.trim()).filter(Boolean).map(l=>l),a=new URL(n.href);a.searchParams.set("read_mode","read-by-page"),e.push(new O(r,o,a.href,t?.src))});else{const n=document.querySelector(".visible-lg .read-block")?.firstElementChild;if(n===void 0)throw new Error("No page found");let r="";if(n instanceof HTMLAnchorElement?r=n.href:r=n.getAttribute("href")||"",!r||r.startsWith("javascript"))throw new Error("\u672A\u80FD\u627E\u5230\u9605\u8BFB\u6309\u94AE\uFF01");if(r.startsWith("#coinbuycomic"))throw new Error("\u6B64\u6F2B\u753B\u9700\u8981\u786C\u5E01\u89E3\u9501\uFF01\u8BF7\u70B9\u51FB\u5F00\u59CB\u9605\u8BFB\u6309\u94AE\u8FDB\u884C\u89E3\u9501\u3002");const o=new URL(r);o.searchParams.set("read_mode","read-by-page"),e.push(new O(0,"Default",o.href))}return e}async*fetchPagesSource(e){yield I.ok(e.source)}async parseImgNodes(e){const t=[],i=await window.fetch(e).then(o=>o.text()),n=new DOMParser().parseFromString(i,"text/html"),r=Array.from(n.querySelectorAll(".owl-carousel-page > .center > img"));for(const o of r){const a=o.getAttribute("data-src");if(!a){A("error","warn: cannot find img src",o);continue}const l=a.split("/").pop();t.push(new k("",a,l,void 0,a))}return t}async processData(e,t,i){const n=/(\d+)\/(\d+)\.(\w+)/,r=i.originSrc.match(n),o=r[1];if(Number(o)<220980)return[e,t];const l=r[2];if(r[3]==="gif")return[e,t];const d=await createImageBitmap(new Blob([e],{type:t})),p=document.createElement("canvas");p.width=d.width,p.height=d.height;const u=p.getContext("2d");return Kt(u,d,o,l),new Promise(g=>p.toBlob(m=>m?.arrayBuffer().then(b=>g([new Uint8Array(b),m.type])).finally(()=>p.remove()),t))}galleryMeta(){if(this.meta)return this.meta;const e=document.querySelector(".panel-heading h2")?.textContent||document.title||"UNTITLE";this.meta=new P(window.location.href,e),this.meta.originTitle=e;const t=document.querySelectorAll("div.tag-block > span"),i={};return t.forEach(n=>{const r=n.getAttribute("data-type")?.trim();if(r){const o=Array.from(n.querySelectorAll("a")).map(a=>a.textContent).filter(Boolean);o.length>0&&(i[r]=o)}}),this.meta.tags=i,this.meta}async fetchOriginMeta(e,t){let i=e.originSrc;if(t){const n=i.match(/\/\/cdn-msp(\d)?\./);let r=1;n!==null&&n.length>0&&(r=parseInt(n[1]??"1"),isNaN(r)&&(r=1),r++,r=r%3,r=r===0?r=3:r),i=i.replace(/\/\/cdn-msp(\d)?\./,`//cdn-msp${r===1?"":r}.`)}return{url:i}}}h.addSetup({name:"\u7981\u6F2B",workURLs:[/(18|jm)comic.*?\/album\/\d+/],match:["https://18comic.vip/*"],constructor:()=>new Yt});const Jt=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class Qt extends R{async*fetchPagesSource(){yield I.ok(document)}async parseImgNodes(e){const t=Array.from(e.querySelectorAll(".single-thumb > a")),i=t.length.toString().length,n=t.map((l,c)=>{const d=l.href,p=l.querySelector("img.lazy");if(!p)throw new Error("cannot find image element");const u=p.getAttribute("data-src")??"",g=u.split(".").pop()??"jpg",m=(c+1).toString().padStart(i,"0")+"."+g;return new k(u,d,m,void 0,void 0,{w:p.width,h:p.height})});if(n.length===0)throw new Error("cannot find images by css selector: .single-thumb > a");const r=await window.fetch(n[0].href).then(l=>l.text()).then(l=>new DOMParser().parseFromString(l,"text/html")).catch(Error);if(r instanceof Error)throw r;const a=Array.from(r.querySelectorAll("script")).find(l=>l.textContent?.trimStart().startsWith("var readerPages "))?.textContent?.match(/var readerPages = JSON\.parse\(atob\("(.*)?\"\)\)/)?.[1];if(a){const l=JSON.parse(window.atob(a));n.forEach((c,d)=>{const p=l.pages[(d+1).toString()];p&&(c.title=p.f??c.title,c.originSrc=l.baseUriImg.replace("%s",p.f),c.rect={w:p.w,h:p.h})})}return n}async fetchOriginMeta(e){if(e.originSrc)return{url:e.originSrc};const t=await window.fetch(e.href).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html")).catch(Error);if(t instanceof Error)throw t;const i=t.querySelector(".js-main-img");if(!i)throw new Error("cannot find image from: "+e.href);return{url:i.src,title:i.src.split("/").pop()??e.title}}meta;galleryMeta(){if(this.meta)return this.meta;const e=document.querySelector("#main-info > h1")?.textContent??document.title,t=new P(window.location.href,e);return Array.from(document.querySelectorAll(".tag-container.field-name")).forEach(i=>{const n=i.firstChild?.textContent?.trim()?.replace(":","")?.toLowerCase(),r=Array.from(i.querySelectorAll("span.filter-elem"));if(n&&r.length>0){const o=r.map(a=>a.textContent?.trim()).filter(Boolean);t.tags[n]=o}}),this.meta=t,this.meta}}h.addSetup({name:"3Hentai",workURLs:[/3hentai.net\/d\/\d+$/],constructor:()=>new Qt});const ei=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class ti extends R{originImages;index=0;meta;title(){return this.galleryMeta().title}galleryMeta(){return this.meta||(this.meta=this.initGalleryMeta(document)),this.meta}initGalleryMeta(e){const t=e.querySelector("header.entry-header > h1")?.textContent??e.title,i=new P(window.location.href,t);return i.originTitle=e.querySelector("header.entry-header > span")?.textContent||void 0,i.tags=Array.from(e.querySelectorAll("ul.info-list > li.meta-data")).reduce((n,r)=>{const o=r.querySelector("span.data")?.textContent?.replace(":","").toLowerCase().trim();return o&&(n[o]=Array.from(r.querySelectorAll("span.value")).map(a=>a.textContent?.trim()).filter(Boolean)),n},{}),i}async*fetchPagesSource(){const e=document.querySelector("meta[name='csrf-token'][content]")?.content;if(!e)throw new Error("cannot get csrf token form this page");this.originImages=await window.fetch(window.location.href,{headers:{"X-CSRF-TOKEN":e,"X-Requested-With":"XMLHttpRequest","Sec-Fetch-Dest":"empty"},method:"POST"}).then(r=>r.json());const t=Array.from(document.querySelectorAll("body > script")).find(r=>r.textContent?.trimStart().startsWith("var ajx"))?.textContent?.match(/pag = (\{.*?\}),/s)?.[1];if(!t)throw new Error("cannot get page info");const i=JSON.parse(t.replaceAll(/(\w+) :/g,'"$1":'));let n=i.idx;for(yield I.ok(document);n*i.stp<i.cnt;){const r=await window.fetch(i.act,{headers:{"X-CSRF-TOKEN":e,"X-Requested-With":"XMLHttpRequest","Sec-Fetch-Dest":"empty","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},method:"POST",body:`index=${n}`});r.ok||(yield I.err(new Error(`fetch thumbnails failed, status: ${r.statusText}`))),n++,yield I.ok(await r.text().then(o=>new DOMParser().parseFromString(o,"text/html")))}}async parseImgNodes(e){const t=Array.from(e.querySelectorAll("li > a.page-item"));if(t.length===0)throw new Error("cannot find thumbnails");const i=[],n=this.originImages.length.toString().length;for(const r of t){const o=this.originImages[this.index],a=r.href,l=r.firstElementChild.src,c=o.split(".").pop()??"jpg",d=l.slice(0,l.indexOf("tbn"))+o,p=(this.index+1).toString().padStart(n,"0");i.push(new k(l,a,`${p}.${c}`,void 0,d)),this.index++}return i}async fetchOriginMeta(e){return{url:e.originSrc}}}h.addSetup({name:"Akuma.moe",workURLs:[/akuma.moe\/g\/\w+\/?$/],match:["https://akuma.moe/*"],constructor:()=>new ti});const ii=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class ni extends R{async*fetchPagesSource(){yield I.ok(document)}async parseImgNodes(e){const n=Array.from(e.querySelectorAll(".article-content img:not(.arca-emoticon):not(.twemoji), .article-content video:not(.arca-emoticon)")),r=[],o=n.length.toString().length;return n.forEach((a,l)=>{if(a.tagName.toLowerCase()==="img"){const c=a;if(c.src&&c.style.width!=="0px"){const d=c.src,p=new URL(d),u=p.pathname.split(".").pop();p.searchParams.set("type","orig");const g=(l+1).toString().padStart(o,"0")+"."+u;r.push(new k(d,p.href,g,void 0,p.href))}}else if(a.tagName.toLowerCase()==="video"){const c=a;if(c.src){const d=c.src,p=new URL(d),u=p.pathname.split(".").pop();p.searchParams.set("type","orig");const g=(l+1).toString().padStart(o,"0")+"."+u,m=c.poster||"";r.push(new k(m,p.href,g,void 0,p.href))}}}),r}async fetchOriginMeta(e){return{url:e.href}}}h.addSetup({name:"Arcalive",workURLs:[/arca.live\/b\/\w*\/\d+/],match:["https://arca.live/*"],constructor:()=>new ni});const ri=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class oi extends R{pageData=new Map;info={username:"",projects:0,assets:0};tags={};galleryMeta(){const e=new P(window.location.href,`artstaion-${this.info.username}-w${this.info.projects}-p${this.info.assets}`);return e.tags=this.tags,e}async*fetchPagesSource(){const{id:e,username:t}=await this.fetchArtistInfo();this.info.username=t;let i=0;for(;;){i++;try{const n=await this.fetchProjects(t,e.toString(),i);if(!n||n.length===0)break;yield I.ok(n)}catch(n){i--,yield I.err(n)}}}async parseImgNodes(e){const t=e.map(r=>`https://www.artstation.com/projects/${r.hash_id}.json`),i=await Te(t,10,"json"),n=[];for(const r of i){if(r instanceof Error){A("error",r.message),f.emit("notify-message","error",r.message,8e3);continue}this.info.projects++,this.tags[r.slug]=r.tags;for(let o=0;o<r.assets.length;o++){const a=r.assets[o];if(a.asset_type==="cover")continue;const l=a.image_url.replace("/large/","/small/"),c=a.image_url.match(/\.(\w+)\?\d+$/)?.[1]??"jpg",d=`${r.slug}-${o+1}.${c}`;let p=a.image_url;if(a.has_embedded_player&&a.player_embedded){if(a.player_embedded.includes("youtube"))continue;p=a.player_embedded}this.info.assets++,n.push(new k(l,r.permalink,d,void 0,p,{w:a.width,h:a.height}))}}return n}async fetchOriginMeta(e){if(e.originSrc?.startsWith("<iframe")){const t=e.originSrc.match(/src=['"](.*?)['"]\s/)?.[1];if(!t)throw new Error("cannot match video clip url");const n=(await window.fetch(t).then(r=>r.text()).then(r=>new DOMParser().parseFromString(r,"text/html"))).querySelector("video > source");if(!n)throw new Error("cannot find video element");return{url:n.src}}return{url:e.originSrc}}async processData(e,t){return t.startsWith("binary")||t.startsWith("text")?[e,"video/mp4"]:[e,t]}async fetchArtistInfo(){const e=window.location.pathname.slice(1).split("/").shift();if(!e)throw new Error("cannot match artist's username");return await window.fetch(`https://www.artstation.com/users/${e}/quick.json`).then(i=>i.json())}async fetchProjects(e,t,i){const n=`https://www.artstation.com/users/${e}/projects.json?user_id=${t}&page=${i}`;return(await window.fetch(n).then(o=>o.json())).data}}h.addSetup({name:"Art Station",workURLs:[/artstation.com\/[-\w]+(\/albums\/\d+)?$/],match:["https://www.artstation.com/*"],constructor:()=>new oi});const ai=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class si extends R{async*fetchPagesSource(){const e=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");if(!e)throw new Error("cannot find csrf_token");const t=document.querySelector("#load_id")?.value;if(!t)throw new Error("cannot find load_id");const i=document.querySelector("#load_dir")?.value;if(!i)throw new Error("cannot find load_dir");const n=document.querySelector("#t_pages")?.value;if(!n)throw new Error("cannot find t_pages");const r=window.location.origin+"/inc/thumbs_loader.php",o=await window.fetch(r,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest"},body:`_token=${e}&id=${t}&dir=${i}&visible_pages=0&t_pages=${n}&type=2`,method:"POST"}).then(a=>a.text()).catch(Error);if(o instanceof Error)throw o;yield I.ok(o)}async parseImgNodes(e){const t=Array.from(e.matchAll(/<a href="(.*?)".*data-src="(.*?)"/g)).filter(n=>n.length===3).map(n=>[n[1],n[2]]),i=t.length.toString().length;return t.map((n,r)=>new k(n[1],window.location.origin+n[0],(r+1).toString().padStart(i,"0")))}async fetchOriginMeta(e){const t=e.href,i=await window.fetch(t).then(o=>o.text()).then(o=>new DOMParser().parseFromString(o,"text/html")).catch(Error);if(i instanceof Error)throw i;const n=i.querySelector("#fimg")?.getAttribute("data-src");if(!n)throw new Error("cannot find image from: "+t);const r=n.split(".").pop()??"jpg";return{url:n,title:e.title+"."+r}}meta;galleryMeta(){if(this.meta)return this.meta;const e=document.querySelector(".right > .info > h1")?.textContent??document.title,t=new P(window.location.href,e);return t.originTitle=document.querySelector(".right > .info > h2")?.textContent??void 0,Array.from(document.querySelectorAll(".right > .info > ul > .tags")).forEach(i=>{const n=i.querySelector("h3")?.textContent?.trim().replace(":","").toLowerCase();if(n){const r=Array.from(i.querySelectorAll(".tag_list > a > span")).map(o=>o.firstChild?.textContent??void 0).filter(Boolean);r.length>0&&(t.tags[n]=r)}}),this.meta=t,this.meta}}h.addSetup({name:"AsmHentai",workURLs:[/asmhentai.com\/g\/\d+\/?$/],match:["https://asmhentai.com/*"],constructor:()=>new si});const li=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));function K(s){return new Promise(e=>setTimeout(e,s))}class ci extends R{async*fetchPagesSource(){const e=window.location.href.match(/space.bilibili.com\/(\d+)\//)?.[1];if(!e)throw new Error("cannot find host_mid from "+window.location.href);const t=document.querySelector("script#__RENDER_DATA__")?.textContent?.match(/%3A%22([\w\.\-_]*)%22/)?.[1];if(!t)throw new Error("cannot find webid");let i="",n=1;for(;;){const r=Ce(),o=Date.now().toString(),a=await fetch(`https://api.bilibili.com/x/polymer/web-dynamic/v1/opus/feed/space?host_mid=${e}&page=${n}&offset=${i}&type=all&web_location=333.1387&w_webid=${t}&w_rid=${r}&wts=${o}`,{credentials:"include",headers:{"Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-site"},referrer:window.location.href,method:"GET",mode:"cors"}).then(l=>l.json());if(a.code!==0&&(yield I.err(new Error("fetch opus error: "+a.message))),a.data.items.length===0&&(yield I.err(new Error("fetch opus zero"))),a.data.has_more){i=a.data.offset,n=n+1;const l=[...a.data.items];for(;l.length>0;)yield I.ok(l.splice(0,2)),await K(1e3)}else return}}async parseImgNodes(e){const t=[];for(const n of e){const r=await Le(`https://www.bilibili.com/opus/${n.opus_id}?spm_id_from=333.1387.0.0`,"text",{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","Accept-Language":"en-US,en;q=0.7,zh-CN;q=0.3","Upgrade-Insecure-Requests":"1","Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"same-site","Sec-Fetch-User":"?1",Priority:"u=0, i",Origin:"https://space.bilibili.com",Cookie:document.cookie,Referrer:window.location.href});if(r.match("<title>\u9A8C\u8BC1\u7801_\u54D4\u54E9\u54D4\u54E9</title>"))throw new Error("\u89E6\u53D1\u98CE\u63A7\uFF0C\u8BF7\u6253\u5F00\u6B64\u94FE\u63A5\u5904\u7406\u9A8C\u8BC1\u7801\uFF1Ahttps:"+n.jump_url);t.push(r)}const i=t.map(n=>{const r=n.match(/window.__INITIAL_STATE__=(\{.*\});/)?.[1];if(!r)throw new Error("fetch opus error: cannot find windows.__INITIAL_STATE__");const o=JSON.parse(r)?.detail;if(!o)throw new Error("fetch opus error: cannot find detail from windows.__INITIAL_STATE__");return o});if(e.length!==i.length)throw new Error(`fetch opus detail error, opus count: ${e.length}, detail count: ${i.length}`);return e.map((n,r)=>{const a=i[r].modules.filter(c=>c.module_type==="MODULE_TYPE_CONTENT"||c.module_type==="MODULE_TYPE_TOP").map(c=>c.module_top?.display.album.pics??c.module_content?.paragraphs.filter(d=>d.pic).map(d=>d.pic?.pics??[]).flat()??[]).flat();if(!a)throw new Error("cannot find opus content: "+n.jump_url);const l=a.length.toString().length;return a.map((c,d)=>{const p=n.opus_id+"-"+(d+1).toString().padStart(l,"0");return new k(d===0?n.cover.url:"",n.jump_url,p,void 0,c.url,{w:c.width,h:c.height})})}).flat()}async fetchOriginMeta(e){const t=e.originSrc?.split(".").pop()??"jpg";return{url:e.originSrc,title:e.title+"."+t}}}h.addSetup({name:"Bilibili",workURLs:[/space.bilibili.com\/\d+\/upload\/opus$/],match:["https://www.bilibili.com/*"],constructor:()=>new ci});const di=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),hi=/var C_DATA='(.*?)'/;function me(s,e){const t=CryptoJS;if(!t)throw new Error("cryptoJS undefined");var i=t.enc.Utf8.parse(s),n=t.AES.decrypt(e,i,{mode:t.mode.ECB,padding:t.pad.Pkcs7});return t.enc.Utf8.stringify(n).toString()}function Re(s){const e=Uint8Array.from(atob(s),i=>i.charCodeAt(0));return new TextDecoder().decode(e)}function pi(){return new Promise((s,e)=>{const t="https://www.colamanga.com/js/custom.js",i=document.createElement("script");i.addEventListener("load",async()=>{try{const n=await window.fetch(t).then(o=>o.text()),r=vi(n);s(r)}catch(n){e(n)}}),i.src=t,i.type="text/javascript",document.querySelector("head").append(i)})}function ui(){return new Promise((s,e)=>{const t="https://www.colamanga.com/js/manga.read.js",i=document.createElement("script");i.addEventListener("load",async()=>{try{const n=await window.fetch(t).then(d=>d.text());let r;const o=n.matchAll(/if\(_0x\w+==(0x\w+)\)return (_0x\w+)\((0x\w+)\);/gm),a={};let l=!0;for(const d of o){const p=d[1],u=d[2],g=d[3];if(!r){const b=Pe(n,u)?.[0]?.[0]??u;console.log("colamanga, the function name: ",b),r=new Function("p",`return ${b}(p)`)}const m=r(g);a[parseInt(p)]=m,l=!1}if(l)throw new Error("cannot init key map from "+t);const c=yi(n);s([a,c])}catch(n){e(n)}}),i.src=t,i.type="text/javascript",document.querySelector("head").append(i)})}class gi extends R{infoMap={};keymap;keys=["dDeIieDgQpwVQZsJ","54bilXmmMoYBqBcI","KcmiZ8owmiBoPRMf","4uOJvtnq5YYIKZWA","lVfo0i0o4g3V78Rt","i8XLTfT8Mvu1Fcv2"];getActualK;async fetchChapters(){this.keys=await pi(),[this.keymap,this.getActualK]=await ui();const e=document.querySelector("dt.fed-part-rows > a")?.getAttribute("data-original")||void 0;return Array.from(document.querySelectorAll(".all_data_list .fed-part-rows > li > a")).map((i,n)=>new O(n,i.title,i.href,e))}async*fetchPagesSource(e){yield I.ok(e.source)}async parseImgNodes(e,t){const n=(await window.fetch(e).then(p=>p.text())).match(hi)?.[1];if(!n)throw new Error("cannot find C_DATA from page: "+e);let r;for(const p of this.keys)try{r=me(p,Re(n));break}catch(u){A("error",u.toString())}if(!r)throw new Error("colamanga decrypt C_DATA failed");r=r.replace("};","},"),r=r.replaceAll("info=","info:"),r="{"+r+"}",r=r.replaceAll(/(\w+):/g,'"$1":');const o=JSON.parse(r),[a,l]=bi(o.mh_info.enc_code1,o.mh_info.enc_code2,o.mh_info.mhid,this.keys);if(a===void 0||l===void 0)throw new Error("colamanga decrypt mh_info failed");const c=[],d=window.location.origin+o.mh_info.webPath+o.mh_info.pageurl;this.infoMap[d]=o;for(let p=o.mh_info.startimg;p<=parseInt(a);p++){const[u,g]=wi(p,l,o);c.push(new k("",d,u,void 0,g))}return c}async fetchOriginMeta(e){return{url:e.originSrc}}async processData(e,t,i){const n=this.infoMap[i.href];if(!n)throw new Error("cannot found info from "+i.href);return n.image_info.imgKey?[this.decryptImageData(e,n.image_info.keyType,n.image_info.imgKey,this.keymap,this.keys),t]:[e,t]}headers(){return{Referer:window.location.href,Origin:window.location.origin}}decryptImageData(e,t,i,n,r){let o;if(t!==""&&t!=="0")o=n[parseInt(t)];else for(const m of r)try{o=me(m,i);break}catch(b){A("error",b.toString())}const l={ciphertext:mi(e)},c=CryptoJS,d=this.getActualK?.(o),p=c.enc.Utf8.parse(d),u=c.AES.decrypt(l,p,{iv:c.enc.Utf8.parse("0000000000000000"),mode:c.mode.CBC,padding:c.pad.Pkcs7});return fi(u)}}function mi(s){let e=[],t=0,i=s.length;for(;t<i;)e.push(s[t++]<<24|s[t++]<<16|s[t++]<<8|s[t++]);return{sigBytes:e.length*4,words:e}}function fi(s){const e=s.words.length,t=new Uint8Array(e<<2);let i=0,n;for(let r=0;r<e;r++)n=s.words[r],t[i++]=n>>24,t[i++]=n>>16&255,t[i++]=n>>8&255,t[i++]=n&255;return t}function bi(s,e,t,i){let n;for(const o of i)try{if(n=me(o,Re(s)),n==""||isNaN(parseInt(n)))throw new Error("colamanga failed decrypt image count");break}catch(a){A("error",a.toString())}let r;for(const o of i)try{if(r=me(o,Re(e)),r==""||!r.startsWith(t+"/"))throw new Error("colamanga failed decrypt image path");break}catch(a){A("error",a.toString())}return[n,r]}function wi(s,e,t){const i=(t.mh_info.startimg+s-1).toString().padStart(4,"0");let n=i+".jpg";t.image_info.imgKey!=null&&t.image_info.imgKey!=""&&(n=i+".enc.webp");const r=window.location.host.replace("www.",""),o="https://img"+t.mh_info.use_server+"."+r+"/comic/"+encodeURI(e)+n;return[n,o]}function vi(s){const e=/window(\[\w+\(0x[^)]+\)\]){2}\(((\w+)(\(0x[^)]+\))?),/gm,t=s.matchAll(e),i=[];for(const n of t){const r=n[3],o=n[4];if(r)for(const[a,l]of Pe(s,r,o)){if(a===null||l===null)continue;const c=new Function("return "+a+l)();i.includes(c)||i.push(c)}}return i}function yi(s){const e=/(eval\(function.*?\)\)\)),_0x/,t=s.match(e)?.[1];return new Function("ksddd",`
        var actualKey = ksddd;
        ${t};
        return actualKey;
      `)}function Pe(s,e,t){const i=new RegExp(e+"=((\\w+)(\\([^)]+\\))?)[,; ]","gm"),n=s.matchAll(i),r=[];let o=!0;for(const a of n){o=!1;const l=a[2],c=a[3];c&&(t=c),l&&r.push(...Pe(s,l,t))}return o&&s.includes("function "+e)&&r.push([e,t??null]),r}h.addSetup({name:"colamanga",workURLs:[/colamanga.com\/manga-\w*\/?$/],match:["https://www.colamanga.com/*"],constructor:()=>new gi});const _i=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class fe extends R{tags={};blacklistTags=[];count=0;async*fetchPagesSource(){let e=document;this.blacklistTags=this.getBlacklist(e),yield I.ok(e);let t=0;for(;;){const i=this.nextPage(e);if(!i)break;try{e=await window.fetch(i).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html"))}catch(n){t++,t>3&&(yield I.err(new Error(`fetch next page failed, ${n}`)));continue}t=0,yield I.ok(e)}}async fetchOriginMeta(e){const t=this.cachedOriginMeta(e.href);if(t)return t;let i=null;const n=await window.fetch(e.href).then(l=>l.text()).then(l=>new DOMParser().parseFromString(l,"text/html"));if(h.conf.fetchOriginal&&(i=this.getOriginalURL(n)),i||(i=this.getNormalURL(n)),!i)throw new Error("Cannot find origin image or video url");let r;const o=i.split(".").pop()?.match(/^\w+/)?.[0],a=this.extractIDFromHref(e.href);return o&&a&&(r=`${a}.${o}`),{url:i,title:r}}cachedOriginMeta(e){return null}async parseImgNodes(e){const t=[];return this.queryList(e).forEach(i=>{const[n,r]=this.toImgNode(i);if(n){if(this.count++,r!==""){const o=r.trim().replaceAll(": ",":").split(" ").map(a=>a.trim()).filter(a=>a!=="");if(this.blacklistTags.findIndex(a=>o.includes(a))>=0)return;this.tags[n.title.split(".")[0]]=o}t.push(n)}}),t}galleryMeta(){const t=new URL(window.location.href).searchParams.get("tags")?.trim(),i=new P(window.location.href,`${this.site().toLowerCase().replace(" ","-")}_${t}_${this.count}`);return i.tags=this.tags,i}}class Ci extends fe{site(){return"danbooru"}nextPage(e){return e.querySelector(".paginator a.paginator-next")?.href||null}queryList(e){return Array.from(e.querySelectorAll(".posts-container > article"))}getBlacklist(e){return e.querySelector("meta[name='blacklisted-tags']")?.getAttribute("content")?.split(",")||[]}toImgNode(e){const t=e.querySelector("a");if(!t)return A("error","warn: cannot find anchor element",t),[null,""];const i=t.querySelector("img");if(!i)return A("error","warn: cannot find img element",i),[null,""];const n=t.getAttribute("href");return n?[new k(i.src,n,`${e.getAttribute("data-id")||e.id}.jpg`),e.getAttribute("data-tags")||""]:(A("error","warn: cannot find href",t),[null,""])}getOriginalURL(e){return e.querySelector("#image-resize-notice > a")?.href||null}getNormalURL(e){return e.querySelector("#image")?.getAttribute("src")||null}extractIDFromHref(e){return e.match(/posts\/(\d+)/)?.[1]}}class xi extends fe{site(){return"rule34"}nextPage(e){if(window.location.search.includes("page=favorites")){const t=e.querySelector("#paginator a[name=next]")?.getAttribute("onclick")?.match(/location='(.*)?'/)?.[1]||null;return t&&window.location.origin+"/"+t}else return e.querySelector(".pagination a[alt=next]")?.href||null}queryList(e){return window.location.search.includes("page=favorites")?Array.from(e.querySelectorAll("#content .thumb a")):Array.from(e.querySelectorAll(".image-list > .thumb:not(.blacklisted-image) > a"))}getBlacklist(e){return e.querySelector("meta[name='blacklisted-tags']")?.getAttribute("content")?.split(",")||[]}toImgNode(e){const t=e.querySelector("img");if(!t)return A("error","warn: cannot find img element",t),[null,""];const i=e.getAttribute("href");return i?[new k(t.src,i,`${e.id}.jpg`),t.getAttribute("alt")||""]:(A("error","warn: cannot find href",e),[null,""])}getOriginalURL(e){const t=e.querySelector("#note-container + script")?.textContent?.trim().replace("image = ","").replace(";","").replaceAll("'",'"');try{if(t){const i=JSON.parse(t);return`${i.domain}/${i.base_dir}/${i.dir}/${i.img}`}}catch(i){A("error","get original url failed",i)}return null}getNormalURL(e){const t=e.querySelector("#image,#gelcomVideoPlayer > source");return t?.getAttribute("src")||t?.getAttribute("data-cfsrc")||null}extractIDFromHref(e){return e.match(/id=(\d+)/)?.[1]}}class Ii extends fe{site(){return"gelbooru"}nextPage(e){const t=e.querySelector("#paginator a[alt=next]")?.href;return t||e.querySelector("#paginator b + a")?.href||null}queryList(e){return Array.from(e.querySelectorAll(".thumbnail-container > article.thumbnail-preview:not(.blacklisted-image) > a"))}getBlacklist(e){return e.querySelector("meta[name='blacklisted-tags']")?.getAttribute("content")?.split(",")||[]}toImgNode(e){const t=e.querySelector("img");if(!t)return A("error","warn: cannot find img element",t),[null,""];const i=e.getAttribute("href");if(!i)return A("error","warn: cannot find href",e),[null,""];const n=new k(t.src,i,`${e.id}.jpg`),r=t.title.split(" ").map(o=>o.trim()).filter(o=>o&&!(o.startsWith("score")||o.startsWith("rating"))).map(o=>"tag:"+o);return n.setTags(...r),[n,t.getAttribute("alt")||""]}getOriginalURL(e){return e.querySelector("head > meta[property='og:image']")?.getAttribute("content")||null}getNormalURL(e){const t=e.querySelector("#image");if(t?.src)return t.src;const i=Array.from(e.querySelectorAll("#gelcomVideoPlayer > source"));return i.length===0?null:i.find(n=>n.type.endsWith("mp4"))?.src||i[0].src}extractIDFromHref(e){return e.match(/id=(\d+)/)?.[1]}}class Ai extends fe{cache=new Map;nextPage(e){return e.querySelector(".pagination #paginator-next")?.href??null}getOriginalURL(){throw new Error("Method not implemented.")}getNormalURL(){throw new Error("Method not implemented.")}extractIDFromHref(){throw new Error("Method not implemented.")}getBlacklist(e){const t=e.querySelector("meta[name='blacklisted-tags']")?.getAttribute("content");return t?t.slice(1,-1).split(",").map(i=>i.slice(1,-1)):[]}queryList(e){return Xe.imgSrcCSP=!0,Array.from(e.querySelectorAll(".posts-container > article"))}toImgNode(e){const t=e.getAttribute("data-preview-url");if(!t)return[null,""];const i=e.getAttribute("data-tags"),n=e.getAttribute("data-id"),r=e.getAttribute("data-sample-url"),o=e.getAttribute("data-file-url"),a=e.getAttribute("data-file-ext")||void 0;if(!r||!o||!n)return[null,""];const l=`${window.location.origin}/posts/${n}`,c=e.getAttribute("data-width"),d=e.getAttribute("data-height");let p;return c&&d&&(p={w:parseInt(c),h:parseInt(d)}),this.cache.set(l,{normal:r,original:o,id:n,fileExt:a}),[new k(t,l,`${n}.jpg`,void 0,void 0,p),i||""]}cachedOriginMeta(e){const t=this.cache.get(e);if(!t)throw new Error("miss origin meta: "+e);const i=t.fileExt??t.original.split(".").pop()??"jpg";return h.conf.fetchOriginal||["webm","webp","mp4"].includes(i)?{url:t.original,title:`${t.id}.${i}`}:{url:t.normal,title:`${t.id}.${t.normal.split(".").pop()}`}}site(){return"e621"}}h.addSetup({name:"e621",workURLs:[/e621.net\/((posts|favorites)(?!\/)|$)/],match:["https://e621.net/*"],constructor:()=>new Ai}),h.addSetup({name:"rule34",workURLs:[/rule34.xxx\/index.php\?page=(post&s=list|favorites&s=view)/],match:["https://rule34.xxx/*"],constructor:()=>new xi}),h.addSetup({name:"gelbooru",workURLs:[/gelbooru.com\/index.php\?page=post&s=list/],match:["https://gelbooru.com/*"],constructor:()=>new Ii}),h.addSetup({name:"danbooru",workURLs:[/danbooru.donmai.us\/(posts(?!\/)|$)/],match:["https://danbooru.donmai.us/*"],constructor:()=>new Ci});const Si=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));function Je(s){return"https://i.eahentai.com/file/ea-gallery/"+encodeURI(s).replace(/,/g,"%2C").replace(/&/g,"%26").replace(/\+/g,"%2B").replace(/%20/g,"+")}class ki extends R{meta;async*fetchPagesSource(){const e=window.location.href.match(/eahentai.com\/a\/(\d+)/)?.[1];if(!e)throw new Error("cannot get gallery id from url: "+window.location.href);const t=`${window.location.origin}/api/image/album/${e}`,i=await window.fetch(t,{referrer:window.location.href}).then(o=>o.json());if(!i||i.length===0)throw new Error("cannot fetch album data from: "+t);const n=i[0],r=new P(window.location.href,n.title);r.tags.tags=n.tags.split("|"),r.tags.author=[n.author],r.tags.albumType=n.albumType.split("|"),r.tags.characters=n.characters?.split("|")??[],this.meta=r,yield I.ok(i[0])}async parseImgNodes(e){return e.images.map((t,i)=>{const n=Je(t.thumbnailUri),r=`${window.location.origin}/a/${e.albumID}/${i}`,o=t.imageUri.split(".").pop()??"jpg",a=Je(t.imageUri);return new k(n,r,t.title+"."+o,void 0,a)})}async fetchOriginMeta(e){return{url:e.originSrc}}galleryMeta(e){return this.meta??super.galleryMeta(e)}}h.addSetup({name:"eahentai",workURLs:[/eahentai.com\/a\/\d+\/?$/],match:["https://eahentai.com/*"],constructor:()=>new ki});const Ei=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));function Li(s){return s.map(e=>{const[t,i]=e.backgroundPosition.split(" ").map(n=>Math.abs(parseInt(n)));if(isNaN(t))throw new Error("invalid background position");return{x:t,y:i,width:parseInt(e.width),height:parseInt(e.height)}})}function Ti(s,e){const t=document.createElement("canvas"),i=t.getContext("2d"),n=[];for(const r of e)t.width=r.width,t.height=r.height,i.drawImage(s,r.x,r.y,r.width,r.height,0,0,r.width,r.height),n.push(t.toDataURL());return t.remove(),n}async function Qe(s,e){let t;for(let n=0;n<3;n++)try{t=await Le(s,"blob");break}catch(r){A("error","fetch thumbnail failed, ",r)}if(!t)throw new Error("load sprite image error");s=URL.createObjectURL(t);const i=await new Promise((n,r)=>{const o=new Image;o.onload=()=>n(o),o.onerror=()=>r(new Error("load sprite image error")),o.src=s});return URL.revokeObjectURL(s),Ti(i,e)}const j={normal:/\<img\sid=\"img\"\ssrc=\"(.*?)\"\sstyle/,original:/\<a\shref=\"(http[s]?:\/\/e[x-]?hentai(55ld2wyap5juskbm67czulomrouspdacjamjeloj7ugjbsad)?\.(org|onion)\/fullimg?[^"\\]*)\"\>/,nlValue:/\<a\shref=\"\#\"\sid=\"loadfail\"\sonclick=\"return\snl\(\'(.*)\'\)\"\>/,isMPV:/https?:\/\/e[-x]hentai(55ld2wyap5juskbm67czulomrouspdacjamjeloj7ugjbsad)?\.(org|onion)\/mpv\/\w+\/\w+\/#page\w/,mpvImageList:/imagelist\s=\s(\[.*?\])/,sprite:/url\((.*?)\)/,workURL:/e[-x]hentai(.*)?.(org|onion)\/g\/\w+/};class Ri extends R{docMap={};title(e){const t=e[0].meta||this.galleryMeta(e[0]);let i="";return h.conf.ehentaiTitlePrefer==="japanese"?i=t.originTitle||t.title||"UNTITLE":i=t.title||t.originTitle||"UNTITLE",e.length>1&&(i+="+"+e.length+"chapters"),i}galleryMeta(e){if(e.meta)return e.meta;const t=this.docMap[e.id],i=t.querySelectorAll("#gd2 h1");let n,r;i&&i.length>0&&(n=i[0].textContent||void 0,i.length>1&&(r=i[1].textContent||void 0)),e.meta=new P(window.location.href,n||"UNTITLE"),e.meta.originTitle=r;const o=t.querySelectorAll("#taglist tr"),a={},l=t.querySelector("#gdc > div")?.textContent;l&&(a.category=[l]);const c=t.querySelector("#gdn > a")?.textContent;return c&&(a.uploader=[c]),Array.from(t.querySelectorAll("#gdd > table:not([hidden]) tr")).forEach(d=>{const p=d.querySelector(".gdt1")?.textContent?.replace(":","")?.toLowerCase();let u=d.querySelector(".gdt2")?.textContent;if(p&&u){if((p==="parent"||p==="\u7236\u7EA7")&&(u=d.querySelector(".gdt2 a")?.href??u),p==="language"||p==="\u8BED\u8A00")return;a[p]=[u]}}),o.forEach(d=>{const p=d.childNodes,u=p[0].textContent;if(u&&p[1]){const g=[];p[1].childNodes.forEach(m=>{m.textContent&&g.push(m.textContent)}),a[u.replace(":","")]=g}}),e.meta.tags=a,e.meta}async fetchChapters(){const e=new O(0,"Default",window.location.href);return this.docMap[0]=document,this.galleryMeta(e),e.title=e.meta.title,[e]}async appendNewChapters(e,t){if(!j.workURL.test(e))throw new Error("invaild gallery url");const i=await window.fetch(e).then(o=>o.text()).then(o=>new DOMParser().parseFromString(o,"text/html"));let n=t[t.length-1]?.id||0;n=n+1;const r=new O(n,"NewChapter-"+n,e);return this.docMap[n]=i,this.galleryMeta(r),r.title=r.meta.title,[r]}async parseImgNodes(e){const t=[],i=await window.fetch(e).then(d=>d.text()).then(d=>new DOMParser().parseFromString(d,"text/html"));if(!i)throw new Error("warn: eh matcher failed to get document from source page!");let n=!1,r=d=>{const p=d.firstElementChild,u=p.firstElementChild,g=u.getAttribute("title")?.replace(/Page\s\d+[:_]\s*/,"")||"untitle.jpg";return{thumbnailImage:u.src,title:g,href:p.getAttribute("href"),wh:Pi(u.src)||{w:100,h:100},style:d.style,backgroundImage:null,delaySrc:void 0}},o=i.querySelectorAll("#gdt .gdtl");if((!o||o.length==0)&&(o=i.querySelectorAll("#gdt .gdtm > div"),n=o?.length>0,r=d=>{const p=d.firstElementChild,g=p.firstElementChild.getAttribute("title")?.replace(/Page\s\d+[:_]\s*/,"")||"untitle.jpg";return{backgroundImage:d.style.background.match(j.sprite)?.[1]?.replaceAll('"',"")||null,title:g,href:p.getAttribute("href"),wh:Me(d.style)??{w:100,h:100},style:d.style,thumbnailImage:"",delaySrc:void 0}}),(!o||o.length==0)&&(o=i.querySelectorAll("#gdt > a"),n=o?.length>0,r=d=>{const p=d;let u=p.firstElementChild;(!u.style.background||u.childElementCount>0)&&(u=u.firstElementChild);const g=u.getAttribute("title")?.replace(/Page\s\d+[:_]\s*/,"")||"untitle.jpg";return{backgroundImage:u.style.background.match(j.sprite)?.[1]?.replaceAll('"',"")||null,title:g,href:p.getAttribute("href"),wh:Me(u.style)??{w:100,h:100},style:u.style,thumbnailImage:"",delaySrc:void 0}}),!o||o.length==0)throw new Error("warn: failed query image nodes!");const a=[],l=Array.from(o),c=r(l[0]);if(j.isMPV.test(c.href)){n=!0;const d=await window.fetch(c.href).then(m=>m.text()).then(m=>new DOMParser().parseFromString(m,"text/html")),p=JSON.parse(d.querySelector("#pane_outer + script")?.innerHTML.match(j.mpvImageList)?.[1]??"[]"),u=Array.from(d.querySelectorAll("#pane_thumbs > a > div")),g=location.pathname.split("/")[2];for(let m=0;m<p.length;m++){const b=p[m],y=b.t.match(/\((http.*)\)/)?.[1]||null;u[m].style.background="url"+b.t;const w={backgroundImage:y,title:b.n,href:`${location.origin}/s/${b.k}/${g}-${m+1}`,wh:Me(u[m].style)??{w:100,h:100},style:u[m].style,thumbnailImage:"",delaySrc:void 0};a.push(w)}}else l.forEach(d=>a.push(r(d)));if(n){const d=[];for(let p=0;p<a.length;p++){const u=a[p];if(!u.backgroundImage){A("error","e-hentai miss node, ",u);continue}d.length===0||d[d.length-1].url!==u.backgroundImage?d.push({url:u.backgroundImage,range:[{index:p,style:u.style}]}):d[d.length-1].range.push({index:p,style:u.style})}d.forEach(({url:p,range:u})=>{if(p=p.startsWith("http")?p:window.location.origin+p,u.length===1)a[u[0].index].thumbnailImage=p;else{const g=[];for(let m=0;m<u.length;m++)a[u[m].index].delaySrc=new Promise((b,y)=>g.push({resolve:b,reject:y}));Qe(p,Li(u.map(m=>m.style))).then(m=>{for(let b=0;b<m.length;b++)g[b].resolve(m[b])}).catch(m=>g.forEach(b=>b.reject(m)))}})}for(let d=0;d<a.length;d++){const p=a[d];t.push(new k(p.thumbnailImage,p.href,p.title,p.delaySrc,void 0,p.wh))}return t}async*fetchPagesSource(e){const t=this.docMap[e.id],i=t.querySelector("#gdt a")?.getAttribute("href");if(i&&j.isMPV.test(i)){yield I.ok(window.location.href);return}const n=Array.from(t.querySelectorAll(".gtb td a")).filter(a=>a.href).map(a=>a.href);if(n.length===0)throw new Error("cannot found next page elements");let r=0,o;for(const a of n){const l=new URL(a),c=parseInt(l.searchParams.get("p")||"0");c>=r&&(r=c,o=l)}if(!o)throw new Error("cannot found next page elements again");o.searchParams.delete("p"),yield I.ok(o.href);for(let a=1;a<r+1;a++)o.searchParams.set("p",a.toString()),yield I.ok(o.href)}async fetchOriginMeta(e,t){const i=await window.fetch(e.href).then(r=>r.text()).catch(r=>new Error(r));if(i instanceof Error||!i)throw new Error(`fetch source page error, ${i.toString()}`);let n;if(h.conf.fetchOriginal){n=j.original.exec(i)?.[1].replace(/&amp;/g,"&");const r=e.href.includes("?")?e.href.split("?").pop():void 0;n&&r&&(n+="?"+r)}if(n||(n=j.normal.exec(i)?.[1]),t){const r=j.nlValue.exec(i)?.[1];r?(e.href=e.href+(e.href.includes("?")?"&":"?")+"nl="+r,A("info",`IMG-FETCHER retry url:${e.href}`),n=(await this.fetchOriginMeta(e,!1)).url):A("error",`Cannot matching the nlValue, content: ${i}`)}if(!n)throw A("error",`cannot matching the image url from content:
`,i),new Error("cannot matching the image url from content. (the content is showing up in console(F12 open it)");if(n.startsWith("http")||(n=window.location.origin+n),n.endsWith("509.gif"))throw new Error("509, Image limits Exceeded, Please reset your Quota!");return{url:n,href:e.href}}async processData(e,t){if(t.startsWith("text")&&e.byteLength===1329)throw new Error('fetching the raw image requires being logged in, please try logging in or disable "raw image"');return[e,t]}}function Pi(s){if(!s)return;const e=s.match(/\/\w+-\d+-(\d+)-(\d+)-/);if(e&&e.length===3)return{w:parseInt(e[1]),h:parseInt(e[2])}}function Me(s){const e={w:parseInt(s.width),h:parseInt(s.height)};if(!(isNaN(e.w)||isNaN(e.h)))return e}h.addSetup({name:"e-hentai",workURLs:[j.workURL],constructor:()=>new Ri});const Mi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class Ni extends R{meta;galleryMeta(){return this.meta}parseMeta(){const e=document.querySelector(".comics-panel-margin h3.title")?.textContent?.replaceAll(/\s/g,""),t=document.querySelector(".comics-panel-margin h4.title")?.textContent?.replaceAll(/\s/g,""),i=new P(window.location.href,e??document.title);i.originTitle=t??void 0,Array.from(document.querySelectorAll(".comics-panel-margin .comics-metadata-margin-top h5")).forEach(n=>{let r=n.firstChild?.textContent??"misc";r=r.trim().replace(/：:/,"");const o=Array.from(n.querySelectorAll("a")).map(a=>a.textContent?.trim()).filter(Boolean);i.tags[r]=o}),this.meta=i}async*fetchPagesSource(){this.parseMeta(),yield I.ok(document)}async parseImgNodes(e){const t=Array.from(e.querySelectorAll(".comics-panel-margin > a")),i=t[0],n={j:"jpg",p:"png",g:"gif",w:"webp"};let r="",o;if(i){const l=await window.fetch(i.href).then(p=>p.text()).then(p=>new DOMParser().parseFromString(p,"text/html")),c=l.querySelector("#comic-content-wrapper img");r=c?.getAttribute("prefix")??c?.getAttribute("data-prefix")??"";const d=l.querySelector("#comic-content-wrapper script")?.textContent?.match(/extensions.innerHTML = '(.*)?'/)?.[1]?.replaceAll("&quot;",'"');o=d?JSON.parse(d):void 0}const a=t.length.toString().length;return t.map((l,c)=>{const d=l.href,p=l.querySelector("img")?.getAttribute("data-srcset")||"";let u="jpg",g=r&&o?`${r}${o[c]}.${u}`:void 0;if(r&&o&&r.includes("nhentai")){const m=o?.[c]??"j";u=n[m]??"jpg",g=`${r}${c+1}.${u}`}return new k(p,d,(c+1).toString().padStart(a,"0")+"."+u,void 0,g)})}async fetchOriginMeta(e,t){if(!t&&e.originSrc)return{url:e.originSrc};const n=(await window.fetch(e.href).then(r=>r.text()).then(r=>new DOMParser().parseFromString(r,"text/html"))).querySelector("#comic-content-wrapper img");if(!n)throw new Error("cannot find img from "+e.href);return{url:n.src}}headers(){return{Origin:"",Referer:""}}}h.addSetup({name:"hanime1.me",workURLs:[/hanime1.me\/comic\/\d+\/?$/],match:["https://hanime1.me/comic/*"],constructor:()=>new Ni});const $i=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Oi=/initReader\("(.*?)\",\s?"(.*?)",\s?(.*?)\)/,Di=/read\/\d+\/(\d+)$/;class Ui extends R{meta;baseURL;readerData;async*fetchPagesSource(){this.meta=this.pasrseGalleryMeta(document),yield I.ok(document)}async parseImgNodes(e){const t=[];return Array.from(e.querySelectorAll(".section .container + .container > .box > .columns > .column a")).forEach((n,r)=>{const o=n.querySelector("img");if(!o)return;const a=n.href.split("/").pop()||r.toString(),l=o.src.split(".").pop(),c=a+"."+l;t.push(new k(o.src,n.href,c))}),t}async fetchOriginMeta(e){if(!this.readerData){const o=(await window.fetch(e.href).then(a=>a.text()).then(a=>new DOMParser().parseFromString(a,"text/html"))).querySelector("body > script")?.textContent?.match(Oi)?.slice(1);if(!o||o.length!==3)throw new Error("cannot find reader data");try{this.initReader(o[0],o[1])}catch{throw new Error("hentainexus updated decryption function")}}if(!this.readerData)throw new Error("cannot find reader data");const t=e.href.match(Di)?.[1]||"001",i=this.readerData.find(r=>r.url_label===t)?.image;if(!i)throw new Error("cannot find image url");const n=i.split(".").pop();return{url:i,title:t+"."+n}}galleryMeta(e){return this.meta||super.galleryMeta(e)}pasrseGalleryMeta(e){const t=e.querySelector("h1.title")?.textContent||"UNTITLED",i=new P(this.baseURL||window.location.href,t);return e.querySelectorAll(".view-page-details tr").forEach(n=>{const r=n.querySelector(".viewcolumn")?.textContent?.trim();if(!r)return;let o=Array.from(n.querySelector(".viewcolumn + td")?.childNodes||[]).map(a=>a?.textContent?.trim()).filter(Boolean);o.length!==0&&(r==="Tags"&&(o=o.map(a=>a.replace(/\s?\([0-9,]*\)$/,""))),i.tags[r]=o)}),i}initReader(e,t){this.meta&&(this.meta.originTitle=t.replace(/::\s?HentaiNexus/,""));const i=window.location.hostname.split(""),n=Math.min(i.length,64),r=window.atob(e).split("");for(let g=0;g<n;g++)r[g]=String.fromCharCode(r[g].charCodeAt(0)^i[g].charCodeAt(0));const o=r.join(""),a=[],l=[];for(let g=2;l.length<16;++g)if(!a[g]){l.push(g);for(let m=g<<1;m<=256;m+=g)a[m]=!0}let c=0;for(let g=0;g<64;g++){c=c^o.charCodeAt(g);for(let m=0;m<8;m++)c=c&1?c>>>1^12:c>>>1}c=c&7;const d=new Uint8Array(256);for(let g=0;g<256;g++)d[g]=g;let p="",u=0;for(let g=0,m=0;g<256;g++)m=(m+d[g]+o.charCodeAt(g%64))%256,u=d[g],d[g]=d[m],d[m]=u;for(let g=l[c],m=0,b=0,y=0,w=0,C=0;C+64<o.length;C++)y=(y+g)%256,w=(b+d[(w+d[y])%256])%256,b=(b+y+d[y])%256,u=d[y],d[y]=d[w],d[w]=u,m=d[(w+d[(y+d[(m+b)%256])%256])%256],p+=String.fromCharCode(o.charCodeAt(C+64)^m);this.readerData=JSON.parse(p)}}h.addSetup({name:"hentainexus",workURLs:[/hentainexus.com\/view\/\d+/],match:["https://hentainexus.com/*"],constructor:()=>new Ui});const qi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Bi={j:"jpg",p:"png",b:"bmp",g:"gif",w:"webp"};class zi extends R{meta;galleryMeta(){if(this.meta)return this.meta;const e=document.querySelector(".gp_top_right > h1")?.textContent??document.title;return this.meta=new P(window.location.href,e),Array.from(document.querySelectorAll(".gp_top_right_info > ul")).forEach(t=>{const i=t.querySelector("span.info_txt")?.textContent?.replace(":","")?.toLowerCase();if(!i)return;const n=Array.from(t.querySelectorAll("a.gp_btn_tag")).map(r=>r.firstChild?.textContent).filter(Boolean);this.meta.tags[i]=n}),this.meta}async*fetchPagesSource(){const e=Array.from(document.querySelectorAll("script")).find(c=>c.textContent?.trimStart()?.startsWith("var g_th"))?.textContent?.match(/\('(\{.*\})'\)/)?.[1];if(!e)throw new Error("cannot find g_th");const t=document.querySelector("input#load_server")?.value;if(!t)throw new Error("cannot find server id");const i=document.querySelector("input#load_dir")?.value;if(!i)throw new Error("cannot find load dir");const n=document.querySelector("input#gallery_id")?.value;if(!n)throw new Error("cannot find gallery id");const r=document.querySelector("input#load_id")?.value;if(!r)throw new Error("cannot find load id");const o=document.querySelector("input#load_pages")?.value;if(!o)throw new Error("cannot find load pages");const a=JSON.parse(e),l={serverID:t,galleryID:n,loadDir:i,loadID:r,loadPages:parseInt(o),images:a};yield I.ok(l)}async parseImgNodes(e){const t=`m${e.serverID}.hentaizap.com`,i=[],n=e.loadPages.toString().length;for(let r=0;r<e.loadPages;r++){const[o,a,l]=e.images[(r+1).toString()]?.split(",")??[];if(!o||!a||!l)throw new Error("cannot find image g_th: "+(r+1));const c=Bi[o]??"webp",d=`https://${t}/${e.loadDir}/${e.loadID}/${r+1}t.jpg`,p=`${window.location.origin}/g/${e.galleryID}/${r+1}/`,u=`https://${t}/${e.loadDir}/${e.loadID}/${r+1}.${c}`,g=(r+1).toString().padStart(n,"0"),m=new k(d,p,`${g}.${c}`,void 0,u,{w:parseInt(a),h:parseInt(l)});i.push(m)}return i}async fetchOriginMeta(e){return{url:e.originSrc}}}h.addSetup({name:"HentaiZap",workURLs:[/hentaizap.com\/gallery\/\w+\/?/],match:["https://hentaizap.com/*"],constructor:()=>new zi});const Gi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),ne="gold-usergeneratedcontent.net";class Vi{base=void 0;b;m;constructor(e,t){this.b=e,this.m=new Function("g",t)}real_full_path_from_hash(e){return e.replace(/^.*(..)(.)$/,"$2/$1/"+e)}s(e){const t=/(..)(.)$/.exec(e);return parseInt(t[2]+t[1],16).toString(10)}subdomain_from_url(e,t,i){let n="";t||(i==="webp"?n="w":i==="avif"&&(n="a"));let r=16,a=/\/[0-9a-f]{61}([0-9a-f]{2})([0-9a-f])/.exec(e);if(!a)return n;let l=parseInt(a[2]+a[1],r);return isNaN(l)||(t?n=String.fromCharCode(97+this.m(l))+t:n=n+(1+this.m(l))),n}thumbURL(e){e=e.replace(/^.*(..)(.)$/,"$2/$1/"+e);const t="https://a."+ne+"/webpsmalltn/"+e+".webp";return t.replace(/\/\/..?\.(?:gold-usergeneratedcontent\.net|hitomi\.la)\//,"//"+this.subdomain_from_url(t,"tn","webp")+"."+ne+"/")}originURL(e,t){let i=t;i==="webp"||i==="avif"?i="":i+="/";let n="https://a."+ne+"/"+i+this.b+this.s(e)+"/"+e+"."+t;return n=n.replace(/\/\/..?\.(?:gold-usergeneratedcontent\.net|hitomi\.la)\//,"//"+this.subdomain_from_url(n,this.base,t)+"."+ne+"/"),n}}const ji=/m:\sfunction\(g\)\s{(.*?return.*?;)/s,Fi=/b:\s'(\d*\/)'/;class Hi extends R{gg;meta={};infoRecord={};formats=["avif","jxl","webp"];formatIndex=0;async fetchChapters(){if(this.formatIndex=h.conf.hitomiFormat==="auto"?0:this.formats.indexOf(h.conf.hitomiFormat),this.formatIndex===-1)throw new Error("invalid hitomi format: "+h.conf.hitomiFormat);const e=await window.fetch(`https://ltn.${ne}/gg.js?_=${Date.now()}`).then(i=>i.text());this.gg=new Vi(Fi.exec(e)[1],ji.exec(e)[1]);const t=[];return t.push(new O(0,document.querySelector("#gallery-brand")?.textContent||"default",window.location.href,document.querySelector(".content > .cover-column > .cover img")?.src)),t}async*fetchPagesSource(e){const i=e.source.match(/([0-9]+)(?:\.html)/)?.[1];if(!i)throw new Error("cannot query hitomi gallery id");const n=await window.fetch(`https://ltn.${ne}/galleries/${i}.js`).then(o=>o.text()).then(o=>o.replace("var galleryinfo = ",""));if(!n)throw new Error("cannot query hitomi gallery info");const r=JSON.parse(n);this.setGalleryMeta(r,i,e),yield I.ok(r)}async parseImgNodes(e){const t=e.files,i=[];for(let n=0;n<t.length;n++){const r=t[n];let o=this.formats.slice(this.formatIndex).find(p=>r["has"+p]===1);o||(o="webp",A("error","no format found: ",t[n]));const a=r.name.replace(/\.\w+$/,""),l=this.gg.originURL(r.hash,o),{width:c,height:d}=r;i.push(new k(this.gg.thumbURL(t[n].hash),l,a+"."+o,void 0,l,c&&d?{w:c,h:d}:void 0))}return i}async fetchOriginMeta(e){return{url:e.originSrc}}setGalleryMeta(e,t,i){this.infoRecord[i.id]=e,this.meta[i.id]=new P(i.source,e.title||"hitomi-"+t),this.meta[i.id].originTitle=e.japanese_title||void 0;const n=["scene_indexes","files"];for(const r in e)n.indexOf(r)>-1||(this.meta[i.id].tags[r]=e[r])}galleryMeta(e){return this.meta[e.id]}title(){const e=Object.entries(this.infoRecord);return e.length===0?"hitomi-unknown":e.length===1?e[0][1].japanese_title||e[0][1].title||"hitomi-unknown":"hitomi-multiple"+e.map(t=>t[1].id).join("_")}}h.addSetup({name:"hitomi",workURLs:[/hitomi.la\/(?!reader)\w+\/.*\d+\.html/],match:["https://hitomi.la/*"],constructor:()=>new Hi});const Wi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));function v(s,e){const t=e.querySelector(s);if(!t)throw new Error(`Can't find element: ${s}`);return t}class Zi extends R{meta;data;gth;async fetchOriginMeta(e,t){return{url:e.originSrc}}async parseImgNodes(){if(!this.data||!this.gth)throw new Error("impossibility");const e=[],t=this.data.total.toString().length;for(let i=1;i<=this.data.total;i++){const n=`https://m${this.data.server}.imhentai.xxx/${this.data.imgDir}/${this.data.gid}/${i}t.jpg`,r=`https://imhentai.xxx/view/${this.data.uid}/${i}/`,o=Xi(this.gth[i.toString()]),a=`https://m${this.data.server}.imhentai.xxx/${this.data.imgDir}/${this.data.gid}/${i}.${o}`;let l;const c=this.gth[i.toString()].split(",");c.length===3&&(l={w:parseInt(c[1]),h:parseInt(c[2])});const d=new k(n,r,`${i.toString().padStart(t,"0")}.${o}`,void 0,a,l);e.push(d)}return e}async*fetchPagesSource(){const e=v("#load_server",document).value,t=v("#gallery_id",document).value,i=v("#load_id",document).value,n=v("#load_dir",document).value,r=v("#load_pages",document).value;this.data={server:e,uid:t,gid:i,imgDir:n,total:Number(r)};const o=Array.from(document.querySelectorAll("script")).find(a=>a.textContent?.trimStart().startsWith("var g_th"))?.textContent?.match(/\('(\{.*?\})'\)/)?.[1];if(!o)throw new Error("cannot match gallery images info");this.gth=JSON.parse(o),yield I.ok(null)}title(){const e=this.galleryMeta();let t="";return h.conf.ehentaiTitlePrefer==="japanese"?t=e.originTitle||e.title||"UNTITLE":t=e.title||e.originTitle||"UNTITLE",t}galleryMeta(){if(this.meta)return this.meta;const e=document.querySelector(".right_details > h1")?.textContent||void 0,t=document.querySelector(".right_details > p.subtitle")?.textContent||void 0,i=new P(window.location.href,e||"UNTITLE");i.originTitle=t,i.tags={};const n=Array.from(document.querySelectorAll(".galleries_info > li"));for(const r of n){let o=r.querySelector(".tags_text")?.textContent;if(!o||(o=o.replace(":","").trim(),!o))continue;const a=Array.from(r.querySelectorAll("a.tag")).map(l=>l.firstChild?.textContent?.trim()).filter(l=>!!l);i.tags[o]=a}return this.meta=i,this.meta}}function Xi(s){switch(s.slice(0,1)){case"j":return"jpg";case"g":return"gif";case"p":return"png";case"w":return"webp";case"a":return"avif";case"m":return"mp4";default:throw new Error("cannot parse image extension from info: "+s)}}h.addSetup({name:"im-hentai",workURLs:[/imhentai.xxx\/gallery\/\d+\//],match:["https://imhentai.xxx/*"],constructor:()=>new Zi});const Ki=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class Yi extends R{config;async*fetchPagesSource(){this.config=Ji();let e=null;for(;;)try{const[t,i]=await this.fetchPosts(e);if(e=i.end_cursor,yield I.ok(t),!i.has_next_page)break}catch(t){yield I.err(t)}}async parseImgNodes(e){const t=[];for(let i=0;i<e.length;i++){const n=e[i],r=n.video_versions,o=!r&&n.carousel_media&&n.carousel_media.length>0?n.carousel_media.map(l=>l.image_versions2):[n.image_versions2],a=o.length.toString().length;for(let l=0;l<o.length;l++){const c=o[l],d=o.length>1?`${n.pk}-${(l+1).toString().padStart(a,"0")}`:n.pk,p=r?"mp4":"jpeg",[u,g]=this.getThumbAndOrigin(c.candidates,r);t.push(new k(u?.url??"",`${window.location.origin}/p/${n.code}`,`${d}.${p}`,void 0,g.url,{w:u.width,h:u.height}))}}return t}async fetchOriginMeta(e){return{url:e.originSrc}}async fetchPosts(e){if(!this.config)throw new Error("instagram config null");const t=this.config,i=new Headers;i.append("x-fb-friendly-name",t.apiName),i.append("x-bloks-version-id",t.bloksVersionID),i.append("x-csrftoken",t.csrfToken),i.append("x-ig-app-id",t.appID),i.append("x-fb-lsd",t.lsd),i.append("x-asbd-id","129477");let n={username:t.username,__relay_internal__pv__PolarisIsLoggedInrelayprovider:!0,__relay_internal__pv__PolarisFeedShareMenurelayprovider:!0,data:{count:12,include_relationship_info:!0,latest_besties_reel_media:!0,latest_reel_media:!0}};e&&(n.after=e,n.before=null,n.first=12,n.last=null);const r=new URLSearchParams;r.append("av",t.userID),r.append("__d","www"),r.append("__user","0"),r.append("__a","1"),r.append("__req","x"),r.append("__hs",t.hasteSession),r.append("dpr","1"),r.append("__ccg","UNKNOWN"),r.append("__rev",t.clientVersion),r.append("__hsi",t.hsi),r.append("__dyn",t.dyn),r.append("__comet_req","7"),r.append("fb_dtsg",t.dtsg),r.append("lsd",t.lsd),r.append("__spin_r",t.spinR),r.append("__spin_b",t.spinB),r.append("__spin_t",t.spinT),r.append("fb_api_caller_class","RelayModern"),r.append("fb_api_req_friendly_name",t.apiName),r.append("variables",JSON.stringify(n)),r.append("server_timestamps","true"),r.append("doc_id",t.docID);const a=(await window.fetch("https://www.instagram.com/graphql/query",{headers:i,body:r,method:"POST"}).then(l=>l.json()))?.data?.xdt_api__v1__feed__user_timeline_graphql_connection;if(!a)throw new Error("failed fetch user's posts by API");return[a.edges.map(l=>l.node),a.page_info]}getThumbAndOrigin(e,t){const i=t?.[0]??e[0];let n;for(const r of e){if(!n){n=r;continue}if(n.width<r.width||r.width<=240)break;n=r}return[n,i]}}function Ji(){const s=new Error("cannot find instagram config from script[data-sjs]"),e=Array.from(document.querySelectorAll("script[data-sjs]")).find(U=>U.textContent?.trimStart().startsWith('{"require":[["ScheduledServerJS","handle",null,[{"__bbox":{"define":'))?.textContent;if(!e)throw s;const n=(JSON.parse(e).require?.[0]?.[3]?.[0]?.__bbox?.define).reduce((U,H)=>(U[H[0]]=H[2],U),{});if(!n)throw s;let r=n.InstagramSecurityConfig?.csrf_token,o=n.LSD?.token,a=n.WebBloksVersioningID?.versioningID,l=n.CurrentUserInitialData?.APP_ID,c=n.CurrentUserInitialData?.NON_FACEBOOK_USER_ID,d=n.SiteData?.haste_session,p=n.SiteData?.client_revision,u=n.SiteData?.hsi,g=n.SiteData?.__spin_r,m=n.SiteData?.__spin_b,b=n.SiteData?.__spin_t,y=n.DTSGInitData?.token;const w=window.location.pathname.split("/")?.[1];if(!r||!o||!a||!l||!c||!d||!p||!u||!g||!m||!b||!y||!w)throw s;return{csrfToken:r,lsd:o,bloksVersionID:a,appID:l,userID:c,hasteSession:d,clientVersion:p,hsi:u,spinR:g,spinB:m,spinT:b,dtsg:y,docID:"8363144743749214",apiName:"PolarisProfilePostsTabContentQuery_connection",dyn:"7xeUjG1mxu1syUbFp41twpUnwgU7SbzEdF8aUco2qwJxS0k24o0B-q1ew65xO0FE2awgo9oO0n24oaEnxO1ywOwv89k2C1Fwc60D87u3ifK0EUjwGzEaE2iwNwmE2eUlwhEe87q7U1mVEbUGdG1QwTU9UaQ0Lo6-3u2WE5B08-269wr86C1mwPwUQp1yUb9UK6V8aUuwm9EO6UaU4W",username:w}}h.addSetup({name:"Instagram",workURLs:[/instagram.com\/(?!(home|explore|direct|reels|stories))\w+/],match:["https://www.instagram.com/*"],constructor:()=>new Yi});const Qi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),en=["jpeg","jpg","png","gif","webp","bmp","avif","jxl"],tn=["mp4","webm","ogg","ogv","mov","avi","mkv","av1"];function le(s){return en.includes(s)}function ce(s){return tn.includes(s)}class Ne{async*next(){const e=new URL(window.location.href);let t=parseInt(e.searchParams.get("o")??"0");t=isNaN(t)?0:t;const i=e.searchParams.get("q");for(;;){const n=await window.fetch(this.getURL(t,i)).then(l=>l.json()).catch(Error);if(n instanceof Error){yield I.err(n);continue}if(n.error){yield I.err(new Error(n.error));continue}const r=this.getPosts(n);if(!r||r.length===0)break;t+=r.length;const o=et(this.getList(n));o.size>0&&r.forEach(l=>{if(l.file?.path){const c=o.get(l.file.path);l.file.name=c?.name,l.file.server=c?.server}l.attachments&&l.attachments.length>0&&l.attachments.forEach(c=>{if(c.path){const d=o.get(c.path);c.name=d?.name,c.server=d?.server}})});const a=r.length;for(;r.length>0;)yield I.ok(r.splice(0,10));if(a<50)break}}}class nn extends Ne{getURL(e,t){const i=new URL(`${window.location.origin}/api/v1${window.location.pathname}/posts`);return e>0&&i.searchParams.set("o",e.toString()),t&&i.searchParams.set("q",t),i.href}getPosts(e){return e}getList(e){return[]}}class rn extends Ne{getURL(e,t){const i=new URL(`${window.location.origin}/api/v1${window.location.pathname}`);return e>0&&i.searchParams.set("o",e.toString()),t&&i.searchParams.set("q",t),i.href}getPosts(e){return e.posts}getList(){return[]}}class on extends Ne{getPosts(e){return e?.post?[e.post]:[]}getURL(){return`${window.location.origin}/api/v1${window.location.pathname}`}getList(e){return[...e.previews??[],...e.attachments??[]]}}class an extends R{list;constructor(){super(),window.location.href.includes("/posts")?this.list=new rn:/user\/\w+/.test(window.location.href)&&(/post\/\w+/.test(window.location.href)?this.list=new on:this.list=new nn)}fetchPagesSource(){if(!this.list)throw new Error("Current path is not supported");return this.list.next()}async parseImgNodes(e){const t=[],i=(o,a,l,c,d,p)=>{const u=`https://img.kemono.cr/thumbnail/data/${c}`,g=`${window.location.origin}/${l}/user/${a}/post/${o}`;let m=p?`${p}/data/${c}?f=${d}`:void 0;const b=new k(u,g,d,void 0,m);c.indexOf(".mp4")>1&&(b.mimeType="video/mp4",b.thumbnailSrc="");const y=c.split(".").pop()??"";if(!(!le(y)&&(h.conf.excludeVideo||!ce(y))))return b},n=[];for(const o of e){const a=[];o.file?.path&&a.push(o.file),a.push(...o.attachments??[]),n.push({res:o,list:a,needFetchPost:!a[0]?.server&&a.length>0})}await this.batchFetchPathServerMap(n);const r=new Map;for(const o of n)for(const a of o.list){if(!a.path)continue;if(!a.name||!a.server)throw new Error("cannot find image or video name and server");const l=i(o.res.id,o.res.user,o.res.service,a.path,a.name,a.server);if(l){if(r.has(l.originSrc))continue;r.set(l.originSrc,!0),t.push(l)}}return t}async fetchOriginMeta(e){if(!e.originSrc)throw new Error("cannot find kemono image file: "+e.href);return{url:e.originSrc}}async batchFetchPathServerMap(e){const t=e.filter(o=>o.needFetchPost).map(o=>new Request(`${window.location.origin}/api/v1/${o.res.service}/user/${o.res.user}/post/${o.res.id}`,{headers:{Accept:"text/css"}})),n=(await Te(t,10,"json")).reduce((o,a)=>[...o,...a.previews??[],...a.attachments??[]],[]),r=et(n);e.filter(o=>o.needFetchPost).forEach(o=>o.list.forEach(a=>{if(a.path){const l=r.get(a.path);a.name=l?.name,a.server=l?.server}}))}}function et(s){const e=new Map;for(const t of s??[])t.path&&t.server&&e.set(t.path,{server:t.server,name:t.name});return e}h.addSetup({name:"Kemono",workURLs:[/kemono.cr\/(\w+\/user\/\w+(\/post\/\w+)?|posts)(\?\w=.*)?$/],match:["https://kemono.cr/*"],constructor:()=>new an});const sn=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),ln=/Post\.register\((.*)\)/g;class tt extends R{infos={};count=0;async*fetchPagesSource(){let e=document;yield I.ok(e);let t=0;for(;;){const i=e.querySelector("#paginator a.next_page")?.href;if(!i)break;try{e=await window.fetch(i).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html"))}catch(n){if(t++,t>3)throw new Error(`fetch next page failed, ${n}`);continue}t=0,yield I.ok(e)}}async parseImgNodes(e){const t=e.querySelector("body > script + script")?.textContent;if(!t)throw new Error("cannot find post list from script");const i=t.matchAll(ln),n=[];for(const r of i)if(!(!r||r.length<2))try{const o=JSON.parse(r[1]);this.infos[o.id.toString()]=o,this.count++;const a=o.file_ext||o.file_url.split(".").pop();n.push(new k(o.preview_url,`${window.location.origin}/post/show/${o.id}`,`${o.id}.${a}`))}catch(o){A("error","parse post info failed",o);continue}return n}async fetchOriginMeta(e){const t=e.href.split("/").pop();if(!t)throw new Error(`cannot find id from ${e.href}`);let i;if(h.conf.fetchOriginal?i=this.infos[t]?.file_url:i=this.infos[t]?.sample_url,!i)throw new Error(`cannot find url for id ${t}`);return{url:i}}galleryMeta(){const t=new URL(window.location.href).searchParams.get("tags")?.trim(),i=new P(window.location.href,`konachan_${t}_${this.count}`);return i.infos=this.infos,i}}h.addSetup({name:"konachan",workURLs:[/konachan.com\/post(?!\/show\/.*)/],match:["https://konachan.com/*"],constructor:()=>new tt});const cn=Object.freeze(Object.defineProperty({__proto__:null,KonachanMatcher:tt},Symbol.toStringTag,{value:"Module"}));class dn extends R{update_date;chapterCount=0;meta;galleryMeta(){if(this.meta)return this.meta;let e=document.querySelector(".comicParticulars-title-right > ul > li > h6")?.textContent??document.title;return document.querySelectorAll(".comicParticulars-title-right > ul > li > span.comicParticulars-right-txt").forEach(t=>{/^\d{4}-\d{2}-\d{2}$/.test(t.textContent?.trim()||"")&&(this.update_date=t.textContent?.trim())}),e+="-c"+this.chapterCount+(this.update_date?"-"+this.update_date:""),this.meta=new P(window.location.href,e),this.meta}async*fetchPagesSource(e){yield I.ok(e.source)}async parseImgNodes(e){const t=await Le(e,"text",{"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.79 Safari/537.36"}),i=new DOMParser().parseFromString(t,"text/html"),n=t.match(/var (jojo|ccy|cct)\s?=\s?'(.*?)';/)?.[2];if(!n)throw new Error("cannot find jojo|ccy|cct Key for decrypt :(");const r=i.querySelector(".imageData[contentKey]")?.getAttribute("contentKey")??t.match(/var (contentKey)\s?=\s?'(.*?)';/)?.[2];if(!r)throw new Error("cannot find content key");try{const o=await pn(r,n),a=JSON.parse(o),l=a.length.toString().length;return a.map((c,d)=>new k("",e,(d+1).toString().padStart(l,"0")+".webp",void 0,c.url))}catch(o){throw new Error("cannot decrypt contentKey: "+o.toString()+`
`+r)}}async fetchOriginMeta(e){return{url:e.originSrc}}async fetchChapters(){const e=document.querySelector(".comicParticulars-left-img > img[data-src]")?.getAttribute("data-src")||void 0,t=window.location.href.match(hn)?.[1];if(!t)throw new Error("cannot match comic id");const i=`https://api.mangacopy.com/api/v3/comic2/${t}?platform=1&_update=true`,n=await window.fetch(i).then(l=>l.json()).catch(l=>new Error(l.toString()));if(n instanceof Error||!n.results.groups)throw new Error("fetch comic detail error: "+n.toString());if(n.code!==200)throw new Error("fetch comic detail error: "+n.message);const r=[],o=n.results.groups;let a=0;for(const l in o){let c=0;for(;;){const d=`https://api.mangacopy.com/api/v3/comic/${t}/group/${o[l].path_word}/chapters?limit=100&offset=${c}&_update=true`,p=await window.fetch(d).then(g=>g.json()).catch(g=>new Error(g.toString()));if(p instanceof Error)throw new Error("fetch chapters error: "+p.toString());if(p.code!==200)throw new Error("fetch chaters error: "+p.message);const u=p.results;c+=u.list.length;for(const g of u.list)r.push(new O(a++,l==="default"?g.name:`${o[l].name}-${g.name}`,`${window.location.origin}/comic/${t}/chapter/${g.uuid}`,e));if(c>=u.total)break}}return r}}const hn=/\/comic\/(\w*)/;async function pn(s,e){const t=new TextEncoder,i=new TextDecoder,n=t.encode(e),r=s.substring(0,16),o=s.substring(16),a=t.encode(r),l=new Uint8Array(o.match(/.{1,2}/g).map(p=>parseInt(p,16))),c=await crypto.subtle.importKey("raw",n,{name:"AES-CBC"},!1,["decrypt"]),d=await crypto.subtle.decrypt({name:"AES-CBC",iv:a},c,l);return i.decode(d)}h.addSetup({name:"\u62F7\u8D1D\u6F2B\u753B",workURLs:[/(mangacopy|copymanga).*?\/comic\/[^\/]*\/?$/],match:["https://www.mangacopy.com/*"],constructor:()=>new dn});const un=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class gn extends R{async fetchChapters(){let e=Array.from(document.querySelectorAll("div[data-name='chapter-list'] .flex-col > .px-2 > .space-x-1 > a"));return e.length===0&&(e=Array.from(document.querySelectorAll("div[data-name='chapter-list'] .flex-col-reverse > .px-2 > .space-x-1 > a")),e=e.reverse()),e.map((t,i)=>new O(i,t.textContent??"Chapter"+(i+1),t.href))}async*fetchPagesSource(e){yield I.ok(e.source)}async parseImgNodes(e){const t=await window.fetch(e).then(r=>r.text()).then(r=>new DOMParser().parseFromString(r,"text/html")).catch(Error);if(t instanceof Error)throw t;const i=Array.from(t.querySelectorAll("div[data-name='image-item'] > div")),n=i.length.toString().length;return i.map((r,o)=>{const a=r.querySelector("img")?.src;if(!a)throw new Error("cannot find image from chapter: "+e);const l=a.split(".").pop()??"jpg",c=(o+1).toString().padStart(n,"0")+"."+l,[d,p]=[parseInt(r.style.width),parseInt(r.style.height)];return new k("",e,c,void 0,a,{w:d,h:p})})}async fetchOriginMeta(e){return{url:e.originSrc}}}h.addSetup({name:"MangaPark",workURLs:[/mangapark.(net|com)\/title\/[^/]+$/],match:["https://mangapark.com/*"],constructor:()=>new gn});const mn=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class fn extends R{meta;galleryMeta(){if(this.meta)return this.meta;const e=new P(window.location.href,""),t=document.querySelector("astro-island[component-url^='/_astro/Display_EmotionChart'][props]")?.getAttribute("props");if(t){const i=JSON.parse(t)?.data?.[1];if(i?.name){e.title=i.name[1];try{["artists","authors","genres","altNames"].forEach(n=>{const o=JSON.parse(i[n][1]).map(a=>a[1]);e.tags[n]=o,n==="altNames"&&(e.originTitle=o[o.length-1])})}catch(n){A("error","parse gallery info error",n)}}}return this.meta=e,this.meta}async fetchChapters(){let e=Array.from(document.querySelectorAll("div[name=chapter-list] .scrollable-panel .flex-col-reverse astro-slot > div"));return e=e.reverse(),e.length===0&&(e=Array.from(document.querySelectorAll("div[name=chapter-list] .scrollable-panel .flex-col astro-slot > div"))),e.map((t,i)=>{const n=t.querySelector("div:first-child > a");if(!n)throw new Error("cannot find chapter element");return new O(i,n.textContent,n.href)})}async*fetchPagesSource(e){const t=new URL(e.source);t.searchParams.set("load","2");const i=await window.fetch(t).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html")).catch(Error);if(i instanceof Error)throw i;yield I.ok(i)}async parseImgNodes(e){const t=e.querySelector("astro-island[component-url^='/_astro/ImageList'][props]")?.getAttribute("props");if(!t)throw new Error("cannot find ImageList props");const i=JSON.parse(t);if(!i.imageFiles?.[1])throw new Error("cannot find imageFiles from ImageList props");const n=JSON.parse(i.imageFiles[1]);if(!n.length||n.length===0)throw new Error("cannot find images");const r=n.length.toString().length;return n.map(([o,a],l)=>{const c=(l+1).toString().padStart(r,"0"),d=a.split(".").pop()??"webp";let p;const u=a.match(/\/\d+_(\d+)_(\d+)_\d+\.\w+$/);return u&&u.length===3&&(p={w:parseInt(u[1]),h:parseInt(u[2])}),new k("",l+1+"",`${c}.${d}`,void 0,a,p)})}async fetchOriginMeta(e){return{url:e.originSrc}}}h.addSetup({name:"BATO.TO v3x",workURLs:[/(mangatoto.com|bato.to)\/title\/\d+[^\/]*$/],match:["https://mangatoto.com/*","https://bato.to/*"],constructor:()=>new fn});const bn=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class wn extends R{meta;chapterCount=0;galleryMeta(){if(this.meta)return this.meta;let e=document.querySelector(".book-title > h1")?.textContent??document.title;e+="-c"+this.chapterCount;const t=document.querySelector(".detail-list .status")?.textContent?.match(Cn),i=t?.[1];e+=i?"-"+i:"";const n=t?.[2];return e+=n?"-"+n.trim():"",this.meta=new P(window.location.href,e),this.meta}async*fetchPagesSource(e){yield I.ok(e.source)}async parseImgNodes(e){const i=(await window.fetch(e).then(o=>o.text())).match(xn);if(!i||i.length<5)throw new Error("cannot match image data");let n;try{n=An(i[1],parseInt(i[2]),parseInt(i[3]),i[4])}catch(o){throw new Error("cannot parse image data: "+o.toString())}const r=_n();return n.files.map((o,a)=>{const l=`${r}/${n.path}/${o}?e=${n.sl.e}&m=${n.sl.m}}`,c=`https://www.manhuagui.com/comic/${n.bid}/${n.cid}.html#p=${a+1}`;return new k("",c,o,void 0,l)})}async fetchOriginMeta(e){return{url:e.originSrc}}async fetchChapters(){const e=document.querySelector(".book-cover img")?.src,t=[];return document.querySelectorAll(".chapter-list").forEach(i=>{let n=vn(i,"prev",r=>r.tagName.toLowerCase()==="h4")?.firstElementChild?.textContent??void 0;n=n?n+"-":"",i.querySelectorAll("ul").forEach(r=>{const o=Array.from(r.querySelectorAll("li > a")).reverse().map(a=>new O(0,n+a.title,a.href,e));t.push(...o)})}),t.forEach((i,n)=>i.id=n+1),t}}function vn(s,e,t){const i=r=>r.previousElementSibling;let n=s;for(;n=i(n);)if(t(n))return n;return null}const yn=[{name:"\u81EA\u52A8",hosts:[{h:"i",w:.1},{h:"eu",w:5},{h:"eu1",w:5},{h:"us",w:1},{h:"us1",w:1},{h:"us2",w:1},{h:"us3",w:1}]},{name:"\u7535\u4FE1",hosts:[{h:"eu",w:1},{h:"eu1",w:1}]},{name:"\u8054\u901A",hosts:[{h:"us",w:1},{h:"us1",w:1},{h:"us2",w:1},{h:"us3",w:1}]}];function _n(){const s=parseInt(window.localStorage.getItem("")??"0"),e=parseInt(window.localStorage.getItem("")??"0");return`https://${yn[s]?.hosts[e]?.h??"us1"}.hamreus.com`}const Cn=/\[(\d{4}-\d{2}-\d{2})\].*?\[(.*?)\]/,xn=/\('\w+\.\w+\((.*?)\).*?,(\d+),(\d+),'(.*?)'\[/;function In(s){return LZString.decompressFromBase64(s)}function An(s,e,t,i){const n=In(i).split("|"),r={};function o(l){const c=l<e?"":o(Math.floor(l/e)).toString(),d=(l=l%e)>35?String.fromCharCode(l+29):l.toString(36);return c+d}for(;t--;)r[o(t)]=n[t]||o(t);const a=s.replace(new RegExp("\\b\\w+\\b","g"),l=>r[l]);return JSON.parse(a)}h.addSetup({name:"\u6F2B\u753B\u67DC",workURLs:[/manhuagui.com\/comic\/\d+\/?$/],match:["https://www.manhuagui.com/*"],constructor:()=>new wn});const Sn=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class kn extends R{map=new Map;currentDirectorMedias=[];async fetchChapters(){const e=Array.from(document.querySelectorAll("table tbody a.file")),t=[];let i=1;for(const n of e){const r=n.href,o=r.split(".").pop()?.toLowerCase();if(o==="zip")t.push(new O(i,n.textContent??"unknown-"+i,r)),i++;else if(le(o??"")||ce(o??"")){const a=new k(n.href,n.href,n.textContent??"",void 0,n.href);le(o)?a.mimeType="image/"+o:ce(o)&&(a.mimeType="video/"+o),this.currentDirectorMedias.push(a)}}if(this.currentDirectorMedias.length>0&&t.unshift(new O(0,"Current Directory","")),t.length===0)throw new Error("can not found zip files or current directory has empty image list");return t}async*fetchPagesSource(e){yield I.ok(e.source)}async parseImgNodes(e,t){if(!e&&this.currentDirectorMedias.length>0)return this.currentDirectorMedias;const i=await window.fetch(e).then(a=>a.blob()),r=await new ee.ZipReader(new ee.BlobReader(i)).getEntries(),o=new Map;return this.map.set(t,o),r.filter(a=>{const l=(a.filename.split(".").pop()??"jpg").toLowerCase();return le(l)||ce(l)}).map(a=>{const l=a.getData(new ee.BlobWriter);o.set(a.filename,l);const c=(a.filename.split(".").pop()??"jpg").toLowerCase(),d=new k("",a.filename,a.filename,void 0);return le(c)?d.mimeType="image/"+c:ce(c)&&(d.mimeType="video/"+c),d})}async fetchOriginMeta(e,t,i){if(e.originSrc)return{url:e.originSrc};const n=this.map.get(i)?.get(e.href);if(!n)throw new Error("cannot read image from zip");const r=await n;return{url:URL.createObjectURL(r)}}async processData(e,t,i){return[e,i.mimeType]}}h.addSetup({name:"Mini Serve",workURLs:[/.*:41021/],constructor:()=>new kn});const En=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class Ln extends R{meta;galleryMeta(e){return this.meta??super.galleryMeta(e)}initGalleryMeta(){const e=document.querySelector(".grow > div[data-flux-heading]")?.textContent??document.title;this.meta=new P(window.location.href,e)}async fetchChapters(){this.initGalleryMeta();const e=Array.from(document.querySelectorAll(".mt-8.mb-12 > div[x-data]")),t=[];for(const i of e){let n=i.getAttribute("x-data");n&&(n=n.replace(/,\n\s*toggleSorting\(\) \{.*?\},/gms,""),n=n.replaceAll(/(chapters|decending)/g,'"$1"'));const r=JSON.parse(n??"{}");let o=i.querySelector(".text-lg > div")?.textContent??"";if(o=o?o+"-":"",!r.chapters)continue;const a=r.chapters.map(l=>new O(l.id,o+l.title,`https://mycomic.com/cn/chapters/${l.id}`));t.push(...a)}return t}async*fetchPagesSource(e){const t=await window.fetch(e.source).then(i=>i.text()).then(i=>new DOMParser().parseFromString(i,"text/html"));yield I.ok(t)}async parseImgNodes(e,t){const i=Array.from(e.querySelectorAll(".\\-mx-6 > img[x-ref]")),n=[],r=i.length.toString().length;for(let o=0;o<i.length;o++){const a=i[o],l=a.getAttribute("src")||a.getAttribute("data-src");if(!l){A("error","cannot find imgage src, ",a);continue}const c=l.split(".").pop(),d=(o+1).toString().padStart(r,"0")+"."+c;n.push(new k("",l,d,void 0,l,{w:a.width,h:a.height}))}return n}async fetchOriginMeta(e){return{url:e.originSrc}}}h.addSetup({name:"My Comic",workURLs:[/mycomic.com\/(\w+\/)?comics\/\d+$/],match:["https://mycomic.com/*"],constructor:()=>new Ln});const Tn=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));function be(s){switch(s.slice(0,1)){case"j":return"jpg";case"g":return"gif";case"p":return"png";case"w":return"webp";case"a":return"avif";case"m":return"mp4";default:throw new Error("cannot parse image extension from info: "+s)}}class Rn extends R{meta;imageCDNUrls;galleryMeta(){return this.meta}parseInfo(){let e="",t="";Array.from(document.querySelectorAll("body > script")).forEach(l=>{const c=l.textContent;c&&(c.trimStart().startsWith("window._n_app")&&(e=c),c.trimStart().startsWith("window._gallery")&&(t=c))});const i=e.match(/thumb_cdn_urls:\s?\[(.*?)\],/)?.[1]?.split(",").map(l=>l.trim().replaceAll('"',"")),n=e.match(/image_cdn_urls:\s?\[(.*?)\],/)?.[1]?.split(",").map(l=>l.trim().replaceAll('"',""));if(!i||i.length===0)throw new Error("cannot find thumb_cdn_urls from script");if(!n||n.length===0)throw new Error("cannot find image_cdn_urls from script");const r=t.match(/parse\((.*)\);/)?.[1];if(!r)throw new Error("cannot find images info");const o=JSON.parse(JSON.parse(r)),a=new P(window.location.href,o.title.english);return a.originTitle=o.title.japanese,a.tags=o.tags.reduce((l,c)=>(l[c.type]||(l[c.type]=[]),l[c.type].push(c.name),l),{}),this.meta=a,{info:o,thumbCDNUrls:i,imageCDNUrls:n}}async fetchOriginMeta(e,t){if(t){const i=/https:\/\/(.*?)\//,n=e.originSrc?.match(i)?.[1],r=this.imageCDNUrls?.indexOf(n??"")??-1;if(r>-1)return{url:e.originSrc.replace(i,`https://${this.imageCDNUrls[(r+1)%this.imageCDNUrls.length]}/`)}}return{url:e.originSrc}}async parseImgNodes(e){await K(200);const t=Array.from(e.querySelectorAll(".thumb-container > .gallerythumb"));if(t.length==0)throw new Error("cannot find image nodes");const{info:i,imageCDNUrls:n}=this.parseInfo();this.imageCDNUrls=n;const r=t.length.toString().length,o=[];for(let a=0;a<t.length;a++){const l=t[a],c=l.querySelector("img")?.getAttribute("data-src")??"",d=(a+1).toString().padStart(r,"0"),p=be(i.images.pages[a].t),u=location.origin+l.getAttribute("href"),m=`https://${n[a%n.length]}/galleries/${i.media_id}/${a+1}.${p}`,b={w:i.images.pages[a].w,h:i.images.pages[a].h};o.push(new k(c,u,d+"."+p,void 0,m,b))}return o}async*fetchPagesSource(){yield I.ok(document)}}class Pn extends R{meta;galleryMeta(){return this.meta}parseMeta(){const e=document.querySelector(".info h1")?.textContent,t=document.querySelector(".info h2")?.textContent,i=new P(window.location.href,e??document.title);i.originTitle=t??void 0,Array.from(document.querySelectorAll(".info > ul > li.tags")).forEach(n=>{let r=n.querySelector("span.text")?.textContent??"misc";r=r.trim().replace(":","");const o=Array.from(n.querySelectorAll("a.tag_btn > .tag_name")).map(a=>a.textContent?.trim()).filter(Boolean);i.tags[r]=o}),this.meta=i}async*fetchPagesSource(){this.parseMeta(),yield I.ok(document)}async parseImgNodes(e){const t=e;await K(200);const[i,n]=this.parseInfo(t);if(i.length!==n.length)throw new Error("thumbs length not eq images length");const r=t.querySelector(".cover img")?.src;if(!r)throw new Error("cannot find cover src");const o=r.slice(0,r.lastIndexOf("/")+1),a=[],l=i.length.toString().length;let c=window.location.href;c.endsWith("/")&&(c=c.slice(0,-1));for(let d=0;d<i.length;d++){const p=(d+1).toString().padStart(l,"0"),u=n[d],g=o+u[0]+"."+be(u[1]),m=i[d],b=o+m[0]+"."+be(m[1]),y=m[1].split(",");let w;y.length===3&&(w={w:parseInt(y[1].trim()),h:parseInt(y[2].trim())}),a.push(new k(g,c+"/"+(d+1),p+"."+be(m[1]),void 0,b,w))}return a}parseInfo(e){const t=Array.from(e.querySelectorAll("script[type]")).find(o=>o.textContent?.trimStart().startsWith("var g_th"))?.textContent?.match(/\('(.*)'\);/);if(!t||t.length!==2)throw new Error("cannot find images info from script");const i=JSON.parse(t[1]),n=Object.entries(i.fl),r=Object.entries(i.th);return[n,r]}async fetchOriginMeta(e){return{url:e.originSrc}}}h.addSetup({name:"nhentai",workURLs:[/nhentai.net\/g\/\d+\/?$/],match:["https://nhentai.net/*"],constructor:()=>new Rn}),h.addSetup({name:"nhentai.xxx",workURLs:[/nhentai.xxx\/g\/\d+\/?$/],match:["https://nhentai.xxx/*"],constructor:()=>new Pn});const Mn=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Nn=/niyaniya.moe\/\w+\/(\d+\/\w+)/,$e="api.schale.network",$n={0:"misc",1:"artist",2:"circle",7:"uploader",8:"male",9:"female",10:"mixed",11:"language"};class On extends R{meta;galleryMeta(){return this.meta||new P(window.location.href,"koharu-unknows")}async*fetchPagesSource(e){yield I.ok(e.source)}createMeta(e){const t=e.tags.reduce((i,n)=>{const r=$n[n.namespace||0]||"misc";return i[r]||(i[r]=[]),i[r].push(n.name),i},{});this.meta=new P(window.location.href,e.title),this.meta.tags=t}async parseImgNodes(e){const t=e.match(Nn),i=window.localStorage.getItem("clearance");if(!i)throw new Error("cannot get clearance from localStorage");if(!t||t.length<2)throw new Error("invaild url: "+e);const n=t[1],r=`https://${$e}/books/detail/${n}`,o=`https://${$e}/books/detail/${n}?crt=${i}`,[a,l]=await Promise.all([window.fetch(r).then(w=>w.json()).then(w=>w).catch(Error),window.fetch(o,{method:"POST"}).then(w=>w.json()).then(w=>w).catch(Error)]);if(a instanceof Error||l instanceof Error)throw new Error("failed to obtain data, perhaps the API of this site has changed");a.data=l.data,this.createMeta(a);const[c,d]=Object.entries(a.data).sort((w,C)=>C[1].size-w[1].size).find(([w,C])=>C.id!==void 0&&C.key!==void 0)??[void 0,void 0];if(c===void 0&&d===void 0)throw new Error("cannot find resolution from gallery detail");const p=`https://${$e}/books/data/${n}/${d.id}/${d.key}/${c}?crt=${i}`,u=await window.fetch(p).then(w=>w.json()).then(w=>w).catch(Error);if(u instanceof Error)throw new Error("failed to obtain data, perhaps the API of this site has changed");if(u.entries.length!==a.thumbnails.entries.length)throw new Error("thumbnails length not match");const g=a.thumbnails.entries,m=a.thumbnails.base,b=u.base,y=u.entries.length.toString().length;return u.entries.map((w,C)=>{const E=`${window.location.origin}/reader/${n}/${C+1}`,T=(C+1).toString().padStart(y,"0")+"."+w.path.split(".").pop(),U=b+w.path;return new k(m+g[C].path,E,T,void 0,U,{w:w.dimensions[0],h:w.dimensions[1]})})}async fetchOriginMeta(e){return{url:e.originSrc}}headers(){return{Referer:"https://niyaniya.moe/",Origin:window.location.origin}}}h.addSetup({name:"niyaniya.moe",workURLs:[/(niyaniya.moe|shupogaki.moe|hoshino.one)\/(g|reader)\/\d+\/\w+/],match:["https://niyaniya.moe/*"],constructor:()=>new On});const Dn=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var N;(function(s){s.LOAD="LOAD",s.EXEC="EXEC",s.FFPROBE="FFPROBE",s.WRITE_FILE="WRITE_FILE",s.READ_FILE="READ_FILE",s.DELETE_FILE="DELETE_FILE",s.RENAME="RENAME",s.CREATE_DIR="CREATE_DIR",s.LIST_DIR="LIST_DIR",s.DELETE_DIR="DELETE_DIR",s.ERROR="ERROR",s.DOWNLOAD="DOWNLOAD",s.PROGRESS="PROGRESS",s.LOG="LOG",s.MOUNT="MOUNT",s.UNMOUNT="UNMOUNT"})(N||(N={}));const Un=(()=>{let s=0;return()=>s++})(),qn=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),Bn=new Error("called FFmpeg.terminate()"),zn="KGZ1bmN0aW9uICgpIHsKICAgICd1c2Ugc3RyaWN0JzsKCiAgICBjb25zdCBDT1JFX1ZFUlNJT04gPSAiMC4xMi42IjsKICAgIGNvbnN0IENPUkVfVVJMID0gYGh0dHBzOi8vdW5wa2cuY29tL0BmZm1wZWcvY29yZUAke0NPUkVfVkVSU0lPTn0vZGlzdC91bWQvZmZtcGVnLWNvcmUuanNgOwogICAgdmFyIEZGTWVzc2FnZVR5cGU7CiAgICAoZnVuY3Rpb24gKEZGTWVzc2FnZVR5cGUpIHsKICAgICAgICBGRk1lc3NhZ2VUeXBlWyJMT0FEIl0gPSAiTE9BRCI7CiAgICAgICAgRkZNZXNzYWdlVHlwZVsiRVhFQyJdID0gIkVYRUMiOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIldSSVRFX0ZJTEUiXSA9ICJXUklURV9GSUxFIjsKICAgICAgICBGRk1lc3NhZ2VUeXBlWyJSRUFEX0ZJTEUiXSA9ICJSRUFEX0ZJTEUiOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIkRFTEVURV9GSUxFIl0gPSAiREVMRVRFX0ZJTEUiOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIlJFTkFNRSJdID0gIlJFTkFNRSI7CiAgICAgICAgRkZNZXNzYWdlVHlwZVsiQ1JFQVRFX0RJUiJdID0gIkNSRUFURV9ESVIiOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIkxJU1RfRElSIl0gPSAiTElTVF9ESVIiOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIkRFTEVURV9ESVIiXSA9ICJERUxFVEVfRElSIjsKICAgICAgICBGRk1lc3NhZ2VUeXBlWyJFUlJPUiJdID0gIkVSUk9SIjsKICAgICAgICBGRk1lc3NhZ2VUeXBlWyJET1dOTE9BRCJdID0gIkRPV05MT0FEIjsKICAgICAgICBGRk1lc3NhZ2VUeXBlWyJQUk9HUkVTUyJdID0gIlBST0dSRVNTIjsKICAgICAgICBGRk1lc3NhZ2VUeXBlWyJMT0ciXSA9ICJMT0ciOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIk1PVU5UIl0gPSAiTU9VTlQiOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIlVOTU9VTlQiXSA9ICJVTk1PVU5UIjsKICAgIH0pKEZGTWVzc2FnZVR5cGUgfHwgKEZGTWVzc2FnZVR5cGUgPSB7fSkpOwoKICAgIGNvbnN0IEVSUk9SX1VOS05PV05fTUVTU0FHRV9UWVBFID0gbmV3IEVycm9yKCJ1bmtub3duIG1lc3NhZ2UgdHlwZSIpOwogICAgY29uc3QgRVJST1JfTk9UX0xPQURFRCA9IG5ldyBFcnJvcigiZmZtcGVnIGlzIG5vdCBsb2FkZWQsIGNhbGwgYGF3YWl0IGZmbXBlZy5sb2FkKClgIGZpcnN0Iik7CiAgICBjb25zdCBFUlJPUl9JTVBPUlRfRkFJTFVSRSA9IG5ldyBFcnJvcigiZmFpbGVkIHRvIGltcG9ydCBmZm1wZWctY29yZS5qcyIpOwoKICAgIC8vLyA8cmVmZXJlbmNlIG5vLWRlZmF1bHQtbGliPSJ0cnVlIiAvPgogICAgLy8vIDxyZWZlcmVuY2UgbGliPSJlc25leHQiIC8+CiAgICAvLy8gPHJlZmVyZW5jZSBsaWI9IndlYndvcmtlciIgLz4KICAgIGxldCBmZm1wZWc7CiAgICBjb25zdCBsb2FkID0gYXN5bmMgKHsgY29yZVVSTDogX2NvcmVVUkwsIHdhc21VUkw6IF93YXNtVVJMLCB3b3JrZXJVUkw6IF93b3JrZXJVUkwsIH0pID0+IHsKICAgICAgICBjb25zdCBmaXJzdCA9ICFmZm1wZWc7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKCFfY29yZVVSTCkKICAgICAgICAgICAgICAgIF9jb3JlVVJMID0gQ09SRV9VUkw7CiAgICAgICAgICAgIC8vIHdoZW4gd2ViIHdvcmtlciB0eXBlIGlzIGBjbGFzc2ljYC4KICAgICAgICAgICAgaW1wb3J0U2NyaXB0cyhfY29yZVVSTCk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgaWYgKCFfY29yZVVSTCkKICAgICAgICAgICAgICAgIF9jb3JlVVJMID0gQ09SRV9VUkwucmVwbGFjZSgnL3VtZC8nLCAnL2VzbS8nKTsKICAgICAgICAgICAgLy8gd2hlbiB3ZWIgd29ya2VyIHR5cGUgaXMgYG1vZHVsZWAuCiAgICAgICAgICAgIHNlbGYuY3JlYXRlRkZtcGVnQ29yZSA9IChhd2FpdCBpbXBvcnQoCiAgICAgICAgICAgIC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi8gLyogQHZpdGUtaWdub3JlICovIF9jb3JlVVJMKSkuZGVmYXVsdDsKICAgICAgICAgICAgaWYgKCFzZWxmLmNyZWF0ZUZGbXBlZ0NvcmUpIHsKICAgICAgICAgICAgICAgIHRocm93IEVSUk9SX0lNUE9SVF9GQUlMVVJFOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNvbnN0IGNvcmVVUkwgPSBfY29yZVVSTDsKICAgICAgICBjb25zdCB3YXNtVVJMID0gX3dhc21VUkwgPyBfd2FzbVVSTCA6IF9jb3JlVVJMLnJlcGxhY2UoLy5qcyQvZywgIi53YXNtIik7CiAgICAgICAgY29uc3Qgd29ya2VyVVJMID0gX3dvcmtlclVSTAogICAgICAgICAgICA/IF93b3JrZXJVUkwKICAgICAgICAgICAgOiBfY29yZVVSTC5yZXBsYWNlKC8uanMkL2csICIud29ya2VyLmpzIik7CiAgICAgICAgZmZtcGVnID0gYXdhaXQgc2VsZi5jcmVhdGVGRm1wZWdDb3JlKHsKICAgICAgICAgICAgLy8gRml4IGBPdmVybG9hZCByZXNvbHV0aW9uIGZhaWxlZC5gIHdoZW4gdXNpbmcgbXVsdGktdGhyZWFkZWQgZmZtcGVnLWNvcmUuCiAgICAgICAgICAgIC8vIEVuY29kZWQgd2FzbVVSTCBhbmQgd29ya2VyVVJMIGluIHRoZSBVUkwgYXMgYSBoYWNrIHRvIGZpeCBsb2NhdGVGaWxlIGlzc3VlLgogICAgICAgICAgICBtYWluU2NyaXB0VXJsT3JCbG9iOiBgJHtjb3JlVVJMfSMke2J0b2EoSlNPTi5zdHJpbmdpZnkoeyB3YXNtVVJMLCB3b3JrZXJVUkwgfSkpfWAsCiAgICAgICAgfSk7CiAgICAgICAgZmZtcGVnLnNldExvZ2dlcigoZGF0YSkgPT4gc2VsZi5wb3N0TWVzc2FnZSh7IHR5cGU6IEZGTWVzc2FnZVR5cGUuTE9HLCBkYXRhIH0pKTsKICAgICAgICBmZm1wZWcuc2V0UHJvZ3Jlc3MoKGRhdGEpID0+IHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICB0eXBlOiBGRk1lc3NhZ2VUeXBlLlBST0dSRVNTLAogICAgICAgICAgICBkYXRhLAogICAgICAgIH0pKTsKICAgICAgICByZXR1cm4gZmlyc3Q7CiAgICB9OwogICAgY29uc3QgZXhlYyA9ICh7IGFyZ3MsIHRpbWVvdXQgPSAtMSB9KSA9PiB7CiAgICAgICAgZmZtcGVnLnNldFRpbWVvdXQodGltZW91dCk7CiAgICAgICAgZmZtcGVnLmV4ZWMoLi4uYXJncyk7CiAgICAgICAgY29uc3QgcmV0ID0gZmZtcGVnLnJldDsKICAgICAgICBmZm1wZWcucmVzZXQoKTsKICAgICAgICByZXR1cm4gcmV0OwogICAgfTsKICAgIGNvbnN0IHdyaXRlRmlsZSA9ICh7IHBhdGgsIGRhdGEgfSkgPT4gewogICAgICAgIGZmbXBlZy5GUy53cml0ZUZpbGUocGF0aCwgZGF0YSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9OwogICAgY29uc3QgcmVhZEZpbGUgPSAoeyBwYXRoLCBlbmNvZGluZyB9KSA9PiBmZm1wZWcuRlMucmVhZEZpbGUocGF0aCwgeyBlbmNvZGluZyB9KTsKICAgIC8vIFRPRE86IGNoZWNrIGlmIGRlbGV0aW9uIHdvcmtzLgogICAgY29uc3QgZGVsZXRlRmlsZSA9ICh7IHBhdGggfSkgPT4gewogICAgICAgIGZmbXBlZy5GUy51bmxpbmsocGF0aCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9OwogICAgY29uc3QgcmVuYW1lID0gKHsgb2xkUGF0aCwgbmV3UGF0aCB9KSA9PiB7CiAgICAgICAgZmZtcGVnLkZTLnJlbmFtZShvbGRQYXRoLCBuZXdQYXRoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH07CiAgICAvLyBUT0RPOiBjaGVjayBpZiBjcmVhdGlvbiB3b3Jrcy4KICAgIGNvbnN0IGNyZWF0ZURpciA9ICh7IHBhdGggfSkgPT4gewogICAgICAgIGZmbXBlZy5GUy5ta2RpcihwYXRoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH07CiAgICBjb25zdCBsaXN0RGlyID0gKHsgcGF0aCB9KSA9PiB7CiAgICAgICAgY29uc3QgbmFtZXMgPSBmZm1wZWcuRlMucmVhZGRpcihwYXRoKTsKICAgICAgICBjb25zdCBub2RlcyA9IFtdOwogICAgICAgIGZvciAoY29uc3QgbmFtZSBvZiBuYW1lcykgewogICAgICAgICAgICBjb25zdCBzdGF0ID0gZmZtcGVnLkZTLnN0YXQoYCR7cGF0aH0vJHtuYW1lfWApOwogICAgICAgICAgICBjb25zdCBpc0RpciA9IGZmbXBlZy5GUy5pc0RpcihzdGF0Lm1vZGUpOwogICAgICAgICAgICBub2Rlcy5wdXNoKHsgbmFtZSwgaXNEaXIgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBub2RlczsKICAgIH07CiAgICAvLyBUT0RPOiBjaGVjayBpZiBkZWxldGlvbiB3b3Jrcy4KICAgIGNvbnN0IGRlbGV0ZURpciA9ICh7IHBhdGggfSkgPT4gewogICAgICAgIGZmbXBlZy5GUy5ybWRpcihwYXRoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH07CiAgICBjb25zdCBtb3VudCA9ICh7IGZzVHlwZSwgb3B0aW9ucywgbW91bnRQb2ludCB9KSA9PiB7CiAgICAgICAgY29uc3Qgc3RyID0gZnNUeXBlOwogICAgICAgIGNvbnN0IGZzID0gZmZtcGVnLkZTLmZpbGVzeXN0ZW1zW3N0cl07CiAgICAgICAgaWYgKCFmcykKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGZmbXBlZy5GUy5tb3VudChmcywgb3B0aW9ucywgbW91bnRQb2ludCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9OwogICAgY29uc3QgdW5tb3VudCA9ICh7IG1vdW50UG9pbnQgfSkgPT4gewogICAgICAgIGZmbXBlZy5GUy51bm1vdW50KG1vdW50UG9pbnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfTsKICAgIHNlbGYub25tZXNzYWdlID0gYXN5bmMgKHsgZGF0YTogeyBpZCwgdHlwZSwgZGF0YTogX2RhdGEgfSwgfSkgPT4gewogICAgICAgIGNvbnN0IHRyYW5zID0gW107CiAgICAgICAgbGV0IGRhdGE7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHR5cGUgIT09IEZGTWVzc2FnZVR5cGUuTE9BRCAmJiAhZmZtcGVnKQogICAgICAgICAgICAgICAgdGhyb3cgRVJST1JfTk9UX0xPQURFRDsgLy8gZXNsaW50LWRpc2FibGUtbGluZQogICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgRkZNZXNzYWdlVHlwZS5MT0FEOgogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBhd2FpdCBsb2FkKF9kYXRhKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkZNZXNzYWdlVHlwZS5FWEVDOgogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBleGVjKF9kYXRhKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkZNZXNzYWdlVHlwZS5XUklURV9GSUxFOgogICAgICAgICAgICAgICAgICAgIGRhdGEgPSB3cml0ZUZpbGUoX2RhdGEpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBGRk1lc3NhZ2VUeXBlLlJFQURfRklMRToKICAgICAgICAgICAgICAgICAgICBkYXRhID0gcmVhZEZpbGUoX2RhdGEpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBGRk1lc3NhZ2VUeXBlLkRFTEVURV9GSUxFOgogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBkZWxldGVGaWxlKF9kYXRhKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkZNZXNzYWdlVHlwZS5SRU5BTUU6CiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHJlbmFtZShfZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEZGTWVzc2FnZVR5cGUuQ1JFQVRFX0RJUjoKICAgICAgICAgICAgICAgICAgICBkYXRhID0gY3JlYXRlRGlyKF9kYXRhKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkZNZXNzYWdlVHlwZS5MSVNUX0RJUjoKICAgICAgICAgICAgICAgICAgICBkYXRhID0gbGlzdERpcihfZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEZGTWVzc2FnZVR5cGUuREVMRVRFX0RJUjoKICAgICAgICAgICAgICAgICAgICBkYXRhID0gZGVsZXRlRGlyKF9kYXRhKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkZNZXNzYWdlVHlwZS5NT1VOVDoKICAgICAgICAgICAgICAgICAgICBkYXRhID0gbW91bnQoX2RhdGEpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBGRk1lc3NhZ2VUeXBlLlVOTU9VTlQ6CiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHVubW91bnQoX2RhdGEpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICB0aHJvdyBFUlJPUl9VTktOT1dOX01FU1NBR0VfVFlQRTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCAoZSkgewogICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgICAgIGlkLAogICAgICAgICAgICAgICAgdHlwZTogRkZNZXNzYWdlVHlwZS5FUlJPUiwKICAgICAgICAgICAgICAgIGRhdGE6IGUudG9TdHJpbmcoKSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7CiAgICAgICAgICAgIHRyYW5zLnB1c2goZGF0YS5idWZmZXIpOwogICAgICAgIH0KICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsgaWQsIHR5cGUsIGRhdGEgfSwgdHJhbnMpOwogICAgfTsKCn0pKCk7Cg==",Gn=s=>Uint8Array.from(atob(s),e=>e.charCodeAt(0)),Vn=URL.createObjectURL(new Blob([Gn(zn)],{type:"text/javascript"}));class jn{#t=null;#n={};#i={};#r=[];#o=[];loaded=!1;#a=()=>{this.#t&&(this.#t.onmessage=({data:{id:e,type:t,data:i}})=>{switch(t){case N.LOAD:this.loaded=!0,this.#n[e](i);break;case N.MOUNT:case N.UNMOUNT:case N.EXEC:case N.FFPROBE:case N.WRITE_FILE:case N.READ_FILE:case N.DELETE_FILE:case N.RENAME:case N.CREATE_DIR:case N.LIST_DIR:case N.DELETE_DIR:this.#n[e](i);break;case N.LOG:this.#r.forEach(n=>n(i));break;case N.PROGRESS:this.#o.forEach(n=>n(i));break;case N.ERROR:this.#i[e](i);break}delete this.#n[e],delete this.#i[e]})};#e=({type:e,data:t},i=[],n)=>this.#t?new Promise((r,o)=>{const a=Un();this.#t&&this.#t.postMessage({id:a,type:e,data:t},i),this.#n[a]=r,this.#i[a]=o,n?.addEventListener("abort",()=>{o(new DOMException(`Message # ${a} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(qn);on(e,t){e==="log"?this.#r.push(t):e==="progress"&&this.#o.push(t)}off(e,t){e==="log"?this.#r=this.#r.filter(i=>i!==t):e==="progress"&&(this.#o=this.#o.filter(i=>i!==t))}load=({classWorkerURL:e,...t}={},{signal:i}={})=>(this.#t||(this.#t=e?new Worker(new URL(e,Q&&Q.tagName.toUpperCase()==="SCRIPT"&&Q.src||new URL("__entry.js",document.baseURI).href),{type:"module"}):new Worker(new URL(Vn,Q&&Q.tagName.toUpperCase()==="SCRIPT"&&Q.src||new URL("__entry.js",document.baseURI).href),{type:"module"}),this.#a()),this.#e({type:N.LOAD,data:t},void 0,i));exec=(e,t=-1,{signal:i}={})=>this.#e({type:N.EXEC,data:{args:e,timeout:t}},void 0,i);ffprobe=(e,t=-1,{signal:i}={})=>this.#e({type:N.FFPROBE,data:{args:e,timeout:t}},void 0,i);terminate=()=>{const e=Object.keys(this.#i);for(const t of e)this.#i[t](Bn),delete this.#i[t],delete this.#n[t];this.#t&&(this.#t.terminate(),this.#t=null,this.loaded=!1)};writeFile=(e,t,{signal:i}={})=>{const n=[];return t instanceof Uint8Array&&n.push(t.buffer),this.#e({type:N.WRITE_FILE,data:{path:e,data:t}},n,i)};mount=(e,t,i)=>{const n=[];return this.#e({type:N.MOUNT,data:{fsType:e,options:t,mountPoint:i}},n)};unmount=e=>{const t=[];return this.#e({type:N.UNMOUNT,data:{mountPoint:e}},t)};readFile=(e,t="binary",{signal:i}={})=>this.#e({type:N.READ_FILE,data:{path:e,encoding:t}},void 0,i);deleteFile=(e,{signal:t}={})=>this.#e({type:N.DELETE_FILE,data:{path:e}},void 0,t);rename=(e,t,{signal:i}={})=>this.#e({type:N.RENAME,data:{oldPath:e,newPath:t}},void 0,i);createDir=(e,{signal:t}={})=>this.#e({type:N.CREATE_DIR,data:{path:e}},void 0,t);listDir=(e,{signal:t}={})=>this.#e({type:N.LIST_DIR,data:{path:e}},void 0,t);deleteDir=(e,{signal:t}={})=>this.#e({type:N.DELETE_DIR,data:{path:e}},void 0,t)}var it;(function(s){s.MEMFS="MEMFS",s.NODEFS="NODEFS",s.NODERAWFS="NODERAWFS",s.IDBFS="IDBFS",s.WORKERFS="WORKERFS",s.PROXYFS="PROXYFS"})(it||(it={}));const Fn=new Error("failed to get response body reader"),Hn=new Error("failed to complete download"),Wn="Content-Length",Zn=async(s,e)=>{const t=await fetch(s);let i;try{const n=parseInt(t.headers.get(Wn)||"-1"),r=t.body?.getReader();if(!r)throw Fn;const o=[];let a=0;for(;;){const{done:d,value:p}=await r.read(),u=p?p.length:0;if(d){if(n!=-1&&n!==a)throw Hn;e&&e({url:s,total:n,received:a,delta:u,done:d});break}o.push(p),a+=u,e&&e({url:s,total:n,received:a,delta:u,done:d})}const l=new Uint8Array(a);let c=0;for(const d of o)l.set(d,c),c+=d.length;i=l.buffer}catch(n){console.log("failed to send download progress event: ",n),i=await t.arrayBuffer()}return i},nt=async(s,e,t=!1,i)=>{const n=t?await Zn(s,i):await(await fetch(s)).arrayBuffer(),r=new Blob([n],{type:e});return URL.createObjectURL(r)};class Xn{coreURL;wasmURL;ffmpeg;size=0;maxSize=14e7;taskCount=0;reloadLock=!1;async init(){const e="https://unpkg.com/@ffmpeg/core@0.12.6/dist/esm";return this.coreURL=await nt(`${e}/ffmpeg-core.js`,"text/javascript"),this.wasmURL=await nt(`${e}/ffmpeg-core.wasm`,"application/wasm"),this.ffmpeg=new jn,await this.load(),this}async load(){await this.ffmpeg.load({coreURL:this.coreURL,wasmURL:this.wasmURL})}async check(){if(!this.coreURL||!this.wasmURL||!this.ffmpeg)throw new Error("FFmpegConvertor not init");if(this.size>this.maxSize){const e=this.reloadLock;if(await this.waitForTaskZero(),this.reloadLock)await this.waitForReloadLock();else{this.reloadLock=!0;try{A("info","FFmpegConvertor: size limit exceeded, terminate ffmpeg, verLock: ",e),this.ffmpeg.terminate(),await this.load(),this.size=0,this.taskCount=0}finally{this.reloadLock=!1}}}}async writeFiles(e,t){const i=this.ffmpeg;await Promise.all(e.map(async n=>{this.size+=n.data.byteLength,await i.writeFile(t+n.name,n.data)}))}async readOutputFile(e){const t=await this.ffmpeg.readFile(e);return this.size+=t.length,t}async convertTo(e,t,i){await this.check(),this.taskCount++;try{const n=this.ffmpeg,r=Math.random().toString(36).substring(7);await this.writeFiles(e,r);let o;i?o=i.map(p=>`file '${r}${p.file}'
duration ${p.delay/1e3}`).join(`
`):o=e.map(p=>`file '${r}${p.name}'
duration 0.04`).join(`
`),await n.writeFile(r+"meta.txt",o);let a,l;switch(t){case"GIF":a=r+"output.gif",l="image/gif",await n.exec(["-f","concat","-safe","0","-i",r+"meta.txt","-vf","split[a][b];[a]palettegen=stats_mode=diff[p];[b][p]paletteuse=dither=bayer:bayer_scale=2",a]);break;case"MP4":a=r+"output.mp4",l="video/mp4",await n.exec(["-f","concat","-safe","0","-i",r+"meta.txt","-c:v","h264","-pix_fmt","yuv420p",a]);break}const c=await this.readOutputFile(a),d=e.map(p=>n.deleteFile(r+p.name));return i&&d.push(n.deleteFile(r+"meta.txt")),d.push(n.deleteFile(a)),await Promise.all(d),new Blob([c],{type:l})}finally{this.taskCount--}}async waitForTaskZero(){for(;this.taskCount>0;)await new Promise(e=>setTimeout(e,100));await new Promise(e=>setTimeout(e,Math.random()*100+10))}async waitForReloadLock(){for(;this.reloadLock;)await new Promise(e=>setTimeout(e,100));await new Promise(e=>setTimeout(e,Math.random()*100+10))}}class Kn{homeData;thumbnails={};pids={};async fetchChapters(){const{error:e,body:t}=await window.fetch("https://www.pixiv.net/ajax/top/illust?mode=all&lang=en").then(o=>o.json());if(e)throw new Error("fetch your home data error, check you have already logged in");this.homeData=t,this.thumbnails=t.thumbnails.illust.reduce((o,a)=>(o[a.id]=a,o),{});const i=[],n=t.page.recommendByTag.reduce((o,a)=>(o[a.tag]=a.ids,o),{});this.pids={follow:t.page.follow.map(o=>o.toString()),"for you":t.page.recommend.ids,...n};let r=0;for(const[o,a]of Object.entries(this.pids))i.push(new O(r,o==="follow"?"Your Following":"Recommend "+o,o,this.thumbnails[a[0]??""]?.url)),r++;return i}async*next(e){const t=this.pids[e.source];if(t.length===0){yield I.ok([]);return}for(;t.length>0;){const n=t.splice(0,20).reduce((o,a)=>{const l=this.thumbnails[a]?.userId??"unk";return o[l]||(o[l]=[]),o[l].push(a),o},{}),r=Object.entries(n).map(([o,a])=>({id:o==="unk"?void 0:o,pids:a}));yield I.ok(r)}}title(){return"home"}}class Yn{artist;chapterPids=new Map;title(){return this.artist??"artist-unknown"}constructor(){h.conf.pixivRecordReading&&f.subscribe("ifq-do",(e,t)=>window.localStorage.setItem(`cl-${this.artist}-last-read`,t.node.href))}async fetchChapters(){if(this.artist=await this.findArtistID(),!this.artist)throw new Error("Cannot find artist id!");const e=await window.fetch(`https://www.pixiv.net/ajax/user/${this.artist}/profile/all`).then(l=>l.json()).catch(Error);if(e instanceof Error)throw e;if(e.error)throw new Error(`Fetch illust list error: ${e.message}`);let t=[...Object.keys(e.body.illusts),...Object.keys(e.body.manga)];t=t.sort((l,c)=>parseInt(c)-parseInt(l));const i=window.localStorage.getItem(`cl-${this.artist}-latest`);window.localStorage.setItem(`cl-${this.artist}-latest`,t[0]);const n=[],r=i?t.indexOf(i):-1;if(r>0){const l=new O(n.length+1,_.latestArtWorks,""),c=[...t.slice(0,r)];this.chapterPids.set(l.id,c),n.push(l)}const o=window.location.href.match(/artworks\/(\d+)$/)?.[1];if(o){const l=new O(n.length+1,_.currentArtWorks.get(),"");this.chapterPids.set(l.id,[o]),n.push(l)}if(h.conf.pixivRecordReading){const l=window.localStorage.getItem(`cl-${this.artist}-last-read`)?.match(/artworks\/(\d+)$/)?.[1],c=l?t.indexOf(l):-1;if(c>0&&c<t.length-1){const d=new O(n.length+1,h.conf.pixivAscendWorks?_.beforeLastReading.get():_.afterLastReading.get(),""),p=[...t.slice(c)];this.chapterPids.set(d.id,p),n.push(d);const u=new O(n.length+1,h.conf.pixivAscendWorks?_.afterLastReading.get():_.beforeLastReading.get(),""),g=[...t.slice(0,c+1)];this.chapterPids.set(u.id,g),n.push(u)}}const a=new O(n.length+1,_.allArtWorks.get(),"");return this.chapterPids.set(a.id,t),n.push(a),n}async*next(e){let t=this.chapterPids.get(e.id);if(!t)throw new Error("cannot get pid list of "+e.title);for(h.conf.pixivAscendWorks&&(t=t.reverse());t.length>0;){const i=t.splice(0,20);yield I.ok([{id:this.artist,pids:i}])}}async findArtistID(){let e=window.location.href;const t=/users\/(\d+)/.exec(e)?.[1];if(t)return t;const i=/artworks\/(\d+)/.exec(e)?.[1];if(i){if(e=document.querySelector("a[data-gtm-value][href*='/users/']")?.href||document.querySelector("a.user-details-icon[href*='/users/']")?.href,e){const n=/users\/(\d+)/.exec(e)?.[1];if(n)return n}return await window.fetch(`${window.location.origin}/ajax/illust/${i}?lang=en`).then(n=>n.json()).then(n=>n.body?.userId)}}}const rt=/\/(\d+)_([a-z]+)\d*\.\w*$/;class Jn extends R{api;meta;pageCount=0;works={};ugoiraMetas={};convertor;csrfToken;pidDatas=new Map;constructor(){super(),this.meta=new P(window.location.href,"UNTITLE"),/pixiv.net(\/en\/)?$/.test(window.location.href)?this.api=new Kn:this.api=new Yn}async processData(e,t,i){const n=this.ugoiraMetas[i.originSrc];if(!n)return[e,t];const r=new ee.ZipReader(new ee.Uint8ArrayReader(e)),o=performance.now();this.convertor||(this.convertor=await new Xn().init());const a=performance.now(),l=await r.getEntries().then(g=>g.map(m=>m.getData?.(new ee.Uint8ArrayWriter).then(b=>({name:m.filename,data:b})))),c=await Promise.all(l).then(g=>g.filter(m=>m&&m.data.length>0).map(m=>m)),d=performance.now();if(c.length!==n.body.frames.length)throw new Error("unpack ugoira file error: file count not equal to meta");const p=await this.convertor.convertTo(c,h.conf.pixivConvertTo,n.body.frames),u=performance.now();return A("debug",`convert ugoira to ${h.conf.pixivConvertTo}
init convertor cost: ${a-o}ms
unpack ugoira  cost: ${d-a}ms
ffmpeg convert cost: ${u-d}ms
total cost: ${(u-o)/1e3}s
size: ${p.size/1e3} KB, original size: ${e.byteLength/1e3} KB
before contentType: ${t}, after contentType: ${p.type}
`),p.arrayBuffer().then(g=>[new Uint8Array(g),p.type])}galleryMeta(){return this.meta.title=`pixiv_${this.api.title()}_w${Object.keys(this.works).length}_p${this.pageCount}`||"UNTITLE",this.meta.tags=Object.entries(this.works).reduce((e,t)=>(e[t[0]]=t[1].tags,e),{}),this.meta}async fetchTagsByPids(e,t){try{const n=await window.fetch(`https://www.pixiv.net/ajax/user/${e}/profile/illusts?ids[]=${t.join("&ids[]=")}&work_category=illustManga&is_first_page=0&lang=en`).then(r=>r.json());if(n.error)A("error","WARN: fetch tags by pids error: ",n.message);else{const r={};Object.entries(n.body.works).forEach(([o,a])=>{r[o]={id:a.id,title:a.title,alt:a.alt,illustType:a.illustType,description:a.description,tags:a.tags,pageCount:a.pageCount}}),this.works={...this.works,...r}}}catch(i){A("error","ERROR: fetch tags by pids error: ",i)}}fetchChapters(){return this.csrfToken=document.querySelector("#__NEXT_DATA__")?.textContent?.match(/\\"api\\":\{\\"token\\":\\"(\w+)\\"/)?.[1],this.api.fetchChapters()}fetchPagesSource(e){return this.api.next(e)}async fetchPidAndData(e){const t=e.filter(n=>!this.pidDatas.has(n)),i=await Te(t.map(n=>`https://www.pixiv.net/ajax/illust/${n}/pages?lang=en`),5,"json");for(let n=0;n<t.length;n++)this.pidDatas.set(t[n],i[n]);return e.map(n=>[n,this.pidDatas.get(n)])}async parseImgNodes(e){const t=[];if(e.length===0)return t;const i=[];for(const r of e)r.id&&this.fetchTagsByPids(r.id,r.pids),i.push(...r.pids);if(i.length===0)return t;h.conf.pixivAscendWorks?i.sort((r,o)=>parseInt(r)-parseInt(o)):i.sort((r,o)=>parseInt(o)-parseInt(r));const n=await this.fetchPidAndData(i);for(let r=0;r<n.length;r++){const[o,a]=n[r];if(!a||a instanceof Error||a.error){const u=`pid:[${o}], ${a?.message}`;A("error",u),f.emit("notify-message","error",u,8e3);continue}const l=new se("\u263A","like this illust",async()=>{this.csrfToken?await fetch("https://www.pixiv.net/ajax/illusts/like",{headers:{"content-type":"application/json; charset=utf-8","x-csrf-token":this.csrfToken},body:'{"illust_id":"'+o+'"}',method:"POST",mode:"cors"}):f.emit("notify-message","error","cannot find csrf_token from this page")}),c=new se("\u2665","bookmark this illust",async()=>{this.csrfToken?await fetch("https://www.pixiv.net/ajax/illusts/bookmarks/add",{credentials:"include",headers:{"content-type":"application/json; charset=utf-8","x-csrf-token":this.csrfToken},body:'{"illust_id":"'+o+'","restrict":0,"comment":"","tags":[]}',method:"POST",mode:"cors"}):f.emit("notify-message","error","cannot find csrf_token from this page")});this.pageCount+=a.body.length;const d=a.body.length.toString().length;let p=-1;for(const u of a.body){let g=u.urls.original.split("/").pop()||`${o}_p${p.toString().padStart(d)}.jpg`;const m=u.urls.original.match(rt);m&&m.length>2&&m[2]&&m[2]==="ugoira"&&(g=g.replace(/\.\w+$/,".gif")),p++;const b=new k(this.changeImageServer(u.urls.small),`${window.location.origin}/artworks/${o}`,g,void 0,this.changeImageServer(u.urls.original),{w:u.width,h:u.height});b.actions.push(l),b.actions.push(c),t.push(b)}}return t}async fetchOriginMeta(e){const t=e.originSrc.match(rt);if(!t||t.length<2)return{url:e.originSrc};const i=t[1],n=t[2];if(this.works[i]?.illustType===2||n==="ugoira"){const r=await window.fetch(`https://www.pixiv.net/ajax/illust/${i}/ugoira_meta?lang=en`).then(a=>a.json()),o=this.changeImageServer(r.body.src);return this.ugoiraMetas[o]=r,{url:o}}else return{url:e.originSrc}}changeImageServer(e){let t=h.conf.pixivImageServer;return t?(t.startsWith("http")||(t="https://"+t),t.endsWith("/")||(t=t+"/"),e.replace(/https?:\/\/[\.\w]*\//,t)):e}}h.addSetup({name:"Pixiv",workURLs:[/pixiv.net\/(en\/)?(artworks\/.*|users\/.*|$)/],match:["https://www.pixiv.net/*"],constructor:()=>new Jn});const Qn=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class ot extends R{sprites=[];fetchedThumbnail=[];galleryId="";imgCount=0;galleryMeta(){const e=document.querySelector(".site-manga-info__title-text")?.textContent||"UNTITLE",t=new P(window.location.href,e);t.originTitle=e;const i=document.querySelectorAll("div.mdc-chip .site-tag-count"),n={};return i.forEach(r=>{const o=r.getAttribute("data-tag")?.trim().split(":");if(o===void 0||o.length===0)return;const a=o[0];n[a]===void 0&&(n[a]=[]),n[a].push(o[1].replaceAll('"',""))}),t.tags=n,t}async fetchOriginMeta(e){return{url:e.originSrc}}async parseImgNodes(e){const t=[],i=this.imgCount.toString().length;for(let n=e[0];n<e[1];n++){let r="",o;this.sprites[n]?o=this.fetchThumbnail(n):r=`https://rokuhentai.com/_images/page-thumbnails/${this.galleryId}/${n}.jpg`;const a=`https://rokuhentai.com/_images/pages/${this.galleryId}/${n}.jpg`;t.push(new k(r,a,n.toString().padStart(i,"0")+".jpg",o,a))}return t}async*fetchPagesSource(){const e=document,t=parseInt(e.querySelector(".mdc-typography--caption")?.textContent||"");if(isNaN(t))throw new Error("error: failed query image count!");this.imgCount=t,this.galleryId=window.location.href.split("/").pop();const i=Array.from(e.querySelectorAll(".mdc-layout-grid__cell .site-page-card__media"));for(const n of i){this.fetchedThumbnail.push(void 0);const r=parseInt(n.getAttribute("data-offset-x")||""),o=parseInt(n.getAttribute("data-offset-y")||""),a=parseInt(n.getAttribute("data-width")||""),l=parseInt(n.getAttribute("data-height")||"");if(isNaN(r)||isNaN(o)||isNaN(a)||isNaN(l)){this.sprites.push(void 0);continue}const c=n.getAttribute("data-src");this.sprites.push({src:c,pos:{x:r,y:o,width:a,height:l}})}for(let n=0;n<this.imgCount;n+=20)yield I.ok([n,Math.min(n+20,this.imgCount)])}async fetchThumbnail(e){if(this.fetchedThumbnail[e])return this.fetchedThumbnail[e];const t=this.sprites[e].src,i=[];for(let r=e;r<this.imgCount&&t===this.sprites[r]?.src;r++)i.push(this.sprites[r].pos);const n=await Qe(t,i);for(let r=e;r<e+n.length;r++)this.fetchedThumbnail[r]=n[r-e];return this.fetchedThumbnail[e]}async processData(e){return[e,"image/jpeg"]}}h.addSetup({name:"rokuhentai",workURLs:[/rokuhentai.com\/\w+$/],match:["https://rokuhentai.com/*"],constructor:()=>new ot});const er=Object.freeze(Object.defineProperty({__proto__:null,RokuHentaiMatcher:ot},Symbol.toStringTag,{value:"Module"})),tr=/background-image:\surl\(.*?(h.*\/).*?\)/;class ir extends R{async fetchOriginMeta(e){let t="";try{if(t=await window.fetch(e.href).then(o=>o.text()),!t)throw new Error("[text] is empty")}catch(o){throw new Error(`Fetch source page error, expected [text]\uFF01 ${o}`)}const r=new DOMParser().parseFromString(t,"text/html").querySelector(".actualmediactn > a")?.getAttribute("href");if(!r)throw new Error("Cannot Query Steam original Image URL");return{url:r}}async parseImgNodes(e){const t=[],i=await window.fetch(e).then(r=>r.text()).then(r=>new DOMParser().parseFromString(r,"text/html"));if(!i)throw new Error("warn: steam matcher failed to get document from source page!");const n=i.querySelectorAll(".profile_media_item");if(!n||n.length==0)throw new Error("warn: failed query image nodes!");for(const r of Array.from(n)){const o=tr.exec(r.innerHTML)?.[1];if(!o)throw new Error(`Cannot Match Steam Image URL, Content: ${r.innerHTML}`);const a=new k(o,r.getAttribute("href"),r.getAttribute("data-publishedfileid")+".jpg");t.push(a)}return t}async*fetchPagesSource(){let e=-1;document.querySelectorAll(".pagingPageLink").forEach(i=>{e=Number(i.textContent)});const t=new URL(window.location.href);if(t.searchParams.set("view","grid"),e===-1){const i=await window.fetch(t.href).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html")).catch(()=>null);if(!i)throw new Error("warn: steam matcher failed to get document from source page!");i.querySelectorAll(".pagingPageLink").forEach(n=>e=Number(n.textContent))}if(e>0)for(let i=1;i<=e;i++)t.searchParams.set("p",i.toString()),yield I.ok(t.href);else yield I.ok(t.href)}parseGalleryMeta(){const t=new URL(window.location.href).searchParams.get("appid");return new P(window.location.href,"steam-"+t||"all")}}h.addSetup({name:"Steam Screenshots",workURLs:[/steamcommunity.com\/id\/[^/]+\/screenshots.*/],match:["https://steamcommunity.com/*"],constructor:()=>new ir});const nr=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class rr{uuid=te();userID;fetchChapters(){return window.location.href.includes("/media")?[new O(1,"User Medias",window.location.href,"https://pbs.twimg.com/profile_images/1683899100922511378/5lY42eHs_bigger.jpg")]:[new O(0,"User Posts",window.location.href,"https://pbs.twimg.com/profile_images/1683899100922511378/5lY42eHs_bigger.jpg"),new O(1,"User Media",window.location.href,"https://pbs.twimg.com/profile_images/1683899100922511378/5lY42eHs_bigger.jpg")]}async next(e,t){if(this.userID||(this.userID=cr()),!this.userID)throw new Error("Cannot obatained User ID");let i="";if(e.id===0){const n=`{"userId":"${this.userID}","count":20,${t?'"cursor":"'+t+'",':""}"includePromotedContent":true,"withQuickPromoteEligibilityTweetFields":true,"withVoice":true}`;i=`${window.location.origin}/i/api/graphql/q6xj5bs0hapm9309hexA_g/UserTweets?variables=${encodeURIComponent(n)}&features=%7B%22rweb_video_screen_enabled%22%3Afalse%2C%22profile_label_improvements_pcf_label_in_post_enabled%22%3Atrue%2C%22rweb_tipjar_consumption_enabled%22%3Atrue%2C%22verified_phone_label_enabled%22%3Afalse%2C%22creator_subscriptions_tweet_preview_api_enabled%22%3Atrue%2C%22responsive_web_graphql_timeline_navigation_enabled%22%3Atrue%2C%22responsive_web_graphql_skip_user_profile_image_extensions_enabled%22%3Afalse%2C%22premium_content_api_read_enabled%22%3Afalse%2C%22communities_web_enable_tweet_community_results_fetch%22%3Atrue%2C%22c9s_tweet_anatomy_moderator_badge_enabled%22%3Atrue%2C%22responsive_web_grok_analyze_button_fetch_trends_enabled%22%3Afalse%2C%22responsive_web_grok_analyze_post_followups_enabled%22%3Atrue%2C%22responsive_web_jetfuel_frame%22%3Afalse%2C%22responsive_web_grok_share_attachment_enabled%22%3Atrue%2C%22articles_preview_enabled%22%3Atrue%2C%22responsive_web_edit_tweet_api_enabled%22%3Atrue%2C%22graphql_is_translatable_rweb_tweet_is_translatable_enabled%22%3Atrue%2C%22view_counts_everywhere_api_enabled%22%3Atrue%2C%22longform_notetweets_consumption_enabled%22%3Atrue%2C%22responsive_web_twitter_article_tweet_consumption_enabled%22%3Atrue%2C%22tweet_awards_web_tipping_enabled%22%3Afalse%2C%22responsive_web_grok_show_grok_translated_post%22%3Afalse%2C%22responsive_web_grok_analysis_button_from_backend%22%3Atrue%2C%22creator_subscriptions_quote_tweet_preview_enabled%22%3Afalse%2C%22freedom_of_speech_not_reach_fetch_enabled%22%3Atrue%2C%22standardized_nudges_misinfo%22%3Atrue%2C%22tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled%22%3Atrue%2C%22longform_notetweets_rich_text_read_enabled%22%3Atrue%2C%22longform_notetweets_inline_media_enabled%22%3Atrue%2C%22responsive_web_grok_image_annotation_enabled%22%3Atrue%2C%22responsive_web_enhance_cards_enabled%22%3Afalse%7D&fieldToggles=%7B%22withArticlePlainText%22%3Afalse%7D`}else{const n=`{"userId":"${this.userID}","count":20,${t?'"cursor":"'+t+'",':""}"includePromotedContent":false,"withClientEventToken":false,"withBirdwatchNotes":false,"withVoice":true,"withV2Timeline":true}`;i=`${window.location.origin}/i/api/graphql/aQQLnkexAl5z9ec_UgbEIA/UserMedia?variables=${encodeURIComponent(n)}&features=%7B%22rweb_tipjar_consumption_enabled%22%3Atrue%2C%22responsive_web_graphql_exclude_directive_enabled%22%3Atrue%2C%22verified_phone_label_enabled%22%3Afalse%2C%22creator_subscriptions_tweet_preview_api_enabled%22%3Atrue%2C%22responsive_web_graphql_timeline_navigation_enabled%22%3Atrue%2C%22responsive_web_graphql_skip_user_profile_image_extensions_enabled%22%3Afalse%2C%22communities_web_enable_tweet_community_results_fetch%22%3Atrue%2C%22c9s_tweet_anatomy_moderator_badge_enabled%22%3Atrue%2C%22articles_preview_enabled%22%3Atrue%2C%22tweetypie_unmention_optimization_enabled%22%3Atrue%2C%22responsive_web_edit_tweet_api_enabled%22%3Atrue%2C%22graphql_is_translatable_rweb_tweet_is_translatable_enabled%22%3Atrue%2C%22view_counts_everywhere_api_enabled%22%3Atrue%2C%22longform_notetweets_consumption_enabled%22%3Atrue%2C%22responsive_web_twitter_article_tweet_consumption_enabled%22%3Atrue%2C%22tweet_awards_web_tipping_enabled%22%3Afalse%2C%22creator_subscriptions_quote_tweet_preview_enabled%22%3Afalse%2C%22freedom_of_speech_not_reach_fetch_enabled%22%3Atrue%2C%22standardized_nudges_misinfo%22%3Atrue%2C%22tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled%22%3Atrue%2C%22tweet_with_visibility_results_prefer_gql_media_interstitial_enabled%22%3Atrue%2C%22rweb_video_timestamps_enabled%22%3Atrue%2C%22longform_notetweets_rich_text_read_enabled%22%3Atrue%2C%22longform_notetweets_inline_media_enabled%22%3Atrue%2C%22responsive_web_enhance_cards_enabled%22%3Afalse%7D&fieldToggles=%7B%22withArticlePlainText%22%3Afalse%7D`}try{const n=await window.fetch(i,{headers:de(this.uuid),signal:AbortSignal.timeout(1e4)}),r=await n.json();if(n.status!==200&&r?.errors?.[0].message)throw new Error(r?.errors?.[0].message);if(e.id===0){const a=r.data.user.result.timeline.timeline.instructions.find(d=>d.type==="TimelineAddEntries");if(!a)throw new Error("Not found TimelineAddEntries");const{items:l,cursor:c}=Oe(a);return[l,c]}else{const o=r.data.user.result.timeline_v2.timeline.instructions,a=[],l=o.find(p=>p.type==="TimelineAddToModule"),c=o.find(p=>p.type==="TimelineAddEntries");if(!c)throw new Error("Not found TimelineAddEntries");l&&l.moduleItems.forEach(p=>a.push(p.item)),a.length===0&&c.entries.find(u=>u.content.entryType==="TimelineTimelineModule")?.content?.items.forEach(u=>a.push(u.item));const d=c.entries.find(p=>p.content.entryType==="TimelineTimelineCursor"&&p.entryId.startsWith("cursor-bottom"))?.content?.value;return[a,d]}}catch(n){throw new Error(`twitter api query error: ${n}`)}}}class or{uuid=te();listID;fetchChapters(){return[new O(1,"User Medias",window.location.href)]}getListID(){return window.location.href.match(/i\/lists\/(\d+)$/)?.[1]}async next(e,t){if(this.listID||(this.listID=this.getListID()),!this.listID)throw new Error("Cannot obatained list ID");const i=`{"listId":"${this.listID}","count":20${t?',"cursor":"'+t+'"':""}}`,r=`${window.location.origin}/i/api/graphql/LSefrrxhpeX8HITbKfWz9g/ListLatestTweetsTimeline?variables=${encodeURIComponent(i)}&features=%7B%22rweb_video_screen_enabled%22%3Afalse%2C%22profile_label_improvements_pcf_label_in_post_enabled%22%3Atrue%2C%22rweb_tipjar_consumption_enabled%22%3Atrue%2C%22responsive_web_graphql_exclude_directive_enabled%22%3Atrue%2C%22verified_phone_label_enabled%22%3Afalse%2C%22creator_subscriptions_tweet_preview_api_enabled%22%3Atrue%2C%22responsive_web_graphql_timeline_navigation_enabled%22%3Atrue%2C%22responsive_web_graphql_skip_user_profile_image_extensions_enabled%22%3Afalse%2C%22premium_content_api_read_enabled%22%3Afalse%2C%22communities_web_enable_tweet_community_results_fetch%22%3Atrue%2C%22c9s_tweet_anatomy_moderator_badge_enabled%22%3Atrue%2C%22responsive_web_grok_analyze_button_fetch_trends_enabled%22%3Afalse%2C%22responsive_web_grok_analyze_post_followups_enabled%22%3Atrue%2C%22responsive_web_jetfuel_frame%22%3Afalse%2C%22responsive_web_grok_share_attachment_enabled%22%3Atrue%2C%22articles_preview_enabled%22%3Atrue%2C%22responsive_web_edit_tweet_api_enabled%22%3Atrue%2C%22graphql_is_translatable_rweb_tweet_is_translatable_enabled%22%3Atrue%2C%22view_counts_everywhere_api_enabled%22%3Atrue%2C%22longform_notetweets_consumption_enabled%22%3Atrue%2C%22responsive_web_twitter_article_tweet_consumption_enabled%22%3Atrue%2C%22tweet_awards_web_tipping_enabled%22%3Afalse%2C%22responsive_web_grok_show_grok_translated_post%22%3Afalse%2C%22responsive_web_grok_analysis_button_from_backend%22%3Atrue%2C%22creator_subscriptions_quote_tweet_preview_enabled%22%3Afalse%2C%22freedom_of_speech_not_reach_fetch_enabled%22%3Atrue%2C%22standardized_nudges_misinfo%22%3Atrue%2C%22tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled%22%3Atrue%2C%22longform_notetweets_rich_text_read_enabled%22%3Atrue%2C%22longform_notetweets_inline_media_enabled%22%3Atrue%2C%22responsive_web_grok_image_annotation_enabled%22%3Atrue%2C%22responsive_web_enhance_cards_enabled%22%3Afalse%7D`;try{const o=await window.fetch(r,{headers:de(this.uuid),signal:AbortSignal.timeout(1e4)}),a=await o.json();if(o.status!==200&&a?.errors?.[0].message)throw new Error(a?.errors?.[0].message);const c=a.data.list.tweets_timeline.timeline.instructions.find(u=>u.type==="TimelineAddEntries");if(!c)throw new Error("Not found TimelineAddEntries");const{items:d,cursor:p}=Oe(c);return[d,p]}catch(o){throw new Error(`twitter api query error: ${o}`)}}}class ar{uuid=te();seenTweetIds={1:[],2:[],3:[]};chapterCursors={1:void 0,2:void 0,3:void 0};myID;fetchChapters(){return[new O(1,"For you",window.location.href,"https://pbs.twimg.com/profile_images/1683899100922511378/5lY42eHs_bigger.jpg"),new O(2,"Following",window.location.href,"https://pbs.twimg.com/profile_images/1683899100922511378/5lY42eHs_bigger.jpg"),new O(3,"Your Likes",window.location.href,"https://pbs.twimg.com/profile_images/1683899100922511378/5lY42eHs_bigger.jpg")]}async next(e){const t=this.chapterCursors[e.id],i=this.seenTweetIds[e.id].map(a=>'"'+a+'"').join(","),n=de(this.uuid),[r,o]=(()=>{if(e.id===1){const a=`${window.location.origin}/i/api/graphql/ci_OQZ2k0rG0Ax_lXRiWVA/HomeTimeline`,c=`{"variables":{"count":20,${t?`"cursor":"${t}",`:""}"includePromotedContent":true,"latestControlAvailable":true,"requestContext":"launch","withCommunity":true,"seenTweetIds":[${i}]},"features":{"rweb_video_screen_enabled":false,"profile_label_improvements_pcf_label_in_post_enabled":true,"rweb_tipjar_consumption_enabled":true,"responsive_web_graphql_exclude_directive_enabled":true,"verified_phone_label_enabled":false,"creator_subscriptions_tweet_preview_api_enabled":true,"responsive_web_graphql_timeline_navigation_enabled":true,"responsive_web_graphql_skip_user_profile_image_extensions_enabled":false,"premium_content_api_read_enabled":false,"communities_web_enable_tweet_community_results_fetch":true,"c9s_tweet_anatomy_moderator_badge_enabled":true,"responsive_web_grok_analyze_button_fetch_trends_enabled":false,"responsive_web_grok_analyze_post_followups_enabled":true,"responsive_web_jetfuel_frame":false,"responsive_web_grok_share_attachment_enabled":true,"articles_preview_enabled":true,"responsive_web_edit_tweet_api_enabled":true,"graphql_is_translatable_rweb_tweet_is_translatable_enabled":true,"view_counts_everywhere_api_enabled":true,"longform_notetweets_consumption_enabled":true,"responsive_web_twitter_article_tweet_consumption_enabled":true,"tweet_awards_web_tipping_enabled":false,"responsive_web_grok_show_grok_translated_post":false,"responsive_web_grok_analysis_button_from_backend":true,"creator_subscriptions_quote_tweet_preview_enabled":false,"freedom_of_speech_not_reach_fetch_enabled":true,"standardized_nudges_misinfo":true,"tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled":true,"longform_notetweets_rich_text_read_enabled":true,"longform_notetweets_inline_media_enabled":true,"responsive_web_grok_image_annotation_enabled":true,"responsive_web_enhance_cards_enabled":false},"queryId":"ci_OQZ2k0rG0Ax_lXRiWVA"}`;return[a,c]}else if(e.id===2){const a=`${window.location.origin}/i/api/graphql/nMyTQqsJiUGBKLGNSQamAA/HomeLatestTimeline`,c=`{"variables":{"count":20,${t?`"cursor":"${t}",`:""}"includePromotedContent":true,"latestControlAvailable":true,"seenTweetIds":[${i}]},"features":{"rweb_video_screen_enabled":false,"profile_label_improvements_pcf_label_in_post_enabled":true,"rweb_tipjar_consumption_enabled":true,"responsive_web_graphql_exclude_directive_enabled":true,"verified_phone_label_enabled":false,"creator_subscriptions_tweet_preview_api_enabled":true,"responsive_web_graphql_timeline_navigation_enabled":true,"responsive_web_graphql_skip_user_profile_image_extensions_enabled":false,"premium_content_api_read_enabled":false,"communities_web_enable_tweet_community_results_fetch":true,"c9s_tweet_anatomy_moderator_badge_enabled":true,"responsive_web_grok_analyze_button_fetch_trends_enabled":false,"responsive_web_grok_analyze_post_followups_enabled":true,"responsive_web_jetfuel_frame":false,"responsive_web_grok_share_attachment_enabled":true,"articles_preview_enabled":true,"responsive_web_edit_tweet_api_enabled":true,"graphql_is_translatable_rweb_tweet_is_translatable_enabled":true,"view_counts_everywhere_api_enabled":true,"longform_notetweets_consumption_enabled":true,"responsive_web_twitter_article_tweet_consumption_enabled":true,"tweet_awards_web_tipping_enabled":false,"responsive_web_grok_show_grok_translated_post":false,"responsive_web_grok_analysis_button_from_backend":true,"creator_subscriptions_quote_tweet_preview_enabled":false,"freedom_of_speech_not_reach_fetch_enabled":true,"standardized_nudges_misinfo":true,"tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled":true,"longform_notetweets_rich_text_read_enabled":true,"longform_notetweets_inline_media_enabled":true,"responsive_web_grok_image_annotation_enabled":true,"responsive_web_enhance_cards_enabled":false},"queryId":"nMyTQqsJiUGBKLGNSQamAA"}`;return[a,c]}else{if(this.myID||(this.myID=lr()),!this.myID)throw new Error("cannot find my id from current page");const a=t?`"cursor":"${t}",`:"",l=`{"userId":"${this.myID}","count":20,${a}"includePromotedContent":false,"withClientEventToken":false,"withBirdwatchNotes":false,"withVoice":true}`;return[`${window.location.origin}/i/api/graphql/uxjTlmrTI61zreSIV1urbw/Likes?variables=${encodeURIComponent(l)}&features=%7B%22rweb_video_screen_enabled%22%3Afalse%2C%22profile_label_improvements_pcf_label_in_post_enabled%22%3Atrue%2C%22rweb_tipjar_consumption_enabled%22%3Atrue%2C%22responsive_web_graphql_exclude_directive_enabled%22%3Atrue%2C%22verified_phone_label_enabled%22%3Afalse%2C%22creator_subscriptions_tweet_preview_api_enabled%22%3Atrue%2C%22responsive_web_graphql_timeline_navigation_enabled%22%3Atrue%2C%22responsive_web_graphql_skip_user_profile_image_extensions_enabled%22%3Afalse%2C%22premium_content_api_read_enabled%22%3Afalse%2C%22communities_web_enable_tweet_community_results_fetch%22%3Atrue%2C%22c9s_tweet_anatomy_moderator_badge_enabled%22%3Atrue%2C%22responsive_web_grok_analyze_button_fetch_trends_enabled%22%3Afalse%2C%22responsive_web_grok_analyze_post_followups_enabled%22%3Atrue%2C%22responsive_web_jetfuel_frame%22%3Afalse%2C%22responsive_web_grok_share_attachment_enabled%22%3Atrue%2C%22articles_preview_enabled%22%3Atrue%2C%22responsive_web_edit_tweet_api_enabled%22%3Atrue%2C%22graphql_is_translatable_rweb_tweet_is_translatable_enabled%22%3Atrue%2C%22view_counts_everywhere_api_enabled%22%3Atrue%2C%22longform_notetweets_consumption_enabled%22%3Atrue%2C%22responsive_web_twitter_article_tweet_consumption_enabled%22%3Atrue%2C%22tweet_awards_web_tipping_enabled%22%3Afalse%2C%22responsive_web_grok_show_grok_translated_post%22%3Afalse%2C%22responsive_web_grok_analysis_button_from_backend%22%3Atrue%2C%22creator_subscriptions_quote_tweet_preview_enabled%22%3Afalse%2C%22freedom_of_speech_not_reach_fetch_enabled%22%3Atrue%2C%22standardized_nudges_misinfo%22%3Atrue%2C%22tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled%22%3Atrue%2C%22longform_notetweets_rich_text_read_enabled%22%3Atrue%2C%22longform_notetweets_inline_media_enabled%22%3Atrue%2C%22responsive_web_grok_image_annotation_enabled%22%3Atrue%2C%22responsive_web_enhance_cards_enabled%22%3Afalse%7D&fieldToggles=%7B%22withArticlePlainText%22%3Afalse%7D`,""]}})();try{const a={};n.forEach((b,y)=>{a[y]=b});const l=await new Promise((b,y)=>{ue({method:o?"POST":"GET",url:r,headers:a,data:o||void 0,timeout:2e4,onload:w=>b(w.response),ontimeout:()=>y("timeout"),onerror:w=>y(w)})}),c=JSON.parse(l);if(c?.errors?.[0].message)throw new Error(c?.errors?.[0].message);const p=(()=>{if(e.id===3){if(c?.data?.user?.result?.timeline_v2?.timeline?.instructions)return c.data.user.result.timeline_v2.timeline.instructions;if(c?.data?.user?.result?.timeline?.timeline?.instructions)return c.data.user.result.timeline.timeline.instructions;throw new Error("cannot found: json?.data?.user?.result?.timeline_v2?.timeline?.instructions")}else{if(!c?.data?.home?.home_timeline_urt?.instructions)throw new Error("cannot found: json?.data?.home?.home_timeline_urt?.instructions");return c.data.home.home_timeline_urt.instructions}})().find(b=>b.type==="TimelineAddEntries");if(!p)throw new Error("Not found TimelineAddEntries");const{items:u,ids:g,cursor:m}=Oe(p);return this.seenTweetIds[e.id]=g,this.chapterCursors[e.id]=m,[u,m]}catch(a){throw new Error(`twitter api query error: ${a}`)}}}class sr extends R{postCount=0;mediaCount=0;api;uuid=te();constructor(){super(),/\/home$/.test(window.location.href)?this.api=new ar:/i\/lists\/\d+$/.test(window.location.href)?this.api=new or:this.api=new rr}async fetchChapters(){return this.api.fetchChapters()}async*fetchPagesSource(e){let t;for(;;)try{const[i,n]=await this.api.next(e,t);if(t=n||"last",!i||i.length===0||(yield I.ok(i),!n))break}catch(i){yield I.err(i)}}async parseImgNodes(e){if(!e)throw new Error("warn: cannot find items");const t=[];for(const i of e){const n=i?.itemContent?.tweet_results?.result?.legacy||i?.itemContent?.tweet_results?.result?.tweet?.legacy||i?.itemContent?.tweet_results?.result?.legacy?.retweeted_status_result?.result?.legacy,r=n?.entities.media;if(r===void 0){const c=i.itemContent?.tweet_results?.result?.core?.user_results?.result?.legacy?.name,d=i.itemContent.tweet_results.result.rest_id;A("error",`cannot found mediaList: ${window.location.origin}/${c}/status/${d}`,i);continue}const o=n?.id_str,a=new se("\u2665","like this tweet",async()=>{await fetch("https://x.com/i/api/graphql/lI07N6Otwv1PhnEgXILM7A/FavoriteTweet",{headers:de(this.uuid),body:'{"variables":{"tweet_id":"'+o+'"},"queryId":"lI07N6Otwv1PhnEgXILM7A"}',method:"POST",mode:"cors"})}),l=new se("\u{1F516}","bookmark this tweet",async()=>{await fetch("https://x.com/i/api/graphql/aoDbu3RHznuiSkQ9aNM67Q/CreateBookmark",{headers:de(this.uuid),body:'{"variables":{"tweet_id":"'+o+'"},"queryId":"aoDbu3RHznuiSkQ9aNM67Q"}',method:"POST",mode:"cors"})});this.postCount++,h.conf.reverseMultipleImagesPost&&r.reverse();for(let c=0;c<r.length;c++){const d=r[c];if(h.conf.excludeVideo&&d.type==="video")continue;if(d.type!=="video"&&d.type!=="photo"&&d.type!=="animated_gif"){A("error",`Not supported media type: ${d.type}`);continue}const p=d.media_url_https.split(".").pop(),u=d.media_url_https.replace(`.${p}`,""),g=`${u}?format=${p}&name=${d.sizes.small?"small":"thumb"}`;let m=d.expanded_url.replace(/\/(photo|video)\/\d+/,"");m=`${m}/${d.type==="video"?"video":"photo"}/${c+1}`;const b=`${u}?format=${p}&name=${d.sizes.large?"large":d.sizes.medium?"medium":"small"}`,y=`${d.id_str}-${u.split("/").pop()}.${p}`,w={w:d.sizes.small.w,h:d.sizes.small.h},C=new k(g,m,y,void 0,b,w);if(C.actions.push(a),C.actions.push(l),d.video_info){let E=0;for(const T of d.video_info.variants)T.bitrate!==void 0&&T.bitrate>=E&&(E=T.bitrate,C.originSrc=T.url,C.mimeType=T.content_type,C.title=C.title.replace(/\.\w+$/,`.${T.content_type.split("/")[1]}`))}t.push(C),this.mediaCount++}}return t}async fetchOriginMeta(e){return{url:e.originSrc}}galleryMeta(){const e=window.location.href.match(/(twitter|x).com\/(\w+)\/?/)?.[2];return new P(window.location.href,`twitter-${e||document.title}-${this.postCount}-${this.mediaCount}`)}}function lr(){return Array.from(document.querySelectorAll("script")).find(s=>s.innerText.startsWith("window.__INITIAL_STATE__"))?.innerText.match(/"id_str":\s?"(\d+)"/)?.[1]}function cr(){const s=window.location.href.match(/(twitter|x).com\/(\w+)\/?/)?.[2]||"lililjiliijili",e=Array.from(document.querySelectorAll("button[data-testid][aria-label]"));return e.length===0?void 0:(e.find(i=>(i.getAttribute("aria-label")??"").toLowerCase().includes(`@${s.toLowerCase()}`))||e[0]).getAttribute("data-testid").match(/(\d+)/)?.[1]}function de(s){const e=new Headers;e.set("authorization","Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA"),e.set("Pragma","no-cache"),e.set("Cache-Control","no-cache"),e.set("content-type","application/json"),e.set("x-client-uuid",s),e.set("x-twitter-auth-type","OAuth2Session"),e.set("x-twitter-client-language","en"),e.set("x-twitter-active-user","yes"),e.set("x-client-transaction-id",Ce()),e.set("Sec-Fetch-Dest","empty"),e.set("Sec-Fetch-Mode","cors"),e.set("Sec-Fetch-Site","same-origin");const t=document.cookie.match(/ct0=(\w+)/)?.[1];if(!t)throw new Error("Not found csrfToken");return e.set("x-csrf-token",t),e}function Oe(s){const e=[],t=[];let i;for(const n of s.entries)n.content.entryType==="TimelineTimelineItem"&&!n.entryId.startsWith("promoted-")?(e.push(n.content),n.content.itemContent.tweet_results.result.legacy?.id_str&&t.push(n.content.itemContent.tweet_results.result.legacy.id_str),n.content.itemContent.tweet_results.result.legacy?.retweeted_status_result?.result?.legacy?.id_str&&t.push(n.content.itemContent.tweet_results.result.legacy?.retweeted_status_result?.result?.legacy?.id_str)):n.content.entryType==="TimelineTimelineModule"&&n.content.displayType==="VerticalConversation"?n.content.items.forEach(r=>{e.push(r.item),r.item.itemContent.tweet_results.result.legacy?.id_str&&t.push(r.item.itemContent.tweet_results.result.legacy?.id_str),r.item.itemContent.tweet_results.result.legacy?.retweeted_status_result?.result?.legacy?.id_str&&t.push(r.item.itemContent.tweet_results.result.legacy?.retweeted_status_result?.result?.legacy?.id_str)}):n.content.entryType==="TimelineTimelineCursor"&&n.entryId.startsWith("cursor-bottom")&&(i=n.content.value);return{items:e,ids:t,cursor:i}}h.addSetup({name:"Twitter | X",workURLs:[/(\/x|twitter).com\/(?!(explore|notifications|messages|jobs|lists)$|i\/(?!list)|search\?)\w+/],match:["https://x.com/*"],constructor:()=>new sr});const dr=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class hr extends R{meta;baseURL;galleryURL;async*fetchPagesSource(){const e=this.extractIDFromHref(window.location.href);if(!e)throw new Error("Cannot find gallery ID");this.baseURL=`${window.location.origin}/photos-index-page-1-aid-${e}.html`,this.galleryURL=`${window.location.origin}/photos-gallery-aid-${e}.html`;let t=await window.fetch(this.baseURL).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html"));this.meta=this.pasrseGalleryMeta(t);let i=await this.requestGalleryImages(this.galleryURL);yield I.ok(i)}async parseImgNodes(e){const t=[];for(let i=0;i<e.length;i++){const n=e[i];let r=new k("",n.url,n.caption,void 0,n.url);t.push(r)}return t}async fetchOriginMeta(e){const t=e.originSrc??e.thumbnailSrc,i=t.includes(".")?t.split(".").pop():"jpg",n=e.title.replace("[","").replace("]","")+"."+i;return{url:t,title:n}}galleryMeta(e){return this.meta||super.galleryMeta(e)}extractIDFromHref(e){const t=e.match(/-(\d+).html$/);if(t)return t[1]}pasrseGalleryMeta(e){const t=e.querySelector("#bodywrap > h2")?.textContent||"unknown",i=new P(this.baseURL||window.location.href,t),n=Array.from(e.querySelectorAll(".asTB .tagshow")).map(o=>o.textContent).filter(Boolean),r=Array.from(e.querySelector(".asTB > .asTBcell.uwconn > p")?.childNodes||[]).map(o=>o.textContent).filter(Boolean);return i.tags={tags:n,description:r},i}async requestGalleryImages(e){const t=await window.fetch(e).then(n=>n.text());let i="";for(let n of t.split(`
`))n=n.replace('document.writeln("',""),n=n.replace('");',""),n.includes("var imglist")&&(n=n.replace("var imglist = ",""),n=n.replaceAll("fast_img_host+\\",""),n=n.replaceAll("\\",""),i+=n);return this.extractUrlsAndCaptions(i)}extractUrlsAndCaptions(e){const t=/url:\s*"(.*?)",\s*caption:\s*"(.*?)"/gs;let i;const n=[];for(;(i=t.exec(e))!==null;)n.push({url:i[1],caption:i[2]});return n.length>0&&n[n.length-1].caption.includes("\u52A0\u5165\u6536\u85CF")&&n.pop(),n}}h.addSetup({name:"\u7EC5\u58EB\u6F2B\u753B",workURLs:[/(wnacg.com|wn\d{2}.cc)\/photos-index/],match:["https://www.wnacg.com/*"],constructor:()=>new hr});const pr=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class ur extends R{meta;title(){return this.meta?.title??document.title}galleryMeta(){return this.meta}async*fetchPagesSource(){const e=await this.query(window.location.href+"/read",'{"page":1}');if(e.props?.pages?.data?.list){const t=e.props?.pages?.data;yield I.ok(t)}else throw new Error("cannot fetch pages")}async parseImgNodes(e){const t=this.buildList(e);if(t.length===0)throw new Error("cannot build list from gallery data");const i=Math.ceil(e.count/20),n=await this.query(window.location.href,`{"page":${i}}`),r=n.props?.post?.data?.page_list;if(!r)throw new Error("cannot fetch thumbnails");const o=n.props?.post?.data;o&&(this.meta=this.buildGalleryMeta(o));const a=[];for(let l=0;l<t.length;l++){const c=t[l],d=r[l];a.push(new k(d,c.url,`${c.name}.${c.ext}`,void 0,c.url))}return a}async fetchOriginMeta(e){return{url:e.originSrc}}buildGalleryMeta(e){const t=new P(e.url,e.name);return t.originTitle=e.alt_name,t.tags={flag:[e.flag],category:[e.category],date:[e.date],...e.tags},t}buildList(e){const t=e.list,i=[];for(let n=0;n<e.count;n++){const r=parseInt(t.head[n])-1,o=t.head[n].padStart(4,"0"),a="".concat(t.root,"/").concat(t.code.toString(),"/").concat(o,"-").concat(t.hash[n],"-").concat(t.rand[n],".").concat(t.type[n]);i[r]={url:a,name:o,ext:t.type[n]}}return i}async query(e,t){const i=document.cookie.match(/XSRF-TOKEN=(.*)?;?/)?.[1];if(!i)throw new Error("cannot get csrf token form cookie");return await(await window.fetch(e,{headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-Inertia":"true","X-Inertia-Version":Ce(),"X-XSRF-TOKEN":decodeURIComponent(i)},body:t,method:"POST"})).json()}}h.addSetup({name:"Yabai.si",workURLs:[/yabai.si\/g\/\w+\/?$/],match:["https://yabai.si/*"],constructor:()=>new ur});const gr=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),mr=/Post\.register\((.*)\)/g;class fr extends R{infos={};count=0;async*fetchPagesSource(){let e=document;yield I.ok(e);let t=0;for(;;){const i=e.querySelector("#paginator a.next_page")?.href;if(!i)break;try{e=await window.fetch(i).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html"))}catch(n){if(t++,t>3)throw new Error(`fetch next page failed, ${n}`);continue}t=0,yield I.ok(e)}}async parseImgNodes(e){const t=e.querySelector("body > form + script")?.textContent;if(!t)throw new Error("cannot find post list from script");const i=t.matchAll(mr),n=[];for(const r of i)if(!(!r||r.length<2))try{const o=JSON.parse(r[1]);this.infos[o.id.toString()]=o,this.count++,n.push(new k(o.preview_url,`${window.location.origin}/post/show/${o.id}`,`${o.id}.${o.file_ext}`,void 0,void 0,{w:o.width,h:o.height}))}catch(o){A("error","parse post info failed",o);continue}return n}async fetchOriginMeta(e){const t=e.href.split("/").pop();if(!t)throw new Error(`cannot find id from ${e.href}`);let i;if(h.conf.fetchOriginal?i=this.infos[t]?.file_url:i=this.infos[t]?.sample_url,!i)throw new Error(`cannot find url for id ${t}`);return{url:i}}galleryMeta(){const t=new URL(window.location.href).searchParams.get("tags")?.trim(),i=new P(window.location.href,`yande_${t||"post"}_${this.count}`);return i.infos=this.infos,i}}h.addSetup({name:"yande.re",workURLs:[/yande.re\/post(?!\/show\/.*)/],match:["https://yande.re/*"],constructor:()=>new fr});const br=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class wr{crc=-1;table=this.makeTable();makeTable(){let e,t,i;const n=[];for(e=0;e<256;e++){for(i=e,t=0;t<8;t++)i=i&1?i>>>1^3988292384:i>>>1;n[e]=i}return n}append(e){let t=this.crc|0;const i=this.table;for(let n=0,r=e.length|0;n<r;n++)t=t>>>8^i[(t^e[n])&255];this.crc=t}get(){return~this.crc}}class vr{level;nameBuf;comment;header;offset;directory;file;crc;compressedLength;uncompressedLength;volumeNo;constructor(e,t){this.level=0;const i=new TextEncoder;this.nameBuf=i.encode(e.name.trim()),this.comment=i.encode(""),this.header=new we(26),this.offset=0,this.directory=!1,this.file=e,this.crc=new wr,this.compressedLength=0,this.uncompressedLength=0,this.volumeNo=t}}class we{array;view;constructor(e){const t=new Uint8Array(e);this.array=t,this.view=new DataView(t.buffer)}}class yr{volumeSize=1610612736;accumulatedSize=0;volumes=1;currVolumeNo=-1;files=[];currIndex=-1;offset=0;offsetInVolume=0;curr;date;writer;close=!1;constructor(e){e?.volumeSize&&(this.volumeSize=e.volumeSize),this.date=new Date(Date.now()),this.writer=async()=>{}}setWriter(e){this.writer=e}add(e){const t=e.size();this.accumulatedSize+=t,this.accumulatedSize>this.volumeSize&&(this.volumes++,this.accumulatedSize=t),this.files.push(new vr(e,this.volumes-1))}async next(){if(this.currIndex++,this.curr=this.files[this.currIndex],this.curr){if(this.curr.volumeNo>this.currVolumeNo)return this.currIndex--,this.offsetInVolume=0,!0;this.curr.offset=this.offsetInVolume,await this.writeHeader(),await this.writeContent(),await this.writeFooter(),this.offset+=this.offsetInVolume-this.curr.offset}else if(!this.close)this.close=!0,await this.closeZip();else return!0;return!1}async writeHeader(){if(!this.curr)return;const e=this.curr,t=new we(30+e.nameBuf.length),i=e.header;e.level!==0&&!e.directory&&i.view.setUint16(4,2048),i.view.setUint32(0,335546376),i.view.setUint16(6,(this.date.getHours()<<6|this.date.getMinutes())<<5|this.date.getSeconds()/2,!0),i.view.setUint16(8,(this.date.getFullYear()-1980<<4|this.date.getMonth()+1)<<5|this.date.getDate(),!0),i.view.setUint16(22,e.nameBuf.length,!0),t.view.setUint32(0,1347093252),t.array.set(i.array,4),t.array.set(e.nameBuf,30),this.offsetInVolume+=t.array.length,await this.writer(t.array)}async writeContent(){const e=this.curr,t=(await e.file.stream()).getReader(),i=this.writer;async function n(){const r=await t.read();if(r.done)return;const o=r.value;return e.crc.append(o),e.uncompressedLength+=o.length,e.compressedLength+=o.length,i(o),await n()}await n()}async writeFooter(){if(!this.curr)return;const e=this.curr,t=new we(16);t.view.setUint32(0,1347094280),e.crc&&(e.header.view.setUint32(10,e.crc.get(),!0),e.header.view.setUint32(14,e.compressedLength,!0),e.header.view.setUint32(18,e.uncompressedLength,!0),t.view.setUint32(4,e.crc.get(),!0),t.view.setUint32(8,e.compressedLength,!0),t.view.setUint32(12,e.uncompressedLength,!0)),await this.writer(t.array),this.offsetInVolume+=e.compressedLength+16,e.compressedLength!==e.file.size()&&A("error","WRAN: read length:",e.compressedLength," origin size:",e.file.size(),", title: ",e.file.name)}async closeZip(){const e=this.files.length;let t=0,i=0;for(i=0;i<e;i++){const o=this.files[i];t+=46+o.nameBuf.length+o.comment.length}const n=new we(t+22);let r=0;for(i=0;i<e;i++){const o=this.files[i];n.view.setUint32(r,1347092738),n.view.setUint16(r+4,5120),n.array.set(o.header.array,r+6),n.view.setUint16(r+32,o.comment.length,!0),n.view.setUint16(r+34,o.volumeNo,!0),n.view.setUint32(r+42,o.offset,!0),n.array.set(o.nameBuf,r+46),n.array.set(o.comment,r+46+o.nameBuf.length),r+=46+o.nameBuf.length+o.comment.length}n.view.setUint32(r,1347093766),n.view.setUint16(r+4,this.currVolumeNo,!0),n.view.setUint16(r+6,this.currVolumeNo,!0),n.view.setUint16(r+8,e,!0),n.view.setUint16(r+10,e,!0),n.view.setUint32(r+12,t,!0),n.view.setUint32(r+16,this.offsetInVolume,!0),await this.writer(n.array)}nextReadableStream(){if(this.currVolumeNo++,this.currVolumeNo>=this.volumes)return;const e=this;return new ReadableStream({start(t){e.setWriter(async i=>t.enqueue(i))},async pull(t){await e.next().then(i=>i&&t.close())}})}}class _r{canvas;mousemoveState;ctx;queue;rectSize;rectGap;columns;padding;scrollTop;scrollSize;debouncer;onClick;cherryPick;constructor(e,t,i){if(this.queue=t,this.cherryPick=i,!e)throw new Error("canvas not found");this.canvas=e,this.canvas.addEventListener("wheel",n=>this.onwheel(n.deltaY)),this.mousemoveState={x:0,y:0},this.canvas.addEventListener("mousemove",n=>{this.mousemoveState={x:n.offsetX,y:n.offsetY},this.drawDebouce()}),this.canvas.addEventListener("click",n=>{this.mousemoveState={x:n.offsetX,y:n.offsetY};const r=this.computeDrawList()?.find(o=>o.selected)?.index;r!==void 0&&f.emit("downloader-canvas-on-click",r)}),this.ctx=this.canvas.getContext("2d"),this.rectSize=12,this.rectGap=6,this.columns=15,this.padding=7,this.scrollTop=0,this.scrollSize=10,this.debouncer=new W,f.subscribe("imf-download-state-change",()=>this.drawDebouce()),f.subscribe("downloader-canvas-resize",()=>this.resize())}resize(e){e=e||this.canvas.parentElement,this.canvas.width=Math.floor(e.offsetWidth),this.canvas.height=Math.floor(e.offsetHeight),this.columns=Math.ceil((this.canvas.width-this.padding*2-this.rectGap)/(this.rectSize+this.rectGap)),this.draw()}onwheel(e){const[t,i]=this.getWH(),n=this.computeClientHeight();n>i&&(e=e>>1,this.scrollTop+=e,this.scrollTop<0&&(this.scrollTop=0),this.scrollTop+i>n+20&&(this.scrollTop=n-i+20),this.draw())}drawDebouce(){this.debouncer.addEvent("DOWNLOADER-DRAW",()=>this.draw(),20)}computeDrawList(){const e=[],t=this.cherryPick(),[i,n]=this.getWH(),r=this.computeStartX(),o=-this.scrollTop+this.padding;for(let a=0,l=-1;a<this.queue.length;a++){const c=a%this.columns;c==0&&l++;const d=r+(this.rectSize+this.rectGap)*c,p=o+(this.rectSize+this.rectGap)*l;if(!(p+this.rectSize<0)){if(p>n)break;e.push({index:a,x:d,y:p,selected:this.isSelected(d,p),disabled:!t.picked(a)})}}return e}draw(){const[e,t]=this.getWH();this.ctx.clearRect(0,0,e,t);const i=this.computeDrawList();for(const n of i)this.drawSmallRect(n.x,n.y,this.queue[n.index],n.index===this.queue.currIndex,n.selected,n.disabled)}computeClientHeight(){return Math.ceil(this.queue.length/this.columns)*(this.rectSize+this.rectGap)-this.rectGap}scrollTo(e){const t=this.computeClientHeight(),[i,n]=this.getWH();if(t<=n)return;const o=(Math.ceil((e+1)/this.columns)-1)*(this.rectSize+this.rectGap);if(o>n){this.scrollTop=o+this.rectSize-n;const a=t-n+20;this.scrollTop+20<=a&&(this.scrollTop+=20)}}isSelected(e,t){return this.mousemoveState.x-e>=0&&this.mousemoveState.x-e<=this.rectSize&&this.mousemoveState.y-t>=0&&this.mousemoveState.y-t<=this.rectSize}computeStartX(){const[e,t]=this.getWH(),i=(this.rectSize+this.rectGap)*this.columns-this.rectGap;return e-i>>1}drawSmallRect(e,t,i,n,r,o){if(o)this.ctx.fillStyle="rgba(20, 20, 20, 1)";else switch(i.stage){case z.FAILED:this.ctx.fillStyle="rgba(250, 50, 20, 0.9)";break;case z.URL:this.ctx.fillStyle="rgba(200, 200, 200, 0.6)";break;case z.DATA:const a=i.downloadState.loaded/i.downloadState.total;this.ctx.fillStyle=`rgba(${200+Math.ceil(-90*a)}, ${200+Math.ceil(0*a)}, ${200+Math.ceil(-80*a)}, ${.6+Math.ceil((1-.6)*a)})`;break;case z.DONE:this.ctx.fillStyle="rgb(110, 200, 120)";break}this.ctx.fillRect(e,t,this.rectSize,this.rectSize),this.ctx.shadowColor="#d53",r?(this.ctx.strokeStyle="rgb(60, 20, 200)",this.ctx.lineWidth=2):n?(this.ctx.strokeStyle="rgb(255, 60, 20)",this.ctx.lineWidth=2):(this.ctx.strokeStyle="rgb(90, 90, 90)",this.ctx.lineWidth=1),this.ctx.strokeRect(e,t,this.rectSize,this.rectSize)}getWH(){return[this.canvas.width,this.canvas.height]}}const he=/[\\/:*?"<>|\n\t]/g;class Cr{meta;title;downloading;queue;idleLoader;pageFetcher;done=!1;selectedChapters=[];filenames=new Set;panel;canvas;cherryPicks=[new F];constructor(e,t,i,n,r){this.panel=e.downloader,this.panel.initTabs(),this.initEvents(this.panel),this.panel.initCherryPick((o,a)=>{this.cherryPicks[o]===void 0&&(this.cherryPicks[o]=new F);const l=this.cherryPicks[o].add(a);return f.emit("cherry-pick-changed",o,this.cherryPicks[o]),l},(o,a)=>{this.cherryPicks[o]===void 0&&(this.cherryPicks[o]=new F);const l=this.cherryPicks[o].remove(a);return f.emit("cherry-pick-changed",o,this.cherryPicks[o]),l},o=>{this.cherryPicks[o]===void 0&&(this.cherryPicks[o]=new F),this.cherryPicks[o].reset(),f.emit("cherry-pick-changed",o,this.cherryPicks[o])},o=>(this.cherryPicks[o]===void 0&&(this.cherryPicks[o]=new F),this.cherryPicks[o].values)),this.panel.initNotice([{btn:_.resetDownloaded.get(),cb:()=>{confirm(_.resetDownloadedConfirm.get())&&this.queue.forEach(o=>o.stage===z.DONE&&o.resetStage())}},{btn:_.resetFailed.get(),cb:()=>{this.queue.forEach(o=>o.stage===z.FAILED&&o.resetStage()),this.downloading||this.idleLoader.abort(0,100)}}]),this.queue=t,this.queue.cherryPick=()=>this.cherryPicks[this.queue.chapterIndex]||new F,this.idleLoader=i,this.idleLoader.cherryPick=()=>this.cherryPicks[this.queue.chapterIndex]||new F,this.canvas=new _r(this.panel.canvas,t,()=>this.cherryPicks[this.queue.chapterIndex]||new F),this.pageFetcher=n,this.meta=o=>r.galleryMeta(o),this.title=o=>r.title(o),this.downloading=!1,this.queue.downloading=()=>this.downloading,f.subscribe("ifq-on-finished-report",(o,a)=>{if(a.isFinished()){const l=this.selectedChapters.find(c=>c.index===a.chapterIndex);l&&(l.done=!0,l.resolve(!0)),!this.downloading&&!this.done&&this.panel.noticeableBTN()}}),f.subscribe("imf-check-picked",(o,a)=>this.cherryPicks[o]?.picked(a))}initEvents(e){e.forceBTN.addEventListener("click",()=>this.download(this.pageFetcher.chapters)),e.startBTN.addEventListener("click",()=>{this.downloading?this.abort("downloadStart"):this.start()})}needNumberTitle(e){if(h.conf.filenameOrder==="numbers")return!0;if(h.conf.filenameOrder==="original")return!1;let t;h.conf.filenameOrder==="alphabetically"?t=(n,r)=>n<r:t=(n,r)=>n.localeCompare(r,void 0,{numeric:!0,sensitivity:"base"})<0;let i="";for(const n of e){if(i&&t(n.node.title,i))return!0;i=n.node.title}return!1}check(){this.downloading||(setTimeout(()=>f.emit("downloader-canvas-resize"),110),this.panel.createChapterSelectList(this.pageFetcher.chapters,this.selectedChapters),this.queue.length>0?this.panel.switchTab("status"):this.pageFetcher.chapters.length>1&&this.panel.switchTab("chapters"))}checkSelectedChapters(){this.selectedChapters.length=0;const e=this.panel.selectedChapters();return e.size===0?this.selectedChapters.push({index:this.pageFetcher.chapterIndex,done:!1,...st()}):this.pageFetcher.chapters.forEach((t,i)=>e.has(t.id)&&this.selectedChapters.push({index:i,done:!1,...st()})),this.selectedChapters}async start(){if(!this.downloading){this.panel.flushUI("downloading"),this.downloading=!0,this.idleLoader.autoLoad=!0,this.checkSelectedChapters();try{for(const e of this.selectedChapters){if(!this.downloading)return;await this.pageFetcher.restoreChapter(e.index),this.queue.forEach(t=>t.stage===z.FAILED&&t.resetStage()),this.queue.isFinished()?(e.done=!0,e.resolve(!0)):(this.idleLoader.processingIndexList=this.queue.map((t,i)=>!t.lock&&t.stage===z.URL?i:-1).filter(t=>t>=0).splice(0,h.conf.downloadThreads),this.idleLoader.onFailed(()=>e.reject("download failed or canceled")),this.idleLoader.checkProcessingIndex(),this.idleLoader.start()),await e.promise}this.downloading&&await this.download(this.selectedChapters.filter(e=>e.done).map(e=>this.pageFetcher.chapters[e.index]))}catch(e){if(e==="abort")return;this.abort("downloadFailed"),A("error","download failed: ",e)}finally{this.downloading=!1}}}mapToFileLikes(e,t,i){if(!e||e.filteredQueue.length===0)return[];let n;if(this.needNumberTitle(e.filteredQueue)){const l=e.filteredQueue.length.toString().length;h.conf.filenameOrder==="numbers"?n=(c,d)=>`${d+1}`.padStart(l,"0")+"."+c.split(".").pop():n=(c,d)=>`${d+1}`.padStart(l,"0")+"_"+c.replaceAll(he,"_")}else this.filenames.clear(),n=l=>De(this.filenames,l.replaceAll(he,"_"));const o=e.filteredQueue.filter((l,c)=>t.picked(c)&&l.stage===z.DONE&&l.data).map((l,c)=>({stream:()=>Promise.resolve(at(l.data)),size:()=>l.data.byteLength,name:i+n(l.node.title,c)})),a=new TextEncoder().encode(JSON.stringify(this.meta(e),null,2));return o.push({stream:()=>Promise.resolve(at(a)),size:()=>a.byteLength,name:i+"meta.json"}),o}async download(e){try{const t=this.title(e).replaceAll(he,"_"),i=navigator.userAgent.indexOf("Win")!==-1?"\\":"/",n=e.length===1;this.panel.flushUI("packaging");const r=new Set,o=[];for(let c=0;c<e.length;c++){const d=e[c],p=this.cherryPicks[c]||new F;let u=n?"":d.title instanceof Array?d.title.join("_").replaceAll(he,"_").replaceAll(/\s+/g," ")+i:d.title.replaceAll(he,"_").replaceAll(/\s+/g," ")+i;u=xr(u,200),u=De(r,u);const g=this.mapToFileLikes(d,p,u);o.push(...g)}const a=new yr({volumeSize:1024*1024*(h.conf.archiveVolumeSize||1500)});o.forEach(c=>a.add(c)),await(async()=>{let c;for(;c=a.nextReadableStream();){const d=await new Response(c).blob(),p=a.currVolumeNo===a.volumes-1?"zip":"z"+(a.currVolumeNo+1).toString().padStart(2,"0");St.saveAs(d,`${t}.${p}`)}})(),this.done=!0}catch(t){let i=t.toString();throw i.includes("autoAllocateChunkSize")&&(i="Create Zip archive prevented by The content security policy of this page. Please refer to the CONF > Help for a solution."),f.emit("notify-message","error",`packaging failed, ${i}`),t}finally{this.abort(this.done?"downloaded":"downloadFailed")}}abort(e){this.downloading=!1,this.panel.abort(e),this.idleLoader.abort(),this.selectedChapters.forEach(t=>t.reject("abort"))}}function xr(s,e){const t=new TextEncoder,i=a=>t.encode(a).byteLength,n=i(s);if(n<=e)return s;const r=[s.length>>1,(s.length>>1)+1];let o=!0;for(;;){if(n-i(s.slice(...r))<=e)return s.slice(0,r[0])+",,,"+s.slice(r[1]);if(o&&r[0]>3){r[0]-=1,o=!1;continue}if(r[1]<s.length-3){r[1]+=1,o=!0;continue}break}return s.slice(0,e)}function De(s,e){let t=e;if(s.has(t)){const i=t.split("."),n=i.pop(),r=i.join("."),o=parseInt(r.match(/_(\d+)$/)?.[1]||"");return isNaN(o)?t=`${r}_1.${n}`:t=`${r.replace(/\d+$/,(o+1).toString())}.${n}`,De(s,t)}else return s.add(t),t}function at(s){return new ReadableStream({pull(e){e.enqueue(s),e.close()}})}function st(){let s,e;const t=new Promise((i,n)=>{s=i,e=n});return{resolve:s,reject:e,promise:t}}class F{values=[];positive=!1;sieve=[];reset(){this.values=[],this.positive=!1,this.sieve=[]}add(e){if(this.values.length===0)return this.positive=e.positive,this.values.push(e),this.setSieve(e),this.values;if(this.values.find(l=>l.id===e.id))return null;const i=e.range(),n=new Set,r=new Set,o=[];let a=!1;for(let l=0;l<this.values.length;l++){const c=this.values[l],d=c.range();if(i[0]>=d[0]&&i[1]<=d[1]){e.positive!==this.positive&&(n.add(c.id),d[0]<i[0]&&o.push(new G([d[0],i[0]-1],c.positive)),d[1]>i[1]&&o.push(new G([i[1]+1,d[1]],c.positive)),a=i[0]===i[1]&&i[0]===d[0]&&i[1]===d[1]);break}i[0]<=d[0]&&i[1]>=d[1]?n.add(c.id):i[0]<=d[0]&&i[1]>=d[0]&&i[1]<=d[1]?c.reset([i[1]+1,d[1]]):i[0]>=d[0]&&i[0]<=d[1]&&i[1]>=d[1]&&c.reset([d[0],i[0]-1]),e.positive===this.positive&&(r.has(e.id)||(r.add(e.id),o.push(e)))}if(n.size>0&&(this.values=this.values.filter(l=>!n.has(l.id))),o.length>0&&this.values.push(...o),this.values.length===0){if(this.reset(),a)return this.values;this.positive=e.positive,this.values.push(e)}else this.concat();return this.setSieve(e),this.values}setSieve(e){const t=e.range();for(let i=t[0]-1;i<t[1];i++)this.sieve[i]=e.positive===this.positive}concat(){if(this.values.length<2)return;this.values.sort((n,r)=>n.range()[0]-r.range()[0]);let e=0,t=1;const i=[];for(;e<this.values.length&&t<this.values.length;){const n=this.values[e],r=this.values[t],o=n.range(),a=r.range();if(o[1]+1===a[0])n.reset([o[0],a[1]]),i.push(t),t++;else{do e++;while(i.includes(e));t=e+1}}this.values=this.values.filter((n,r)=>!i.includes(r))}remove(e){const t=this.values.findIndex(r=>r.id===e);if(t===-1)return;const n=this.values.splice(t,1)[0].range();for(let r=n[0]-1;r<n[1];r++)this.sieve[r]=!1;this.values.length===0&&(this.sieve=[],this.positive=!1)}picked(e){return!!(this.positive?this.sieve[e]:!this.sieve[e])}}class G{value;positive;id;constructor(e,t){this.positive=t,this.value=e.sort((i,n)=>i-n),this.id=G.rangeToString(this.value,this.positive)}toString(){return G.rangeToString(this.value,this.positive)}reset(e){this.value=e.sort((t,i)=>t-i),this.id=G.rangeToString(this.value,this.positive)}range(){return this.value}static rangeToString(e,t){let i="";return e[0]===e[1]?i=e[0].toString():i=e.map(n=>n.toString()).join("-"),t?i:"!"+i}static from(e){if(e=e?.trim(),!e)return null;e=e.replace(/!+/,"!");const t=e.startsWith("!");if(/^!?\d+$/.test(e)){const i=parseInt(e.replace("!",""));return new G([i,i],!t)}if(/^!?\d+-\d+$/.test(e)){const i=e.replace("!","").split("-").map(n=>parseInt(n));return new G([i[0],i[1]],!t)}return null}}class Ue extends Array{executableQueue;currIndex;finishedIndex=new Set;debouncer;downloading;dataSize=0;chapterIndex=0;cherryPick;clear(){this.length=0,this.executableQueue=[],this.currIndex=0,this.finishedIndex.clear()}restore(e,t){this.clear(),this.chapterIndex=e,t.forEach((i,n)=>i.stage===z.DONE&&this.finishedIndex.add(n)),this.push(...t)}static newQueue(){const e=new Ue;return f.subscribe("imf-on-finished",(t,i,n)=>e.chapterIndex===n.chapterIndex&&e.finishedReport(t,i,n)),f.subscribe("ifq-do",(t,i,n)=>{i.chapterIndex===e.chapterIndex&&e.do(t,n)}),f.subscribe("pf-change-chapter",()=>e.forEach(t=>t.unrender())),f.subscribe("add-cherry-pick-range",(t,i,n,r)=>{t===e.chapterIndex&&(n||e[i]?.stage===z.DATA&&(e[i].abort(),e[i].stage=z.URL))}),e}constructor(){super(),this.executableQueue=[],this.currIndex=0,this.debouncer=new W}isFinished(){const e=this.cherryPick?.(this.chapterIndex);if(e&&e.values.length>0){for(let t=0;t<this.length;t++)if(e.picked(t)&&!this.finishedIndex.has(t))return!1;return!0}else return this.finishedIndex.size===this.length}do(e,t){t=t||"next",this.currIndex=this.fixIndex(e),f.emit("ifq-on-do",this.currIndex,this,this.downloading?.()||!1),!this.downloading?.()&&this.pushInExecutableQueue(t)&&this.debouncer.addEvent("IFQ-EXECUTABLE",()=>{console.log("IFQ-EXECUTABLE: ",this.executableQueue),Promise.all(this.executableQueue.splice(0,h.conf.paginationIMGCount).map(i=>this[i].start())).then(()=>{const i=this.cherryPick?.(this.chapterIndex);this.executableQueue.filter(n=>!i||i.picked(n)).forEach(n=>this[n].start())})},300)}finishedReport(e,t,i){this.length!==0&&(!t||i.stage!==z.DONE||(this.finishedIndex.add(e),this.dataSize<1e9&&(this.dataSize+=i.data?.byteLength||0),f.emit("ifq-on-finished-report",e,this)))}fixIndex(e){return e<0?0:e>this.length-1?this.length-1:e}pushInExecutableQueue(e){this.executableQueue=[];for(let t=0,i=this.currIndex;this.checkOutbounds(i,e,t);e==="next"?++i:--i)this[i].stage!==z.DONE&&(this.executableQueue.push(i),t++);return this.executableQueue.length>0}checkOutbounds(e,t,i){let n=!1;return t==="next"&&(n=e<this.length),t==="prev"&&(n=e>-1),n?i<h.conf.threads+h.conf.paginationIMGCount-1:!1}findImgIndex(e){for(let t=0;t<this.length;t++)if(this[t].node.equal(e))return t;return 0}}class Ir{queue;processingIndexList;restartId;maxWaitMS;minWaitMS;onFailedCallback;autoLoad=!1;debouncer;cherryPick;constructor(e){this.queue=e,this.processingIndexList=[0],this.maxWaitMS=1e3,this.minWaitMS=300,this.autoLoad=h.conf.autoLoad,this.debouncer=new W,f.subscribe("ifq-on-do",(t,i,n)=>!n&&this.abort(t)),f.subscribe("imf-on-finished",t=>{this.processingIndexList.includes(t)&&this.wait().then(()=>{this.checkProcessingIndex(),this.start()})}),f.subscribe("pf-change-chapter",t=>!this.queue.downloading?.()&&this.abort(t>0?0:void 0)),window.addEventListener("focus",()=>{h.conf.autoLoadInBackground||this.debouncer.addEvent("Idle-Load-on-focus",()=>{console.log("[ IdleLoader ] window focus, document.hidden:",document.hidden),!document.hidden&&this.abort(0,10)},100)}),f.subscribe("pf-on-appended",(t,i,n,r)=>{r||this.processingIndexList.length>0||this.abort(this.queue.currIndex,100)})}onFailed(e){this.onFailedCallback=e}start(){if(this.autoLoad&&!(document.hidden&&!h.conf.autoLoadInBackground)&&this.processingIndexList.length!==0&&this.queue.length!==0){A("info","Idle Loader start at:"+this.processingIndexList.toString());for(const e of this.processingIndexList)this.queue[e].start()}}checkProcessingIndex(){if(this.queue.length===0)return;const e=this.cherryPick?.()||new F,t=new Set;let i=!1;for(let n=0;n<this.processingIndexList.length;n++){const r=this.processingIndexList[n],o=this.queue[r];if(o.stage===z.FAILED&&(i=!0),!(o.lock||o.stage===z.URL)){for(let a=Math.min(r+1,this.queue.length-1),l=this.queue.length;a<l;a++){if(e.picked(a)){const c=this.queue[a];if(!c.lock&&c.stage===z.URL&&!t.has(a)){t.add(a),this.processingIndexList[n]=a;break}c.stage===z.FAILED&&(i=!0)}a>=this.queue.length-1&&(l=r,a=0)}if(t.size===0){this.processingIndexList.length=0,i&&this.onFailedCallback&&(this.onFailedCallback(),this.onFailedCallback=void 0);return}}}}async wait(){const{maxWaitMS:e,minWaitMS:t}=this;return new Promise(function(i){const n=Math.floor(Math.random()*e+t);window.setTimeout(()=>i(!0),n)})}abort(e,t){this.processingIndexList=[],this.debouncer.addEvent("IDLE-LOAD-ABORT",()=>{this.autoLoad&&e!==void 0&&(this.queue.downloading?.()||(this.processingIndexList=[e],this.checkProcessingIndex(),this.start()))},t||h.conf.restartIdleLoader)}}function re(s){const e=[];if(s.ctrlKey&&e.push("ctrl"),s.shiftKey&&e.push("shift"),s.altKey&&e.push("alt"),s.metaKey&&e.push("meta"),s instanceof KeyboardEvent){let t=s.key;t===" "&&(t="space"),e.push(t)}if(s instanceof MouseEvent){let t="m"+s.button;e.push(t)}return e.join("+").toLowerCase()}function pe(s,e,t,i){const n=e.getBoundingClientRect();let r=n.left+n.width/2-s.offsetWidth/2;r=Math.min(r,t-s.offsetWidth),r=Math.max(r,0),s.style.left=r+"px",n.top>i/2?(s.style.bottom=i-n.top+"px",s.style.top="unset"):(s.style.top=n.bottom+"px",s.style.bottom="unset")}function Ar(s,e,t){const i=document.createElement("div");i.style.position="fixed",i.style.lineHeight="2em",i.id="input-element",i.innerHTML='<input type="text" style="width:20em;height:2em;"><button class="ehvp-custom-btn ehvp-custom-btn-plain">&nbsp\u221A&nbsp</button>',s.appendChild(i);const n=i.querySelector("input");i.querySelector("button").addEventListener("click",()=>{t(n.value),i.remove()}),pe(i,e,s.offsetWidth,s.offsetHeight)}function qe(s,e,t){const i=s.map(n=>`<div><span style="user-select: text;">${n}</span><span class="ehvp-custom-btn ehvp-custom-btn-plain" data-value="${n}">&nbspx&nbsp</span></div>`);e.innerHTML=i.join(""),Array.from(e.querySelectorAll("div > span + span")).forEach(n=>{n.addEventListener("click",()=>{t(n.getAttribute("data-value")),n.parentElement.remove()})})}function Sr(s,e){const t=h.matchers,i=t.map(a=>{const l=a.name,c=Ae(l),d="id-"+xe(l).replaceAll(/[+=\/]/g,"-");return`<li data-index="${d}" class="ehvp-custom-panel-list-item">
             <div class="ehvp-custom-panel-list-item-title">
               <div style="font-size: 1.2em;font-weight: 800;">${l}</div>
               <div>
                 <label class="ehvp-custom-panel-checkbox"><span>${_.enable.get()}: </span><input id="${d}-enable-checkbox" ${c.enable??!0?"checked":""} type="checkbox"></label>
                 <label class="ehvp-custom-panel-checkbox"><span>${_.addRegexp.get()}: </span><span id="${d}-add-workurl" class="ehvp-custom-btn ehvp-custom-btn-green">&nbsp+&nbsp</span></label>
               </div>
             </div>
             <div id="${d}-workurls"></div>
           </li>`}),n=`
<div class="ehvp-custom-panel">
  <div class="ehvp-custom-panel-title">
    <span>
      <span>${_.showSiteProfiles.get()}</span>
      <span style="font-size:0.5em;">
        <span class="p-tooltip"> ${_.enable.get()}? <span class="p-tooltiptext">${_.enableTooltips.get()}</span></span>
        <span class="p-tooltip"> ${_.enableAutoOpen.get()}? <span class="p-tooltiptext">${_.enableAutoOpenTooltips.get()}</span></span>
        <span class="p-tooltip"> ${_.enableFlowVision.get()}? <span class="p-tooltiptext">${_.enableFlowVisionTooltips.get()}</span></span>
      </span>
    </span>
    <span id="ehvp-custom-panel-close" class="ehvp-custom-panel-close">\u2716</span>
  </div>
  <div class="ehvp-custom-panel-container">
    <div class="ehvp-custom-panel-content">
      <ul class="ehvp-custom-panel-list">
      ${i.join("")}
      </ul>
    </div>
  </div>
</div>
`,r=document.createElement("div");r.classList.add("ehvp-full-panel"),r.innerHTML=n;const o=()=>{r.remove(),e?.()};r.addEventListener("click",a=>{a.target.classList.contains("ehvp-full-panel")&&o()}),s.appendChild(r),r.querySelector(".ehvp-custom-panel-close").addEventListener("click",o),t.forEach(a=>{const l=a.name,c="id-"+xe(l).replaceAll(/[+=\/]/g,"-"),d=a.workURLs.map(y=>y.source),p=()=>Ae(l),u=v(`#${c}-enable-checkbox`,r);u.addEventListener("click",()=>{q({enable:u.checked})});const g=v(`#${c}-add-workurl`,r),m=v(`#${c}-workurls`,r),b=(y,w)=>{const C=w.workURLs?.indexOf(y)??-1;let E=!1;C>-1&&(w.workURLs.splice(C,1),E=!0),(w.workURLs?.length??0)===0&&(w.workURLs=void 0,E=!0,qe(d,m,T=>{b(T,p())})),E&&q({workURLs:w.workURLs},a.name)};g.addEventListener("click",()=>{const y=document.createElement("div");y.addEventListener("click",w=>w.target===y&&y.remove()),y.setAttribute("style","position:absolute;width:100%;height:100%;"),r.appendChild(y),Ar(y,g,w=>{if(!w)return;try{new RegExp(w)}catch{return}y.remove();const C=p();C.workURLs||(C.workURLs=[...d]),C.workURLs.push(w),q({workURLs:C.workURLs},a.name),qe(C.workURLs,m,E=>{b(E,p())})})}),qe(p().workURLs??d,m,y=>{b(y,p())})}),r.querySelectorAll(".p-tooltip").forEach(a=>{const l=a.querySelector(".p-tooltiptext");l&&(a.addEventListener("mouseenter",()=>{l.style.display="block",pe(l,a,s.offsetWidth,s.offsetHeight)}),a.addEventListener("mouseleave",()=>l.style.display="none"))})}function kr(s,e){const t=`
<div class="ehvp-custom-panel">
  <div class="ehvp-custom-panel-title">
    <span>${_.showHelp.get()}</span>
    <span id="ehvp-custom-panel-close" class="ehvp-custom-panel-close">\u2716</span>
  </div>
  <div class="ehvp-custom-panel-container ehvp-help-panel">
    <div class="ehvp-custom-panel-content">${_.help.get()}</div>
  </div>
</div>
`,i=document.createElement("div");i.classList.add("ehvp-full-panel"),i.innerHTML=t;const n=()=>{i.remove(),e?.()};i.addEventListener("click",r=>{r.target.classList.contains("ehvp-full-panel")&&n()}),s.appendChild(i),i.querySelector(".ehvp-custom-panel-close").addEventListener("click",n)}function Er(s,e,t){function i(a,l,c,d){const p=`<span data-id="${c}" data-key="${d}" class="ehvp-custom-panel-item-value"><span>${d}</span><span class="ehvp-custom-btn ehvp-custom-btn-plain" style="padding:0;border:none;">&nbspx&nbsp</span></span>`,u=document.createElement("div");u.innerHTML=p;const g=u.firstElementChild;a.before(g),g.querySelector(".ehvp-custom-btn").addEventListener("click",m=>{const b=h.conf.keyboards[l][c];if(b&&b.length>0){const w=b.indexOf(d);w!==-1&&b.splice(w,1),b.length===0&&delete h.conf.keyboards[l][c],q({keyboards:h.conf.keyboards})}m.target.parentElement.remove(),Array.from(a.parentElement.querySelectorAll(".ehvp-custom-panel-item-value")).length===0&&s[l][c].defaultKeys.forEach(C=>i(a,l,c,C))}),u.remove()}const n=`
<div class="ehvp-custom-panel">
  <div class="ehvp-custom-panel-title">
    <span>${_.showKeyboard.get()}</span>
    <span id="ehvp-custom-panel-close" class="ehvp-custom-panel-close">\u2716</span>
  </div>
  <div class="ehvp-custom-panel-container">
    <div class="ehvp-custom-panel-content">
      ${Object.entries(s.inMain).map(([a])=>`
        <div class="ehvp-custom-panel-item">
         <div class="ehvp-custom-panel-item-title">
           <span>${_.keyboard[a].get()}</span>
         </div>
         <div class="ehvp-custom-panel-item-values">
           <!-- wait element created from button event -->
           <button class="ehvp-add-keyboard-btn ehvp-custom-btn ehvp-custom-btn-green" style="margin-left: 0.2em;" data-cate="inMain" data-id="${a}">+</button>
         </div>
        </div>
      `).join("")}
    </div>
    <div class="ehvp-custom-panel-content">
      ${Object.entries(s.inFullViewGrid).map(([a])=>`
        <div class="ehvp-custom-panel-item">
         <div class="ehvp-custom-panel-item-title">
           <span>${_.keyboard[a].get()}</span>
         </div>
         <div class="ehvp-custom-panel-item-values">
           <!-- wait element created from button event -->
           <button class="ehvp-add-keyboard-btn ehvp-custom-btn ehvp-custom-btn-green" style="margin-left: 0.2em;" data-cate="inFullViewGrid" data-id="${a}">+</button>
         </div>
        </div>
      `).join("")}
    </div>
    <div class="ehvp-custom-panel-content">
      ${Object.entries(s.inBigImageMode).map(([a])=>`
        <div class="ehvp-custom-panel-item">
         <div class="ehvp-custom-panel-item-title">
           <span>${_.keyboard[a].get()}</span>
         </div>
         <div class="ehvp-custom-panel-item-values">
           <!-- wait element created from button event -->
           <button class="ehvp-add-keyboard-btn ehvp-custom-btn ehvp-custom-btn-green" style="margin-left: 0.2em;display:inline-block;" data-cate="inBigImageMode" data-id="${a}">+</button>
         </div>
        </div>
      `).join("")}
    </div>
  </div>
</div>
`,r=document.createElement("div");r.classList.add("ehvp-full-panel"),r.innerHTML=n;const o=()=>{r.remove(),t?.()};r.addEventListener("click",a=>{a.target.classList.contains("ehvp-full-panel")&&o()}),e.appendChild(r),r.querySelector(".ehvp-custom-panel-close").addEventListener("click",o),r.querySelectorAll(".ehvp-add-keyboard-btn").forEach(a=>{const l=a.getAttribute("data-cate"),c=a.getAttribute("data-id");let d=h.conf.keyboards[l][c];(d===void 0||d.length===0)&&(d=s[l][c].defaultKeys),d.forEach(u=>i(a,l,c,u));const p=u=>{if(u.preventDefault(),u instanceof KeyboardEvent){const m=u.key.toLowerCase();if(m==="alt"||m==="shift"||m==="control"||m==="meta")return}const g=re(u);h.conf.keyboards[l][c]!==void 0?h.conf.keyboards[l][c].push(g):h.conf.keyboards[l][c]=d.concat(g),q({keyboards:h.conf.keyboards}),i(a,l,c,g),a.textContent="+",a.removeAttribute("d-pressing"),a.removeEventListener("keyup",p),a.removeEventListener("mouseup",p)};a.addEventListener("click",u=>{u.preventDefault(),a.textContent="Press Key",a.setAttribute("d-pressing",""),a.addEventListener("keyup",p,{once:!1}),a.addEventListener("mouseup",p,{once:!1})}),a.addEventListener("mouseleave",()=>{a.textContent="+",a.removeAttribute("d-pressing"),a.removeEventListener("keyup",p),a.removeEventListener("mouseup",p)})})}const Be={moonViewCeremony:"<\u{1F391}>",zoomIcon:"\u21F1\u21F2"};function ve(){const s=lt();return`
<div class="b-main" style="flex-direction:row;">
  <a class="b-main-item s-pickable" data-key="entry">${s.entry}</a>
  <a class="b-main-item s-pickable" data-key="collapse">${s.collapse}</a>
  <div class="b-main-item">
      <a class="" style="color:#ffc005;">1</a><span id="p-slash-1">/</span><span id="p-total">0</span>
  </div>
  <div class="b-main-item s-pickable" data-key="fin">
      <span>${s.fin}:</span><span id="p-finished">0</span>
  </div>
  <a class="b-main-item s-pickable" data-key="autoPagePlay" data-status="play">
     <span>${s.autoPagePlay}</span>
  </a>
  <a class="b-main-item s-pickable" data-key="autoPagePause" data-status="paused">
     <span>${s.autoPagePause}</span>
  </a>
  <a class="b-main-item s-pickable" data-key="config">${s.config}</a>
  <a class="b-main-item s-pickable" data-key="download">${s.download}</a>
  <a class="b-main-item s-pickable" data-key="chapters">${s.chapters}</a>
  <a class="b-main-item s-pickable" data-key="filter">${s.filter}</a>
  <div class="b-main-item">
      <div id="read-mode-select"
      ><a class="b-main-option b-main-option-selected s-pickable" data-key="pagination" data-value="pagination">${s.pagination}</a
      ><a class="b-main-option s-pickable" data-key="continuous" data-value="continuous">${s.continuous}</a
      ><a class="b-main-option s-pickable" data-key="horizontal" data-value="horizontal">${s.horizontal}</a></div>
  </div>
  <div class="b-main-item">
      <span>
        <a class="b-main-btn" type="button">&lt;</a>
        <a class="b-main-btn" type="button">-</a>
        <span class="b-main-input">1</span>
        <a class="b-main-btn" type="button">+</a>
        <a class="b-main-btn" type="button">&gt;</a>
      </span>
  </div>
  <div class="b-main-item">
      <span>
        <span>${Be.zoomIcon}</span>
        <a class="b-main-btn" type="button">-</a>
        <span class="b-main-input" style="width: 3rem; cursor: move;">100</span>
        <a class="b-main-btn" type="button">+</a>
      </span>
  </div>
</div>`}function Lr(s,e){const t=`
<div class="ehvp-custom-panel" style="min-width:30vw;">
  <div class="ehvp-custom-panel-title">
    <span>${_.showStyleCustom.get()}</span>
    <span id="ehvp-custom-panel-close" class="ehvp-custom-panel-close">\u2716</span>
  </div>
  <div class="ehvp-custom-panel-container">
    <div class="ehvp-custom-panel-content">
      <div id="control-bar-example-container"></div>
      <div style="margin-top:1em;line-height:2em;">
        <input id="b-main-btn-custom-input" style="width: 30%;" type="text">
        <span id="b-main-btn-custom-confirm" class="ehvp-custom-btn ehvp-custom-btn-green">&nbspOk&nbsp</span>
        <span id="b-main-btn-custom-reset" class="ehvp-custom-btn ehvp-custom-btn-plain">&nbspReset&nbsp</span>
        <span id="b-main-btn-custom-preset1" class="ehvp-custom-btn ehvp-custom-btn-plain">&nbspPreset1&nbsp</span>
        <span id="b-main-btn-custom-preset2" class="ehvp-custom-btn ehvp-custom-btn-plain">&nbspPreset2&nbsp</span>
      </div>
      <div><span style="font-size:0.6em;color:#888;">${_.controlBarStyleTooltip.get()}</span></div>
    </div>
    <div class="ehvp-custom-panel-content" style="position:relative;">
      <div>
        <span class="ehvp-style-preset-btn ehvp-custom-btn ehvp-custom-btn-green" data-index="0">Preset 1</span>
        <span class="ehvp-style-preset-btn ehvp-custom-btn ehvp-custom-btn-green" data-index="1">Preset 2</span>
        <span class="ehvp-style-preset-btn ehvp-custom-btn ehvp-custom-btn-green" data-index="2">Preset 3</span>
        <span class="ehvp-style-preset-btn ehvp-custom-btn ehvp-custom-btn-green" data-index="3">Preset 4</span>
        <span class="ehvp-style-preset-btn ehvp-custom-btn ehvp-custom-btn-plain" data-index="99">Reset</span>
      </div>
      <textarea id="style-custom-input" style="width: 100%; height: 50vh;border:none;background-color:#00000090;color:#97ff97;text-align:left;vertical-align:top;font-size:1.2em;font-weight:600;">${h.conf.customStyle??""}</textarea>
      <span style="position:absolute;bottom:2em;right:1em;" class="ehvp-custom-btn ehvp-custom-btn-green" id="style-custom-confirm">&nbspApply&nbsp</span>
    </div>
  </div>
</div>
`,i=document.createElement("div");i.classList.add("ehvp-full-panel"),i.innerHTML=t;const n=()=>{i.remove(),e?.()};i.addEventListener("click",b=>{b.target.classList.contains("ehvp-full-panel")&&n()}),s.appendChild(i),i.querySelector(".ehvp-custom-panel-close").addEventListener("click",n);const r=i.querySelector("#control-bar-example-container");let o;r.innerHTML=ve();const a=()=>{Array.from(i.querySelectorAll(".s-pickable[data-key]")).forEach(b=>{b.addEventListener("click",()=>{o=b.getAttribute("data-key")||void 0,l.value="",o&&l.focus()})})};a();const l=i.querySelector("#b-main-btn-custom-input"),c=i.querySelector("#b-main-btn-custom-confirm"),d=i.querySelector("#b-main-btn-custom-reset"),p=()=>{const b=l.value;l.value="",!(!b||!o)&&(h.conf.displayText[o]=b,q({displayText:h.conf.displayText}),r.innerHTML=ve(),a())};c.addEventListener("click",p),l.addEventListener("keypress",b=>b.key==="Enter"&&p()),d.addEventListener("click",()=>{l.value="",h.conf.displayText={},q({displayText:h.conf.displayText}),r.innerHTML=ve(),a()});for(let b=0;b<2;b++)i.querySelector(`#b-main-btn-custom-preset${b+1}`).addEventListener("click",()=>{h.conf.displayText=Rr(b),q({displayText:h.conf.displayText}),r.innerHTML=ve(),a()});const u=i.querySelector("#style-custom-input"),g=i.querySelector("#style-custom-confirm");u.addEventListener("keydown",b=>{if(b.key==="Tab"){b.preventDefault();const y=u.selectionStart,w=u.value.slice(0,y),C=u.value.slice(y);u.value=w+"  "+C,u.selectionStart=y+2,u.selectionEnd=y+2}});const m=b=>{s.querySelector("#ehvp-style-custom")?.remove();const y=document.createElement("style");y.id="ehvp-style-custom",h.conf.customStyle=b,q({customStyle:b}),y.innerHTML=b,s.appendChild(y)};g.addEventListener("click",()=>m(u.value)),i.querySelectorAll(".ehvp-style-preset-btn").forEach(b=>{b.addEventListener("click",()=>{const y=parseInt(b.getAttribute("data-index")??"0"),w=Tr(y);u.value=w,m(w)})})}function Tr(s){return[`.ehvp-root {
  --ehvp-theme-bg-color: #393939db;
  --ehvp-theme-font-color: #fff;
  --ehvp-thumbnail-list-bg: #000000;
  --ehvp-thumbnail-border-size: 2px;
  --ehvp-thumbnail-border-radius: 0px;
  --ehvp-thumbnail-box-shadow: none;
  --ehvp-img-fetched: #95ff97;
  --ehvp-img-failed: red;
  --ehvp-img-init: #ffffff;
  --ehvp-img-fetching: #00000000;
  --ehvp-controlbar-border: none;
  --ehvp-panel-border: none;
  --ehvp-panel-box-shadow: none;
  --ehvp-big-images-gap: 0px;
  --ehvp-big-images-bg: #000000c4;
  --ehvp-clickable-color-hover: #90ea90;
  --ehvp-playing-progress-bar-color: #ffffffd0;
  ${X?"":"font-size: 16px;"}
  font-family: Poppins,sans-serif;
}
/** override any style here, make the big image have a green border */
/**
.bifm-container > div {
  border: 2px solid green;
}
*/`,`.ehvp-root {
  --ehvp-theme-bg-color: #ffffff;
  --ehvp-theme-font-color: #760098;
  --ehvp-thumbnail-list-bg: #ffffff;
  --ehvp-thumbnail-border-size: 2px;
  --ehvp-thumbnail-border-radius: 4px;
  --ehvp-thumbnail-box-shadow: 0px 2px 2px 0px #785174;
  --ehvp-img-fetched: #d96cff;
  --ehvp-img-failed: red;
  --ehvp-img-init: #000000;
  --ehvp-img-fetching: #ffffff70;
  --ehvp-controlbar-border: 2px solid #760098;
  --ehvp-panel-border: 2px solid #760098;
  --ehvp-panel-box-shadow: none;
  --ehvp-big-images-gap: 0px;
  --ehvp-big-images-bg: #919191b0;
  --ehvp-clickable-color-hover: #ff87ba;
  --ehvp-playing-progress-bar-color: #760098d0;
  ${X?"":"font-size: 16px;"}
  font-family: Poppins, sans-serif;
}`,`.ehvp-root {
  --ehvp-theme-bg-color: #000000c9;
  --ehvp-theme-font-color: #ffe637;
  --ehvp-thumbnail-list-bg: #000000;
  --ehvp-thumbnail-border-size: 2px;
  --ehvp-thumbnail-border-radius: 0px;
  --ehvp-thumbnail-box-shadow: none;
  --ehvp-img-fetched: #ffe637;
  --ehvp-img-failed: red;
  --ehvp-img-init: #fff;
  --ehvp-img-fetching: #00000000;
  --ehvp-controlbar-border: 2px solid #ffe637;
  --ehvp-panel-border: 2px solid #ffe637;
  --ehvp-panel-box-shadow: none;
  --ehvp-big-images-gap: 0px;
  --ehvp-big-images-bg: #000000d6;
  --ehvp-clickable-color-hover: #90ea90;
  --ehvp-playing-progress-bar-color: #ffe637d0;
  ${X?"":"font-size: 16px;"}
  font-family: Poppins, sans-serif;
}`,`.ehvp-root {
  --ehvp-theme-bg-color: #ffffff;
  --ehvp-theme-font-color: #000000;
  --ehvp-thumbnail-list-bg: #ffffff;
  --ehvp-thumbnail-border-size: 2px;
  --ehvp-thumbnail-border-radius: 4px;
  --ehvp-thumbnail-box-shadow: 0px 2px 2px 0px #000000;
  --ehvp-img-fetched: #000000;
  --ehvp-img-failed: red;
  --ehvp-img-init: #ffffff;
  --ehvp-img-fetching: #ffffff70;
  --ehvp-controlbar-border: 2px solid #000000;
  --ehvp-panel-border: 2px solid #000000;
  --ehvp-panel-box-shadow: none;
  --ehvp-big-images-gap: 0px;
  --ehvp-big-images-bg: #919191b0;
  --ehvp-clickable-color-hover: #ff0000;
  --ehvp-playing-progress-bar-color: #000000d0;
  ${X?"":"font-size: 16px;"}
  font-family: Poppins, sans-serif;
}`][s]??""}function Rr(s){return[{entry:"ENTER",collapse:"X",config:"C",download:"D",chapters:"CH.",filter:"FL.",fin:"F",pagination:"P",continuous:"C",horizontal:"H",autoPagePlay:"PLAY",autoPagePause:"PAUSE"},{entry:"<\u273F>",collapse:">\u2734<",config:"\u2638",download:"\u2B07",chapters:"CH.",filter:"\u2315",fin:"\u2B07",pagination:"\u274F",continuous:"\u21C5",horizontal:"\u21C6",autoPagePlay:"\u22B3",autoPagePause:"\u21E2\u21E2\u21E2"}][s]??{}}const Pr={entry:Be.moonViewCeremony,collapse:_.collapse.get(),fin:"FIN",autoPagePlay:_.autoPagePlay.get(),autoPagePause:_.autoPagePause.get(),config:_.config.get(),download:_.download.get(),chapters:_.chapters.get(),filter:_.filter.get(),pagination:"PAGE",continuous:"CONT",horizontal:"HORI"};function lt(){return{...Pr,...h.conf.displayText}}function Y(s,e){return Array.from(s.cssRules).find(t=>t.selectorText===e)}function Mr(s,e){const t=`
<div class="ehvp-custom-panel" style="min-width:30vw;">
  <div class="ehvp-custom-panel-title">
    <span>${_.showActionCustom.get()}</span>
    <span id="ehvp-custom-panel-close" class="ehvp-custom-panel-close">\u2716</span>
  </div>

  <div class="ehvp-custom-panel-container">

    <div class="ehvp-custom-panel-content">
      <div class="ehvp-custom-panel-item">
       <div class="ehvp-custom-panel-item-title">
         <span>${_.showActionCustom.get()}</span>
       </div>
       <div id="ehvp-image-action-values" class="ehvp-custom-panel-item-values">
         <!-- wait element created from button event -->
       </div>
      </div>
    </div>

    <div class="ehvp-custom-panel-content">
      <div class="ehvp-custom-panel-item">
        <div class="ehvp-custom-panel-item-title">
         <span>${_.example.get()}</span>
        </div>
        <div>
          <span class="ehvp-action-preset-btn ehvp-custom-btn ehvp-custom-btn-green" data-index="0">Example 1</span>
          <span class="ehvp-action-preset-btn ehvp-custom-btn ehvp-custom-btn-green" data-index="1">Example 2</span>
          <span class="ehvp-action-preset-btn ehvp-custom-btn ehvp-custom-btn-green" data-index="2">Example 3</span>
          <span class="ehvp-action-preset-btn ehvp-custom-btn ehvp-custom-btn-green" data-index="3">Example 4</span>
        </div>
      </div>
    </div>

    <div class="ehvp-custom-panel-content" style="position:relative;">
      <div><span style="font-size:1.6em;color:#888;">${_.description.get()}</span></div>
      <div>
        <div>
          <label>
            <span>${_.icon.get()}</span>
            <input id="ehvp-action-input-icon" style="width: 2em;" type="text">
          </label>
        </div>
        <div>
          <label>
            <span>${_.description.get()} (${_.optional.get()})</span>
            <input id="ehvp-action-input-desc" style="width: 98%;" type="text">
          </label>
        </div>
        <div>
          <label>
            <span>${_.workon.get()} (${_.optional.get()},${_.regexp.get()})</span>
            <input id="ehvp-action-input-workon" style="width: 98%;" type="text">
          </label>
        </div>
      </div>
      <div><span style="font-size:1.6em;color:#888;">${_.function.get()} ${_.parameters.get()}</span></div>
      <div>
        <a class="ehvp-custom-btn-green" target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance/blob/9ec4f7970983501ca3c5d8165c455a2654b52bf6/src/img-fetcher.ts#L30">imf</a>
        <a class="ehvp-custom-btn-green" target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance/blob/9ec4f7970983501ca3c5d8165c455a2654b52bf6/src/img-node.ts#L47">imn</a>
        <a class="ehvp-custom-btn-green" target="_blank" href="https://www.tampermonkey.net/documentation.php?locale=en#api:GM_xmlhttpRequest">gm_xhr</a>
        <a class="ehvp-custom-btn-green" target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance/blob/9ec4f7970983501ca3c5d8165c455a2654b52bf6/src/event-bus.ts#L8">EBUS</a>
      </div>
      <div><span style="font-size:1.6em;color:#888;">${_.function.get()} ${_.body.get()}</span></div>
      <textarea id="ehvp-action-input-funcbody" style="min-width: 60vw; height: 50vh;border:none;background-color:#00000090;color:#97ff97;text-align:left;vertical-align:top;font-size:1.2em;font-weight:600;"></textarea>
      <span id="ehvp-action-add-confirm" style="position:absolute;bottom:2em;right:1em;" class="ehvp-custom-btn ehvp-custom-btn-green">&nbspAdd&nbsp</span>
    </div>

  </div>
</div>
`,i=document.createElement("div");i.classList.add("ehvp-full-panel"),i.innerHTML=t;const n=()=>{i.remove(),e?.()};i.addEventListener("click",m=>{m.target.classList.contains("ehvp-full-panel")&&n()}),s.appendChild(i),i.querySelector(".ehvp-custom-panel-close").addEventListener("click",n);const r=i.querySelector("#ehvp-image-action-values"),o=i.querySelector("#ehvp-action-input-icon"),a=i.querySelector("#ehvp-action-input-desc"),l=i.querySelector("#ehvp-action-input-workon"),c=i.querySelector("#ehvp-action-input-funcbody"),d=i.querySelector("#ehvp-action-add-confirm");function p(){r.innerHTML="";const m=document.createElement("div");h.conf.imgNodeActions.map(b=>{const y=`<span class="ehvp-custom-panel-item-value"><span class="ehvp-span-action-icon">${b.icon}</span><span class="ehvp-custom-btn ehvp-custom-btn-plain" style="padding:0;border:none;">&nbspx&nbsp</span></span>`;m.innerHTML=y;const w=m.firstElementChild;r.append(w),w.querySelector(".ehvp-custom-btn").addEventListener("click",()=>{const C=h.conf.imgNodeActions.findIndex(E=>E.icon===b.icon&&E.funcBody===b.funcBody);C!==-1&&(g(b),h.conf.imgNodeActions.splice(C,1),q({imgNodeActions:h.conf.imgNodeActions}),p())}),w.querySelector(".ehvp-span-action-icon").addEventListener("click",()=>g(b))}),m.remove()}p();function u(){const m=o.value,b=a.value,y=l.value,w=c.value;if(!m){confirm("icon cannot be empty!");return}if(!w){confirm("func body cannot be empty!");return}try{const C=async function(){}.constructor;C("imf","imn","gm_xhr","EBUS",w)}catch(C){confirm("cannot create function (this site limit), "+C);return}if(y)try{new RegExp(y)}catch(C){confirm("invalid regexp: "+C);return}h.conf.imgNodeActions.push({icon:m,description:b,workon:y,funcBody:w}),q({imgNodeActions:h.conf.imgNodeActions}),p(),i.querySelector(".ehvp-custom-panel-container")?.scrollTo({top:0})}function g(m){o.value=m.icon,a.value=m.description,l.value=m.workon??"",c.value=m.funcBody}i.querySelectorAll(".ehvp-action-preset-btn").forEach(m=>{m.addEventListener("click",()=>{const b=parseInt(m.getAttribute("data-index")??"0"),y=Nr(b);y&&g(y)})}),c.addEventListener("keydown",m=>{if(m.key==="Tab"){m.preventDefault();const b=c.selectionStart,y=c.value.slice(0,b),w=c.value.slice(b);c.value=y+"  "+w,c.selectionStart=b+2,c.selectionEnd=b+2}}),d.addEventListener("click",()=>u())}function Nr(s){return[{icon:"S",description:"Upload this image to local (miniserve --port 14001 --upload-files . .)",workon:"e[-x]hentai.org|x.com|pixiv.com",funcBody:`
if (imf.stage === 3 && imf.data) {
  const formData = new FormData();
  formData.append("file", new Blob([imf.data]), imn.title);
  formData.append("path", "/");
  const p = new Promise((resolve, reject) => {
    gm_xhr({
      url: "http://localhost:14001/upload?path=/",
      method: "POST",
      timeout: 10 * 1000,
      data: formData,
      onload: () => resolve(true),
      onabort: () => reject("abort"),
      onerror: (ev) => reject(ev.error),
      ontimeout: () => reject("timeout"),
    });
  });
  await p;
}
  `},{icon:"\u6362",description:"Download and Replace this image",workon:".*",funcBody:`
const p = new Promise((resolve, reject) => {
  gm_xhr({
    url: "https://media.senscritique.com/media/000022161329/0/les_miserables_shoujo_cosette.jpg",
    method: "GET",
    responseType: "blob",
    timeout: 10 * 1000,
    onload: (ev) => resolve(ev.response),
    onabort: () => reject("abort"),
    onerror: (ev) => reject(ev.error),
    ontimeout: () => reject("timeout"),
  });
});
const data = await p;
return {data};
  `},{icon:"\u2714",description:"Cherry pick this image",funcBody:'EBUS.emit("add-cherry-pick-range", imf.chapterIndex, imf.index, true, false);'},{icon:"\u2716",description:"Cherry pick but exclude this image",funcBody:'EBUS.emit("add-cherry-pick-range", imf.chapterIndex, imf.index, false, false);'}][s]}class M{defaultKeys;cb;noPreventDefault=!1;constructor(e,t,i){this.defaultKeys=e,this.cb=t,this.noPreventDefault=i||!1}}function $r(s,e,t,i,n){function r(x,S,L,$){if(!L){const B={colCount:[1,12],rowHeight:[50,4096],threads:[1,10],downloadThreads:[1,10],timeout:[8,40],autoPageSpeed:[1,100],preventScrollPageTime:[-1,9e4],paginationIMGCount:[1,3],scrollingDelta:[1,5e3],scrollingSpeed:[1,100]};let V=1;(x==="preventScrollPageTime"||x==="rowHeight"||x==="scrollingDelta")&&(V=h.conf[x]===1?9:10),S==="add"?L=Math.min(h.conf[x]+V,B[x][1]):S==="minus"&&(L=Math.max(h.conf[x]-V,B[x][0]))}if(L===void 0)return;h.conf[x]=L;const D=v(`#${x}Input`,s.config.panel);if(D.value=h.conf[x].toString(),(x==="colCount"||x==="rowHeight")&&f.emit("fvg-layout-resize"),x==="paginationIMGCount"){v("#paginationInput",s.paginationAdjustBar).textContent=h.conf.paginationIMGCount.toString();const B=Y(s.styleSheet,".bifm-container-page .bifm-img");B&&(B.style.maxWidth=h.conf.imgScale===100&&h.conf.paginationIMGCount===1?"100%":""),e.setNow(t[t.currIndex])}q({[x]:L},$??h.conf.selectedSiteNameConfig)}function o(x,S){const L=v(`#${x}Checkbox`,s.config.panel);S!==void 0?L.checked=S:S=L.checked||!1,S!==void 0&&(h.conf[x]=S,q({[x]:S},h.conf.selectedSiteNameConfig),x==="autoLoad"&&(i.autoLoad=h.conf.autoLoad,i.abort(0,h.conf.restartIdleLoader/3)),x==="reversePages"&&e.changeLayout())}function a(x,S){x&&(h.conf.readMode=x),e.changeLayout(),h.conf.autoPageSpeed=h.conf.readMode==="pagination"?5:1,q({readMode:h.conf.readMode,autoPageSpeed:h.conf.autoPageSpeed},S??h.conf.selectedSiteNameConfig),v("#autoPageSpeedInput",s.config.panel).value=h.conf.autoPageSpeed.toString(),Array.from(s.readModeSelect.querySelectorAll(".b-main-option")).forEach(L=>{L.getAttribute("data-value")===h.conf.readMode?L.classList.add("b-main-option-selected"):L.classList.remove("b-main-option-selected")}),h.conf.readMode==="pagination"?s.root.querySelectorAll(".img-land").forEach(L=>L.style.display=""):s.root.querySelectorAll(".img-land").forEach(L=>L.style.display="none")}function l(x,S){const L=v(`#${x}Select`,s.config.panel);if(S?L.value=S:S=L.value,!!S){if(h.conf[x]=S,x==="readMode"){a();return}if(q({[x]:S},h.conf.selectedSiteNameConfig),x==="minifyPageHelper")switch(h.conf.minifyPageHelper){case"always":n.minify("bigImageFrame");break;case"inBigMode":case"never":n.minify(e.visible?"bigImageFrame":"fullViewGrid");break}x==="gridMode"&&f.emit("fvg-layout-change")}}function c(x,S){const L=v(`#${x}TextInput`,s.config.panel);S?L.value=S:S=L.value,h.conf[x]=S,q({[x]:S},h.conf.selectedSiteNameConfig)}const d={};function p(x,S){S&&u(S);const L=window.setTimeout(()=>x.classList.add("p-collapse"),100);S&&(d[S]=L)}function u(x){(x?[x]:[...Object.keys(d)]).forEach(S=>{window.clearTimeout(d[S]),delete d[S]})}function g(x,S,L){const $=`${x}-panel`,D=v("#"+$,s.pageHelper);if(D){if(S===void 0){g(x,!D.classList.contains("p-collapse"),L);return}S?p(D,$):(Array.from(s.root.querySelectorAll(".p-panel")).filter(B=>B!==D).forEach(B=>p(B,B.id)),D.classList.remove("p-collapse"),L&&pe(D,L,s.root.clientWidth,s.root.clientHeight))}}const m=document.body.style.overflow;function b(){s.root.classList.remove("ehvp-root-collapse"),e.visible?(e.root.focus(),n.minify("bigImageFrame")):(s.fullViewGrid.focus(),n.minify("fullViewGrid")),document.body.style.overflow="hidden"}function y(){n.minify("exit"),s.entryBTN.setAttribute("data-stage","exit"),s.root.classList.add("ehvp-root-collapse"),e.visible?e.root.blur():s.fullViewGrid.blur(),document.body.style.overflow=m}function w(){const x={"exit-big-image-mode":new M(["escape","enter"],()=>e.hidden()),"step-image-prev":new M(["arrowleft"],()=>{e.callbackOnWheel?.(),e.stepNext(h.conf.reversePages?"next":"prev")}),"step-image-next":new M(["arrowright"],()=>{e.callbackOnWheel?.(),e.stepNext(h.conf.reversePages?"prev":"next")}),"step-to-first-image":new M(["home"],()=>e.stepNext("next",0,1)),"step-to-last-image":new M(["end"],()=>e.stepNext("prev",0,-1)),"scale-image-increase":new M(["="],()=>e.scaleBigImages(1,5)),"scale-image-decrease":new M(["-"],()=>e.scaleBigImages(-1,5)),"scroll-image-up":new M(["pageup","arrowup","shift+space"],$=>{const D=re($),B=["pageup","shift+space"].includes(D);let V=!["pageup","arrowup","shift+space"].includes(D);e.onWheel(new WheelEvent("wheel",{deltaY:h.conf.scrollingDelta*-1}),B,V,void 0,$)},!0),"scroll-image-down":new M(["pagedown","arrowdown","space"],$=>{const D=re($),B=["pagedown","space"].includes(D),V=!["pagedown","arrowdown","space"].includes(D);e.onWheel(new WheelEvent("wheel",{deltaY:h.conf.scrollingDelta}),B,V,void 0,$)},!0),"toggle-auto-play":new M(["p"],()=>f.emit("toggle-auto-play")),"round-read-mode":new M(["alt+m"],()=>{const $=["pagination","continuous","horizontal"],D=($.indexOf(h.conf.readMode)+1)%$.length;l("readMode",$[D])},!0),"toggle-reverse-pages":new M(["alt+f"],()=>o("reversePages",!h.conf.reversePages),!0),"rotate-image":new M(["alt+r"],()=>f.emit("bifm-rotate-image"),!0),"cherry-pick-current":new M(["alt+x"],()=>e.cherryPickCurrent(!1),!0),"exclude-current":new M(["shift+alt+x"],()=>e.cherryPickCurrent(!0),!0),"go-prev-chapter":new M(["shift+alt+w"],()=>f.emit("pf-step-chapters","prev"),!0),"go-next-chapter":new M(["alt+w"],()=>f.emit("pf-step-chapters","next"),!0)},S={"open-big-image-mode":new M(["enter"],()=>{let $=t.currIndex;if(E&&E.length>0){if($=Number(E.join(""))-1,E=null,isNaN($))return;$=Math.max(0,Math.min($,t.length-1))}t[$].node.root?.querySelector("a")?.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0}))}),"pause-auto-load-temporarily":new M(["alt+p"],()=>{i.autoLoad=!i.autoLoad,i.autoLoad?(i.abort(t.currIndex,h.conf.restartIdleLoader/3),f.emit("notify-message","info","Auto load Restarted",3*1e3)):f.emit("notify-message","info","Auto load Pause",3*1e3)}),"exit-full-view-grid":new M(["escape"],()=>f.emit("toggle-main-view",!1)),"columns-increase":new M(["="],()=>r("colCount","add")),"columns-decrease":new M(["-"],()=>r("colCount","minus")),"toggle-auto-play":new M(["p"],()=>f.emit("toggle-auto-play")),"retry-fetch-next-page":new M(["alt+n"],()=>f.emit("pf-retry-extend")),"resize-flow-vision":new M(["alt+r"],()=>f.emit("fvg-layout-resize")),"start-download":new M(["shift+alt+d"],()=>f.emit("start-download",()=>n.minify("fullViewGrid",!1))),"go-prev-chapter":new M(["shift+alt+w"],()=>f.emit("pf-step-chapters","prev"),!0),"go-next-chapter":new M(["alt+w"],()=>f.emit("pf-step-chapters","next"),!0)},L={"open-full-view-grid":new M(["enter"],()=>{const $=document.activeElement;$ instanceof HTMLInputElement||$ instanceof HTMLTextAreaElement||$ instanceof HTMLSelectElement||f.emit("toggle-main-view",!0)},!0),"start-download":new M(["shift+alt+d"],()=>{f.emit("start-download",()=>n.minify("exit",!1))},!0)};return{inBigImageMode:x,inFullViewGrid:S,inMain:L}}const C=w();let E=null;function T(x){if(s.bigImageFrame.classList.contains("big-img-frame-collapse"))return;const S=re(x),L=Object.entries(C.inBigImageMode).find(([B,V])=>{const J=h.conf.keyboards.inBigImageMode[B];return J!==void 0&&J.length>0?J.includes(S):V.defaultKeys.includes(S)});if(!L)return;const[$,D]=L;D.noPreventDefault||x.preventDefault(),D.cb(x)}function U(x){if(s.root.classList.contains("ehvp-root-collapse"))return;const S=re(x),L=Object.entries(C.inFullViewGrid).find(([$,D])=>{const B=h.conf.keyboards.inFullViewGrid[$];return B!==void 0&&B.length>0?B.includes(S):D.defaultKeys.includes(S)});if(L){const[$,D]=L;D.noPreventDefault||x.preventDefault(),D.cb(x)}else x instanceof KeyboardEvent&&x.key.length===1&&x.key>="0"&&x.key<="9"&&(E=E?[...E,Number(x.key)]:[Number(x.key)],x.preventDefault())}function H(x){if(!s.root.classList.contains("ehvp-root-collapse")||!s.bigImageFrame.classList.contains("big-img-frame-collapse"))return;const S=re(x),L=Object.entries(C.inMain).find(([B,V])=>{const J=h.conf.keyboards.inMain[B];return J!==void 0&&J.length>0?J.includes(S):V.defaultKeys.includes(S)});if(!L)return;const[$,D]=L;D.noPreventDefault||x.preventDefault(),D.cb(x)}function Z(){e.visible?s.bigImageFrame.focus():s.fullViewGrid.focus()}function Ve(){kr(s.root,Z)}function _e(){Er(C,s.root,Z)}function ao(){Sr(s.root,Z)}function so(){Lr(s.root,Z)}function lo(){Mr(s.root,Z)}return{modNumberConfigEvent:r,modBooleanConfigEvent:o,modSelectConfigEvent:l,modTextConfigEvent:c,togglePanelEvent:g,showFullViewGrid:b,hiddenFullViewGrid:y,fullViewGridKeyBoardEvent:U,bigImageFrameKeyBoardEvent:T,keyboardEvent:H,showGuideEvent:Ve,collapsePanelEvent:p,abortMouseleavePanelEvent:u,showKeyboardCustomEvent:_e,showSiteProfilesEvent:ao,showStyleCustomEvent:so,showActionCustomEvent:lo,changeReadModeEvent:a}}class ct{}class Or{root;queue=[];done=!1;chapterIndex=0;layout;resizedNodesPending=[];debouncer;constructor(e,t){this.root=e.fullViewGrid,this.debouncer=new W,h.conf.gridMode==="flow"?this.layout=new ht(this.root):this.layout=new dt(this.root,e.styleSheet),f.subscribe("pf-on-appended",(i,n,r,o)=>{this.chapterIndex>-1&&r!==this.chapterIndex||(this.append(n),this.done=o||!1,setTimeout(()=>this.renderCurrView(),200))}),f.subscribe("pf-change-chapter",i=>{this.chapterIndex=i,this.layout.reset(),this.queue=[],this.done=!1}),f.subscribe("ifq-do",(i,n)=>{if(!t.visible||n.chapterIndex!==this.chapterIndex||!n.node.root)return;let r=0;h.conf.gridMode==="flow"?r=n.node.root.parentElement.offsetTop-window.screen.availHeight/3:r=n.node.root.offsetTop-window.screen.availHeight/3,r=r<=0?0:r>=this.root.scrollHeight?this.root.scrollHeight:r,this.root.scrollTo.toString().includes("[native code]")?this.root.scrollTo({top:r,behavior:"smooth"}):this.root.scrollTop=r}),f.subscribe("cherry-pick-changed",i=>this.chapterIndex===i&&this.updateRender()),this.root.addEventListener("scroll",()=>this.debouncer.addEvent("FULL-VIEW-SCROLL-EVENT",()=>{e.root.classList.contains("ehvp-root-collapse")||(this.renderCurrView(),this.tryExtend())},400)),this.root.addEventListener("click",i=>{(i.target===e.fullViewGrid||i.target.classList.contains("fvg-sub-container"))&&f.emit("toggle-main-view",!1)}),f.subscribe("fvg-layout-change",()=>{this.layout.remove(this.root),h.conf.gridMode==="flow"?this.layout=new ht(this.root):this.layout=new dt(this.root,e.styleSheet),this.layout.resize(this.queue)}),f.subscribe("fvg-layout-resize",()=>this.layout.resize(this.queue)),f.subscribe("imf-resize",i=>this.resizedNodes(i))}resizedNodes(e){const t=e.node;t.root&&this.resizedNodesPending.push(t.root),this.debouncer.addEvent("RESIZED-NODES",()=>{if(this.resizedNodesPending.length===0)return;let i=null;for(;i=this.resizedNodesPending.shift();){const n=this.layout.resizedNode(i,this.resizedNodesPending);this.resizedNodesPending=this.resizedNodesPending.filter((r,o)=>!n.includes(o))}},50)}append(e){if(e.length>0){let t=this.queue.length;const i=e.map(n=>{const r={node:n,element:n.create(),ratio:n.ratio()};return r.element.setAttribute("data-index",t.toString()),t++,r});this.queue.push(...i),this.layout.append(i)}}tryExtend(){this.done||this.layout.nearBottom()&&f.emit("pf-try-extend")}updateRender(){this.queue.forEach(({node:e})=>e.isRender()&&e.render())}renderCurrView(){const[e,t]=this.layout.visibleRange(this.root,this.queue.map(r=>r.element)),[i,n]=[parseInt(e.getAttribute("data-index")??"-1"),parseInt(t.getAttribute("data-index")??"-1")];i<n&&i>-1&&n<this.queue.length?(this.queue.slice(i,n+1).forEach(r=>r.node.render()),A("info","render curr view, range: ",`[${i}-${n}]`)):A("error","render curr view error, range: ",`[${i}-${n}]`)}}class dt extends ct{root;style;constructor(e,t){super(),this.root=e,this.style=t,this.root.classList.add("fvg-grid"),this.root.classList.remove("fvg-flow")}append(e){this.root.append(...e.map(t=>t.element))}nearBottom(){const e=Array.from(this.root.childNodes);if(e.length===0)return!1;const t=e[e.length-1];return!(this.root.scrollTop+this.root.clientHeight+this.root.clientHeight*2.5<t.offsetTop+t.offsetHeight)}reset(){this.root.innerHTML=""}resize(e){const t=Y(this.style,".fvg-grid");t&&(t.style.gridTemplateColumns=`repeat(${h.conf.colCount}, minmax(10px, 1fr))`),this.root.innerHTML="",this.append(e)}resizedNode(e,t){return t.map((i,n)=>n)}visibleRange(e,t){if(t.length===0)return[e,e];const i=e.offsetHeight;let n,r,o=0;for(let a=0;a<t.length;a+=h.conf.colCount){const l=t[a].getBoundingClientRect(),c=l.top+l.height>=0&&l.top<=i;if(c&&n===void 0&&(n=t[a]),n&&!c&&o++,o>=2){r=t[Math.min(t.length-1,a+h.conf.colCount)];break}}return r=r??t[t.length-1],[n??r,r]}remove(e){e.innerHTML=""}}class ht extends ct{root;lastRow;count=0;resizeObserver;lastRootWidth;base;constructor(e){super(),this.root=e,this.root.classList.add("fvg-flow"),this.root.classList.remove("fvg-grid"),this.lastRootWidth=this.root.offsetWidth,this.base=this.initBaseline(),this.resizeObserver=new ResizeObserver(t=>{const i=t[0],n=i.contentRect.width;this.lastRootWidth!==n&&(this.lastRootWidth=n,Array.from(i.target.querySelectorAll(".fvg-sub-container")).forEach(r=>this.resizeRow(r)))}),this.resizeObserver.observe(this.root)}initBaseline(){return{height:h.conf.rowHeight,columns:h.conf.colCount,gap:8}}createRow(e){const t=document.createElement("div");return t.classList.add("fvg-sub-container"),t.style.height=(e??this.base.height)+"px",t.style.marginTop=this.base.gap+"px",this.root.appendChild(t),t}append(e){for(const t of e)t.element.style.marginLeft=this.base.gap+"px",this.lastRow||(this.lastRow=this.createRow()),this.checkRowFilled(this.lastRow,t.ratio)&&(this.resizeRow(this.lastRow),this.lastRow=this.createRow(this.lastRow?.offsetHeight)),this.lastRow.appendChild(t.element),this.count++}checkRowFilled(e,t){if(e.childElementCount===0)return!1;let i=e.childElementCount>=this.base.columns;if(!i){let n=this.base.height*t;const r=e.childElementCount*this.base.gap+this.base.gap,o=.4/Math.max(1,t);n=n*o,i=this.childrenRatio(e).reduce((l,c)=>l+c*this.base.height,0)+r+n>=this.root.offsetWidth}return i}childrenRatio(e){const t=[],i=n=>{let r=parseFloat(n.getAttribute("data-ratio")??"1");return r=isNaN(r)?1:r,r};return e.childNodes.forEach(n=>t.push(i(n))),t}resizeRow(e){const t=this.childrenRatio(e).reduce((o,a)=>o+a,0),i=e.childElementCount*this.base.gap+this.base.gap,r=(this.root.offsetWidth-i)/t;e.style.height=r+"px"}resize(e){this.base=this.initBaseline(),this.root.innerHTML="",this.lastRow=void 0,this.append(e)}resizedNode(e,t){let i=e.parentElement;if(!i)return[];const n=document.createDocumentFragment();let r=[];function*o(){if(n.append(...r),i.childElementCount>0){const u=Array.from(i.childNodes).map(g=>g);n.append(...u),r.push(...u)}let d=null;for(;d=r.shift();)yield d;const p=i?.nextElementSibling;if(p)for(r=Array.from(p.childNodes).map(u=>u);d=r.shift();)yield d}let a=[],l=0,c=1;for(;;){for(const d of o()){const p=parseFloat(d.getAttribute("data-ratio")??"1");if(this.checkRowFilled(i,p)){r.unshift(d),this.resizeRow(i);break}const u=t.indexOf(d);u>=0&&a.push(u),l++,i.appendChild(d)}if(i=i?.nextElementSibling,i===null&&(i=this.createRow()),r.length===0){i.childElementCount===0&&i.remove();break}if(r.length===i.childElementCount&&r[0]===i.firstElementChild)break;c++}return A("info",`resizedNode moved img-nodes [${l}], changed rows [${c}], resized [${a.length}]`),a}nearBottom(){const e=this.lastRow;return!(!e||this.root.scrollTop+this.root.clientHeight+this.root.clientHeight*2.5<e.offsetTop+e.offsetHeight)}reset(){this.lastRow=void 0,this.root.innerHTML=""}visibleRange(){const e=Array.from(this.root.querySelectorAll(".fvg-sub-container"));if(e.length===0)return[this.root,this.root];const t=this.root.offsetHeight;let i,n,r=0;for(let o=0;o<e.length;o++){const a=e[o].getBoundingClientRect(),l=a.top+a.height>=0&&a.top<=t;if(l&&i===void 0&&(i=e[o].firstElementChild),i&&!l&&r++,r>=2){n=e[o].lastElementChild;break}}return n=n??e[e.length-1].lastElementChild,[i??n,n]}remove(e){e.innerHTML=""}}function pt(s,e,t,i){const n={vw:s,vh:e};return t<=s/2?n.left=Math.max(t,5):n.right=Math.max(s-t,5),i<=e/2?n.top=Math.max(i,5):n.bottom=Math.max(e-i,5),n}function Dr(s,e,t){(t??s).addEventListener("mousedown",i=>{i.preventDefault();const n=window.innerHeight,r=window.innerWidth,o=new AbortController;e.onStart?.(i.clientX,i.clientY),document.addEventListener("mousemove",a=>{e.onMoving?.(pt(r,n,a.clientX,a.clientY))},{signal:o.signal}),document.addEventListener("mouseup",()=>{o.abort(),e.onFinish?.(pt(r,n,i.clientX,i.clientY))},{once:!0})})}function Ur(s,e,t,i){if(s.buttons!==1)return;document.querySelector("#drag-element-with-line")?.remove();const n=document.createElement("canvas");n.id="drag-element-with-line",n.style.position="fixed",n.style.zIndex="100000",n.style.top="0px",n.style.left="0px",n.style.width="100vw",n.style.height="100vh",n.width=window.innerWidth,n.height=window.innerHeight,document.body.appendChild(n);const r=e.getBoundingClientRect(),o=Math.floor(r.height/2.2),[a,l]=[r.left+r.width/2,r.top+r.height/2],c=n.getContext("2d",{alpha:!0}),d=new AbortController;n.addEventListener("mouseup",()=>{document.body.removeChild(n),d.abort()},{once:!0}),n.addEventListener("mousemove",p=>{const[u,g]=[t.x?a:p.clientX,l];c.clearRect(0,0,n.width,n.height),c.beginPath(),c.moveTo(a,l),c.lineTo(u,g),c.strokeStyle="#ffffffa0",c.lineWidth=4,c.stroke(),c.beginPath(),c.arc(u,g,o,0,2*Math.PI),c.fillStyle="#ffffffa0",c.fill(),i(qr(a,l,u,g))},{signal:d.signal})}function qr(s,e,t,i){const n=Math.sqrt(Math.pow(t-s,2)+Math.pow(i-e,2)),r=1<<(e>i?3:2)|1<<(s>t?1:0);return{start:{x:s,y:e},end:{x:t,y:i},distance:n,direction:r}}function Br(){return`
.ehvp-root {
  --ehvp-theme-bg-color: #333343bb;
  --ehvp-theme-font-color: #fff;
  --ehvp-thumbnail-list-bg: #000;
  --ehvp-thumbnail-border-size: 2px;
  --ehvp-thumbnail-border-radius: 5px;
  --ehvp-thumbnail-box-shadow: none;
  --ehvp-img-fetched: #90ffae;
  --ehvp-img-failed: red;
  --ehvp-img-init: #fff;
  --ehvp-img-fetching: #ffffff70;
  --ehvp-controlbar-border: 1px solid #2f7b10;
  --ehvp-panel-border: none;
  --ehvp-panel-box-shadow: none;
  --ehvp-big-images-gap: 0px;
  --ehvp-big-images-bg: #000000d6;
  --ehvp-clickable-color-hover: #90ea90;
  --ehvp-playing-progress-bar-color: #ffffffd0;
  font-size: 16px;
  font-family: Poppins,sans-serif;
}
.ehvp-root {
  width: 100%;
  height: 100%;
  background-color: #000;
  position: fixed;
  top: 0px;
  left: 0px;
  z-index: 2000;
  box-sizing: border-box;
  overflow: clip;
}
.ehvp-root input[type="checkbox"] {
  width: 1em;
  height: unset !important;
}
.ehvp-root select {
  width: 8em;
  height: 2em;
}
.ehvp-root input {
  width: 3em;
  height: 1.5em;
}
.config-panel-item input.text-input {
  width: 10em;
  cursor: auto;
}
.ehvp-root-collapse {
  height: 0;
}
.fvg-flow {
  width: 100%;
  height: 100%;
  overflow: hidden scroll;
  background: var(--ehvp-thumbnail-list-bg);
}
.fvg-grid {
  width: 100%;
  height: 100%;
  display: grid;
  align-content: start;
  grid-gap: 0.7em;
  grid-template-columns: repeat(${h.conf.colCount}, minmax(10px, 1fr));
  overflow: hidden scroll;
  padding: 0.3em;
  box-sizing: border-box;
  background: var(--ehvp-thumbnail-list-bg);
}
.ehvp-root input, .ehvp-root select {
  color: var(--ehvp-theme-font-color);
  background-color: var(--ehvp-theme-bg-color);
  border: 1px solid #000000;
  border-radius: 4px;
  margin: 0px;
  padding: 0px;
  text-align: center;
  vertical-align: middle;
}
.ehvp-root input:enabled:hover, .ehvp-root select:enabled:hover, .ehvp-root input:enabled:focus, .ehvp-root select:enabled:focus {
  background-color: #34355b !important;
}
.ehvp-root select option {
  background-color: #34355b !important;
  color: #f1f1f1;
  font-size: 1em;
}
.p-label {
  cursor: pointer;
  height: 2em;
}
.p-label > span {
  white-space: nowrap;
}
.p-label > span:first-child {
  overflow: hidden;
  text-overflow: ellipsis;
  position: relative;
  padding-right: 1.5em;
}
.p-label > span:first-child > .p-tooltip {
  position: absolute;
  right: 0.2em;
}
.full-view-grid, .big-img-frame {
  outline: none !important;
}
.img-node {
  position: relative;
  padding: var(--ehvp-thumbnail-border-size);
  box-sizing: border-box;
  background-color: var(--ehvp-img-init);
  border-radius: var(--ehvp-thumbnail-border-radius);
  box-shadow: var(--ehvp-thumbnail-box-shadow);
}
.fvg-sub-container {
  display: flex;
  width: 100%;
  flex-wrap: nowrap;
  /**
  contain: content;
  scollbar-width: none;
  */
}
/**
.full-view-grid::-webkit-scrollbar {
  display: none;
}
*/
.fvg-sub-container .img-node {
  height: 100%;
}
.fvg-sub-container .img-node a {
  width: 100%;
  height: 100%;
}
.img-node canvas, .img-node img {
  width: 100%;
  height: 100%;
  border-radius: var(--ehvp-thumbnail-border-radius);
}
.img-node-numtip {
  position: absolute;
  top: 0;
  left: 0.5em;
  font-size: 1.8em;
  font-weight: 900;
  height: 1.8em;
  line-height: 1.8em;
  text-shadow: 0px 0px 3px #000000;
  color: var(--ehvp-theme-font-color);
  display: none;
}
.img-node:hover .img-node-numtip {
  display: block;
}
.img-node > a {
  display: block;
  line-height: 0;
  position: relative;
  z-index: 1;
  width: 100%;
  height: 100%;
}
.img-node-actions {
  position: absolute;
  bottom: 10px;
  height: 1.2em;
  left: 0;
  z-index: 1;
}
.img-node-action-btn {
  line-height: 1.2em;
  border: 1px solid #efe;
  text-align: center;
  border-radius: 5px;
  color: #efe;
  font-weight: 900;
  background-color: #1f1f1fc7;
  margin-left: 0.3em;
  text-shadow: #000 1px 0 10px;
  cursor: pointer;
}
.img-node-action-btn:hover {
  border: 1px solid yellow;
  color: yellow;
}
.img-node-action-btn-processing {
  animation: btn-rotate 1s linear infinite;
}
.img-node-action-btn-done {
  border: 1px solid #6eff84;
  color: #6eff84;
}
.img-node-action-btn-error {
  border: 1px solid red;
  color: red;
}
@keyframes btn-rotate {
	0% {
    transform: rotate(0.0turn);
	}
	100% {
    transform: rotate(1.0turn);
	}
}
.ehvp-chapter-description, .img-node-error-hint {
  display: block;
  position: absolute;
  bottom: 0px;
  left: 0px;
  background-color: #708090e3;
  color: #ffe785;
  width: 100%;
  font-weight: 700;
  min-height: 3em;
  font-size: 0.8em;
  padding: 0.5em;
  box-sizing: border-box;
  line-height: 1.3em;
  z-index: 10;
}
.img-node-error-hint {
  color: #8a0000;
}
.img-fetched {
  background-color: var(--ehvp-img-fetched);
}
.img-fetch-failed {
  background-color: var(--ehvp-img-failed);
}
.img-fetching {
  background-color: var(--ehvp-img-fetching);
}
.img-excluded {
  filter: brightness(0.3);
}
.img-fetching::after {
  content: '';
  position: absolute;
  top: 0%;
  left: 0%;
  width: 30%;
  height: 30%;
  background-color: #ff0000;
  animation: img-loading 1s linear infinite;
}
@keyframes img-loading {
	25% {
    background-color: #ff00ff;
    top: 0%;
    left: 70%;
	}
	50% {
    background-color: #00ffff;
    top: 70%;
    left: 70%;
	}
	75% {
    background-color: #ffff00;
    top: 70%;
    left: 0%;
	}
}
.big-img-frame::-webkit-scrollbar {
  display: none;
}
.big-img-frame {
  position: fixed;
  width: 100%;
  height: 100%;
  top: 0;
  right: 0;
  overflow: auto;
  scrollbar-width: none;
  z-index: 2001;
  background: var(--ehvp-big-images-bg);
  display: flex;
}
.bifm-container > div {
  box-sizing: border-box;
}
.bifm-container-vert {
  width: ${h.conf.imgScale}%;
  height: fit-content;
  margin: 0 auto;
}
.bifm-container-hori {
  width: fit-content;
  height: ${h.conf.imgScale}%;
  margin: auto 0;
  display: flex;
  flex-wrap: nowrap;
}
.bifm-container-page {
  width: fit-content;
  height: ${h.conf.imgScale}%;
  margin: 0 auto;
  display: flex;
  flex-wrap: nowrap;
}
.bifm-container-vert > div {
  margin: var(--ehvp-big-images-gap) 0px;
}
.bifm-container-hori > div {
  margin: 0px var(--ehvp-big-images-gap);
}
.bifm-container-page > div {
  height: 100%;
  margin: 0px var(--ehvp-big-images-gap);
  display: flex;
}
.bifm-node-hide {
  position: fixed;
  left: -100%;
  z-index: -1000;
  opacity: 0;
}
.bifm-container-page .bifm-img {
  ${h.conf.imgScale===100&&h.conf.paginationIMGCount===1?"max-width: 100%;":""}
}
.bifm-img {
  height: 100%;
  object-fit: contain;
  display: block;
}
.bifm-rotate-90 {
  transform: rotate(90deg);
  width: 100vh;
  height: 100vw;
  transform-origin: 0px 0px;
  left: 100vw;
}
.bifm-rotate-180 {
  transform: rotate(180deg);
}
.bifm-rotate-270 {
  transform: rotate(270deg);
  width: 100vh;
  height: 100vw;
  transform-origin: 0px 0px;
  left: 0px;
  top: 100vh;
}
#bifm-loading-helper {
  position: fixed;
  z-index: 3000;
  display: none;
  padding: 0px 3px;
  background-color: #ffffff90;
  font-weight: blod;
  left: 0px;
}
.ehvp-root-collapse .big-img-frame {
  position: unset;
}
.p-helper {
  position: fixed;
  z-index: 2011 !important;
  box-sizing: border-box;
  top: ${h.conf.pageHelperAbTop};
  left: ${h.conf.pageHelperAbLeft};
  bottom: ${h.conf.pageHelperAbBottom};
  right: ${h.conf.pageHelperAbRight};
}
.p-panel {
  z-index: 2012 !important;
  background-color: var(--ehvp-theme-bg-color);
  box-sizing: border-box;
  position: fixed;
  color: var(--ehvp-theme-font-color);
  padding: 3px;
  border-radius: 4px;
  font-weight: 800;
  overflow: hidden;
  width: 24em;
  height: 32em;
  max-height: 75vh;
  border: var(--ehvp-panel-border);
  box-shadow: var(--ehvp-panel-box-shadow);
}
.clickable {
  text-decoration-line: underline;
  user-select: none;
  text-align: center;
  white-space: nowrap;
}
.clickable:hover {
  color: var(--ehvp-clickable-color-hover) !important;
}
.p-collapse {
  height: 0px !important;
  padding: 0px !important;
  border: none !important;
}
.b-main {
  display: flex;
  user-select: none;
  flex-direction: ${h.conf.pageHelperAbLeft==="unset"?"row-reverse":"row"};
  flex-wrap: wrap-reverse;
}
.b-main-item {
  box-sizing: border-box;
  border: var(--ehvp-controlbar-border);
  border-radius: 4px;
  background-color: var(--ehvp-theme-bg-color);
  color: var(--ehvp-theme-font-color);
  font-weight: 800;
  padding: 0em 0.3em;
  margin: 0em 0.2em;
  position: relative;
  white-space: nowrap;
  font-size: 1em;
  line-height: 1.2em;
}
.b-main-option {
  padding: 0em 0.2em;
}
.b-main-option-selected {
  color: black;
  background-color: #ffffffa0;
  border-radius: 6px;
}
.b-main-btn {
  display: inline-block;
  width: 1em;
}
.b-main-input {
  color: var(--ehvp-theme-font-color);
  background-color: var(--ehvp-theme-bg-color);
  border-radius: 6px;
  display: inline-block;
  text-align: center;
  width: 1.5em;
  cursor: ns-resize;
}
.chapter-thumbnail {
  width: auto;
  height: 100%;
  aspect-ratio: 1 / 1;
  position: relative;
}
.chapter-thumbnail > #chapter-thumbnail-image-container {
  position: absolute;
  width: 100%;
  height: 100%;
  display: flex;
  just-content: center;
  items-align: center;
  z-index: 1;
}
.chapter-thumbnail > #chapter-thumbnail-image-container > img {
  object-fit: contain;
  display: block;
  height: 100%;
  min-width: 100%;
}
.chapter-thumbnail > canvas {
  width: 100%;
  height: 100%;
  /**
  filter: blur(3px) brightness(0.5);
  */
}
.chapter-list {
  height: 100%;
  width: 100%;
  overflow: hidden auto;
  scrollbar-width: none;
  border-left: 2px solid black;
}
.chapter-list::-webkit-scrollbar {
  display: none;
}
.chapter-list-item {
  width: 100%;
  padding-left: 0.7em;
  white-space: nowrap;
  line-height: 1.8em;
  text-decoration: underline;
}
.chapter-list-item:hover {
  background-color: #cddee3ab;
}
.chapter-list-item-hl {
  filter: brightness(150%);
  background-color: #84c5ff6b;
}
.p-chapters {
  width: 34em;
  height: 18em;
  display: flex;
  max-height: 80%;
  max-width: 100%;
}
.p-chapters-large {
  width: 45em;
  height: 25em;
}
.p-chapters-large .chapter-thumbnail {
  width: auto;
  height: 100%;
}
.p-config {
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  align-content: start;
  line-height: 2em;
  overflow: auto scroll;
  scrollbar-width: none;
}
.p-config::-webkit-scrollbar {
  display: none;
}
.p-config label {
  display: flex;
  justify-content: space-between;
  padding-right: 10px;
  margin-bottom: unset;
}
.p-config input {
  cursor: ns-resize;
}
.p-downloader {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  align-items: center;
}
.p-downloader canvas {
  /* border: 1px solid greenyellow; */
}
.p-downloader .download-notice {
  text-align: center;
  width: 100%;
}
.p-downloader .downloader-btn-group {
  align-items: center;
  text-align: right;
  width: 100%;
}
.p-btn {
  color: var(--ehvp-theme-font-color);
  cursor: pointer;
  font-weight: 800;
  background-color: var(--ehvp-theme-bg-color);
  vertical-align: middle;
  width: 1.5em;
  height: 1.5em;
  border: 1px solid #000000;
  border-radius: 4px;
}
@keyframes main-progress {
  from {
    width: 0%;
  }
  to {
    width: 100%;
  }
}
.big-img-frame-collapse {
  display: none;
}
.ehvp-root-collapse .img-land,
.big-img-frame-collapse .img-land,
.ehvp-root-collapse .ehvp-message-box,
.ehvp-root-collapse .p-panel
 {
  display: none !important;
}
.download-bar {
  background-color: #33333310;
  height: 0.3em;
  width: 100%;
  bottom: -0.5em;
  position: absolute;
  box-sizing: border-box;
  z-index: 2;
}
.download-bar > div {
  background-color: var(--ehvp-img-fetched);
  height: 100%;
  border: none;
}
.img-land-left, .img-land-right {
  width: 15%;
  height: 50%;
  position: fixed;
  z-index: 2004;
  top: 25%;
}
.img-land-left {
  left: 0;
  cursor: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC3UlEQVR4nO2ZS28TMRDHV0APcON1gXKisUMRJ0QFJ74EAgQfhMclF15nCqk2noTHcVF2nDRCqBc+AZUKRYR3U0olaODK47JoNiqU0mjX9uymSPlLI0Vayfv72157ZuJ5Qw01lLMCL9gKxfAESLwMAutK4nMQ+BWE/tkL+o3z8bNi41Kl2Dhe8kpbvEGrdhAPKKlvKIlLIHVkGB9A4vXKWH00d/DqWLAXhPaV0D8swP8K1RujfK8Y7s4FXkk8B0J/cQXfwEhXCTyTGbh/1B8BqRU3OPxjBKdKJx9vY4Zv7lBSP8waHlZNSGzRO5ng/ZE84WGNCZaVyGPbQP8ou8KfHyB8RFEV4WkreDrWQOIKF8jsZDuaq7wy30pCd33R3GM++0L7nPCrsjEBEm8ZwdPtyHFJrYe3N4Hf7xam96c2QOlBVvCk2dtt8/EEXksFT0lWL0/JBv7ZnTdW4ymJS5Q0JhroZZXZwM/ff+s0riqEE8kGKCXOAL4dLERQdJsYJfTFFPsfQ274l/VOVD3UcP6mQOCD5BWgwoMR/jUu8sDLeAWepjBgnir3g3/36GNUG+eBhzhwJXkLGZ7//eDfzywzw+v4PmA1UB1vRAszy3xnvWQwYLqFaoebfU3YpQ3abQvZfMR5mVDpPmKs2wyejwkMMr3IMjch8EKiAWo6ubwkSxO+aB5LlcwpqRc3nQmBndTdPOqYuS43twkl9NVU8JwFTT8TTyZfZFvQkKgj4GpgIxPm8Jpm/6ZnKjUe7FJSf+Y0YQnfte6bQkGf5TBAYZuRVqQ+ZQX/eyUETnGZyGXrrBfVoS5FjnUIPc3W5O01d7GVI3wzGA22e5yi2eA6mZK2TYm7vb5W1KvkbDnCn/jk/MGaHLHU7qMLxnnGJX6jWS8fae308hbdjtQxs8qdBHZA4BWQep83aMUJYCGcoL4NtT6o8KDKjtKROCWJqzyco2eUElNWuSn+Zh1qKO//1y8OuBKqSFLycQAAAABJRU5ErkJggg=="), auto;
}
.img-land-right {
  right: 0;
  cursor: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAADG0lEQVR4nO2ZS2tTQRTHL2oXuvO10bqymYkVV2LRlV9CVPQrdO9jE/ANPvCZcjvToju5mpxJGqtWwZ1QH4UWa1WotTUWtNWt1VJHTi6V2KbJnZmTW4X8YaAQuPP7z5nHOaee11BDDTkr8IKVMpndIzkclwwygsOwZPBNMvUzHPg3vCr9lswd60zmdqe81ApvudW9FbYIrs4JDkXJlTYcHyWHs50tmebYwbtago2SKV8w9cMC/K8hwm+kbyWz62OBFxwOSaa+uoJXMDItGByoG7i/02+SXAlqcLnICHSk9j5ZRQyfXyO46q03vJw3waGAcxLB+01xwssyEySRiGPbyKVH2hX+8DLCaxxdLLvfCh6vNclhynTCR+39+sXl13Rbialpn+U3mK8+U77pZI/b+/Xc7JxGvbwyQhgJuG4Ej6+j6SNVDj8vukjAzM1Ez+bIBjA9MJ1k9F5RV9Lzi8M0JhiciQSPSVaYpxgettacHi0sYeKSeyQEhyImjTUNhFml3SRVTRBEQiSybbUNYErsMEk1E88uuJkQTB2NsP8h67pSVU2cdzDB4E7tCGDhQXDoljTxS+unJ4dsIzAUwQBdqty9Pa8/9E1WNnFi0OKbMFV7CxEUKfUzATOxG8AxcONNxfMwcnuM3gB1tTVwrTL827vjumtbjn4LUR3iqvAZG3gV9RBDpp7w72DCCl6GEQjq/pBVg8d8Ca9X628zOFLTADad6gH/vreou13gudI+y++KlMwJriZI4e9/coaXDMYjd/OwY0YG/4AAnpcO8OlI8LYFDSZqCzX2kAZemhY0YRRU2nSichNjfZOlV9gdXuHqX/VMJVqDdYKrLzYmiOGnrfumMqEO2kxqf8+rRaOTq31W8H8iwaCDCiaWrbNQWIdSFDnGg6kesiZv2NyFQozw+aA5WO1RClfD5may2TYp6vZ6ubBXadNyjDA+Ox9YkysW2334wDivOIfvuOrpHYW1XtzC1xE7Zla5E4NxyeCU5GqTt9wqJYCJbBv2bbD1gYUHVnaYjpRSklKVB4P4G6bEmFX+E/9mbagh7//Xb5hJEJPq8mugAAAAAElFTkSuQmCC"), auto;
}
.p-tooltip { }
.p-tooltip .p-tooltiptext {
  display: none;
  max-width: 34em;
  background-color: var(--ehvp-theme-bg-color);
  color: var(--ehvp-theme-font-color);
  border-radius: 6px;
  position: fixed;
  z-index: 1;
  font-size: small;
  white-space: normal;
  text-align: left;
  padding: 0.3em 1em;
  box-sizing: border-box;
  pointer-events: none;
}
.page-loading {
  width: 100%;
  height: 100%;
  justify-content: center;
  align-items: center;
  background-color: #333333a6;
}
.page-loading-text {
  color: var(--ehvp-theme-font-color);
  font-size: 6em;
}
@keyframes rotate {
	100% {
		transform: rotate(1turn);
	}
}
.border-ani {
	position: relative;
	z-index: 0;
	overflow: hidden;
}
.border-ani::before {
	content: '';
	position: absolute;
	z-index: -2;
	left: -50%;
	top: -50%;
	width: 200%;
	height: 200%;
	background-color: #fff;
	animation: rotate 4s linear infinite;
}
.border-ani::after {
	content: '';
	position: absolute;
	z-index: -1;
	left: 6px;
	top: 6px;
	width: calc(100% - 16px);
	height: calc(100% - 16px);
	background-color: #333;
}
.overlay-tip {
  position: absolute;
  z-index: 10;
  font-weight: 800;
  top: 0.3em;
  right: 0.3em;
  font-size: 0.8em;
  color: var(--ehvp-theme-font-color);
  text-shadow: 0px 0px 3px #000000;
}
.lightgreen { color: #90ea90; }
.ehvp-full-panel {
  position: fixed;
  width: 100%;
  height: 100%;
  background-color: #000000e8;
  z-index: 3000;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  top: 0;
}
.ehvp-custom-panel {
  min-width: 50vw;
  min-height: 50vh;
  max-width: 80vw;
  max-height: 80vh;
  background-color: var(--ehvp-theme-bg-color);
  border: 1px solid #000000;
  display: flex;
  flex-direction: column;
  text-align: start;
  color: var(--ehvp-theme-font-color);
  position: relative;
  user-select: none;
}
.ehvp-custom-panel-title {
  font-size: 1.8em;
  line-height: 2em;
  font-weight: 800;
  display: flex;
  justify-content: space-between;
  padding-left: 1em;
}
.ehvp-custom-panel-close {
  width: 2em;
  text-align: center;
}
.ehvp-custom-panel-close:hover {
  background-color: #c3c0e0;
}
.ehvp-custom-panel-container {
  overflow: auto;
  scrollbar-width: thin;
}
.ehvp-custom-panel-content {
  border: 1px solid #000000;
  border-radius: 4px;
  margin: 0.5em;
  padding: 0.5em;
}
.ehvp-custom-panel-item {
  margin: 0.2em 0em;
}
.ehvp-custom-panel-item-title {
  font-size: 1.4em;
}
.ehvp-custom-panel-item-values {
  margin-top: 0.3em;
  text-align: end;
  line-height: 1.3em;
}
.ehvp-custom-panel-item-value {
  font-size: 1.1em;
  font-weight: 800;
  color: black;
  background-color: #c5c5c5;
  border: 1px solid #000000;
  box-sizing: border-box;
  margin-left: 0.3em;
  display: inline-flex;
}
.ehvp-custom-panel-item-value span {
  padding: 0em 0.5em;
}
.ehvp-custom-panel-item-value button {
  background-color: #fff;
  color: black;
  border: none;
}
.ehvp-custom-panel-item-value button:hover {
  background-color: #ffff00;
}
.ehvp-custom-panel-item-input, .ehvp-custom-panel-item-span {
  font-size: 1.1em;
  font-weight: 800;
  background-color: #7fef7b;
  color: black;
  border: none;
}
.ehvp-custom-panel-item-span {
  background-color: #34355b;
  color: white;
}
.ehvp-custom-panel-item-add-btn:hover {
  background-color: #ffff00 !important;
}
.ehvp-custom-panel-list > li {
  line-height: 3em;
  margin-left: 0.5em;
  font-size: 1.4em;
}
.ehvp-custom-panel-checkbox:hover {
  border: 1px solid var(--ehvp-theme-font-color);
}
.ehvp-custom-panel-list-item-disable {
  text-decoration: line-through;
  color: red;
}
.ehvp-help-panel > div > h2 {
  color: #c1ffc9;
}
.ehvp-help-panel > div > p {
  font-size: 1.1em;
  margin-left: 1em;
  font-weight: 600;
}
.ehvp-help-panel > div > ul {
  font-size: 1em;
}
.ehvp-help-panel > div a {
  color: #ff5959;
}
.ehvp-help-panel > div strong {
  color: #d76d00;
}
.bifm-vid-ctl {
  position: fixed;
  z-index: 2010;
  padding: 3px 10px;
  bottom: 0.2em;
  ${h.conf.pageHelperAbLeft==="unset"?"left: 0.2em;":"right: 0.2em;"}
}
.bifm-vid-ctl > div {
  display: flex;
  align-items: center;
  line-height: 1.2em;
}
.bifm-vid-ctl > div > * {
  margin: 0 0.1em;
}
.bifm-vid-ctl:not(:hover) .bifm-vid-ctl-btn,
.bifm-vid-ctl:not(:hover) .bifm-vid-ctl-span,
.bifm-vid-ctl:not(:hover) #bifm-vid-ctl-volume
{
  opacity: 0;
}
.bifm-vid-ctl-btn {
  height: 1.5em;
  width: 1.5em;
  font-size: 1.2em;
  padding: 0;
  margin: 0;
  border: none;
  background-color: #00000000;
  cursor: pointer;
}
#bifm-vid-ctl-volume {
  width: 5em;
  height: 0.5em;
}
.bifm-vid-ctl-pg {
  border: 1px solid #00000000;
  background-color: #3333337e;
  -webkit-appearance: none;
}
#bifm-vid-ctl-pg {
  width: 100%;
  height: 0.2em;
  background-color: #333333ee;
}
.bifm-vid-ctl:hover {
  background-color: var(--ehvp-theme-bg-color);
}
.bifm-vid-ctl:hover #bifm-vid-ctl-pg {
  height: 0.8em;
}
.bifm-vid-ctl-pg-inner {
  background-color: #ffffffa0;
  height: 100%;
}
.bifm-vid-ctl:hover #bifm-vid-ctl-pg .bifm-vid-ctl-pg-inner {
  background-color: #fff;
}
.bifm-vid-ctl-span {
  color: white;
  font-weight: 800;
}
.download-middle {
  width: 100%;
  height: auto;
  flex-grow: 1;
  overflow: hidden;
}
.download-middle .ehvp-tabs + div {
  width: 100%;
  height: calc(100% - 2em);
}
.ehvp-tabs {
  height: 2em;
  width: 100%;
  line-height: 2em;
}
.ehvp-p-tab {
  border: 1px dotted #ff0;
  font-size: 1em;
  padding: 0 0.4em;
}
.download-chapters, .download-status, .download-cherry-pick {
  width: 100%;
  height: 100%;
}
.download-chapters {
  overflow: hidden auto;
}
.download-chapters label {
  white-space: nowrap;
}
.download-chapters label span {
  margin-left: 0.5em;
}
.ehvp-p-tab-selected {
  color: rgb(120, 240, 80) !important;
}
.ehvp-message-box {
  position: fixed;
  z-index: 4001;
  top: 0;
  left: 0;
}
.ehvp-message {
  margin-top: 1em;
  margin-left: 1em;
  line-height: 2em;
  background-color: #ffffffd6;
  border-radius: 6px;
  padding-left: 0.3em;
  position: relative;
  box-shadow: inset 0 0 5px 2px #8273ff;
  color: black;
}
.ehvp-message > button {
  border: 1px solid #00000000;
  margin-left: 1em;
  color: black;
  background-color: #00000000;
  height: 2em;
  width: 2em;
  text-align: center;
  font-weight: 800;
}
.ehvp-message > button:hover {
  background-color: #444;
}
.ehvp-message-duration-bar {
  position: absolute;
  bottom: 0;
  width: 0%;
  left: 0;
  height: 0.1em;
  background: red;
}
.ehvp-custom-btn {
  border: 1px solid #000;
  font-weight: 700;
  color: #000;
  background-color: #ffffff80;
}
.ehvp-custom-btn-plain {
  background-color: #aaa;
}
.ehvp-custom-btn-green {
  background-color: #7fef7b;
}
.ehvp-custom-btn:hover {
  border: 1px solid #fff;
  color: #333;
  background-color: #ffffff90;
  filter: brightness(150%);
}
.ehvp-custom-btn:active {
  color: #ccc;
}
.ehvp-custom-panel-list-item-title {
  display: flex;
  justify-content: space-between;
  border-bottom: 2px solid #000;
  padding: 0em 1em;
}
.ehvp-custom-panel-title:hover, .ehvp-custom-panel-list-item-title:hover {
  background-color: #33333388;
}
.s-pickable:hover {
  border: 1px solid red;
  filter: brightness(150%);
}
#tag-candidates > .tc-selected {
  color: red;
  background-color: #fff;
}
#tag-candidates > li:hover {
  color: green;
  background-color: #aaa;
}
#auto-page-progress {
  height: 100%;
  width: 0%;
  position: absolute;
  top: 0px;
  left: 0px;
  background: var(--ehvp-playing-progress-bar-color);
}
@media (max-width: ${X?"1440px":"720px"}) {
  .ehvp-root {
    font-size: 4cqw;
  }
  .ehvp-root-collapse #entry-btn {
    font-size: 2.2em;
  }
  .p-helper {
    bottom: 0px;
    left: 0px;
    top: unset;
    right: unset;
  }
  .b-main {
    flex-direction: row;
  }
  .b-main-item {
    font-size: 1.3em;
    margin-top: 0.2em;
  }
  #pagination-adjust-bar,
  #scale-bar
  {
    display: none;
  }
  .p-panel {
    width: 100%;
    font-size: 5cqw;
  }
  .p-chapters {
    width: 100%;
  }
  .ehvp-custom-panel {
    max-width: 100%;
  }
  .ehvp-root input, .ehvp-root select {
    width: 2em;
    height: 1.2em;
    font-size: 1em;
  }
  .ehvp-root select {
    width: 7em !important;
  }
  .p-btn {
    font-size: 1em;
  }
  .bifm-vid-ctl {
    display: none;
  }
  .ehvp-custom-panel-list-item-title {
    display: block;
  }
  .chapter-thumbnail {
    display: none;
  }
  .bifm-container-hori > div {
    width: 100%;
  }
}
`}class ut{root;panel;canvas;tabStatus;tabChapters;tabCherryPick;statusElement;chaptersElement;cherryPickElement;noticeElement;forceBTN;startBTN;btn;constructor(e){this.root=e,this.btn=v("#downloader-panel-btn",e),this.panel=v("#downloader-panel",e),this.canvas=v("#downloader-canvas",e),this.tabStatus=v("#download-tab-status",e),this.tabChapters=v("#download-tab-chapters",e),this.tabCherryPick=v("#download-tab-cherry-pick",e),this.statusElement=v("#download-status",e),this.chaptersElement=v("#download-chapters",e),this.cherryPickElement=v("#download-cherry-pick",e),this.noticeElement=v("#download-notice",e),this.forceBTN=v("#download-force",e),this.startBTN=v("#download-start",e),this.panel.addEventListener("transitionend",()=>f.emit("downloader-canvas-resize"))}initTabs(){const e=[this.statusElement,this.chaptersElement,this.cherryPickElement],t=[{ele:this.tabStatus,cb:()=>{e.forEach((i,n)=>i.hidden=n!=0),f.emit("downloader-canvas-resize")}},{ele:this.tabChapters,cb:()=>{e.forEach((i,n)=>i.hidden=n!=1)}},{ele:this.tabCherryPick,cb:()=>{e.forEach((i,n)=>i.hidden=n!=2),v("#download-cherry-pick-input",this.cherryPickElement).focus()}}];t.forEach(({ele:i,cb:n},r)=>{i.addEventListener("click",()=>{i.classList.add("ehvp-p-tab-selected"),t.filter((o,a)=>a!=r).forEach(o=>o.ele.classList.remove("ehvp-p-tab-selected")),n()})})}switchTab(e){switch(e){case"status":this.tabStatus.click();break;case"chapters":this.tabChapters.click();break;case"cherry-pick":this.tabCherryPick.click();break}}initNotice(e){this.noticeElement.innerHTML="",e.forEach(t=>{const i=document.createElement("a");i.textContent=t.btn,i.classList.add("clickable"),i.style.color="gray",i.style.margin="0em 0.5em",i.addEventListener("click",t.cb),this.noticeElement.append(i)})}abort(e){this.flushUI(e),this.normalizeBTN()}flushUI(e){this.startBTN.style.color=e==="downloadFailed"?"red":"",this.startBTN.textContent=_[e].get(),this.btn.style.color=e==="downloadFailed"?"red":""}noticeableBTN(){this.btn.classList.contains("lightgreen")||(this.btn.classList.add("lightgreen"),/✓/.test(this.btn.textContent)||(this.btn.textContent+="\u2713"))}normalizeBTN(){this.btn.textContent=this.btn.textContent.replace("\u2713",""),this.btn.classList.remove("lightgreen")}createChapterSelectList(e,t){const i=e.length===1;this.chaptersElement.innerHTML=`
      <div>
        <span id="download-chapters-select-all" class="clickable">Select All</span>
        <span id="download-chapters-unselect-all" class="clickable">Unselect All</span>
        <span id="download-chapters-add-new" class="clickable">Add New Chapters</span>
      </div>
      ${e.map((n,r)=>`<div><label>
        <input type="checkbox" id="ch-${n.id}" value="${n.id}" ${i||t.find(o=>o.index===r)?"checked":""} />
        <span>${n.title}</span></label></div>`).join("")}`,[["#download-chapters-select-all",!0],["#download-chapters-unselect-all",!1]].forEach(([n,r])=>this.chaptersElement.querySelector(n)?.addEventListener("click",()=>e.forEach(o=>{const a=this.chaptersElement.querySelector("#ch-"+o.id);a&&(a.checked=r)}))),this.chaptersElement.querySelector("#download-chapters-add-new")?.addEventListener("click",n=>{function r(o,a,l,c){const d=document.createElement("div");d.style.position="fixed",d.style.zIndex="2100",d.style.padding="3px",d.style.backgroundColor="var(--ehvp-theme-bg-color)",d.style.border="var(--ehvp-panel-border)",d.style.borderRadius="5px",d.innerHTML=`
          <div style="display: flex; justify-content: center; margin: 10px 2px;">${l}</div>
          <div style="display: flex; justify-content: center;">
            <button class="ehvp-custom-btn ehvp-modal-btn-cancel" style="background-color: gray;">Cancel</button>
            <button class="ehvp-custom-btn ehvp-modal-btn-confirm" style="background-color: var(--ehvp-clickable-color-hover);">Confirm</button>
          </div>
        `,o.appendChild(d),d.querySelector(".ehvp-modal-btn-cancel")?.addEventListener("click",()=>d.remove()),d.querySelector(".ehvp-modal-btn-confirm")?.addEventListener("click",()=>c(d).finally(()=>d.remove())),pe(d,a,o.offsetWidth,o.offsetHeight)}r(this.root,n.target,'<input id="download-chapters-add-input" style="width: 250px; background-color: #ffffff80;" placeholder="https://example.com" />',async o=>{const a=o.querySelector("#download-chapters-add-input")?.value;if(!a)return;const l=f.emit("pf-append-chapters",a);l&&await l})})}selectedChapters(){const e=new Set;return this.chaptersElement.querySelectorAll("input[type=checkbox][id^=ch-]:checked").forEach(t=>e.add(Number(t.value))),e}initCherryPick(e,t,i,n){let r=0;function o(w,C,E){w.querySelectorAll(".ehvp-custom-panel-item-value").forEach(U=>U.remove());const T=document.createElement("div");C.forEach(U=>{const H=`<span class="ehvp-custom-panel-item-value" data-id="${U.id}"><span >${U.toString()}</span><span class="ehvp-custom-btn ehvp-custom-btn-plain" style="padding:0;border:none;">&nbspx&nbsp</span></span>`;T.innerHTML=H;const Z=T.firstElementChild;Z.style.backgroundColor=U.positive?"#7fef7b":"#ffa975",w.appendChild(Z),Z.querySelector(".ehvp-custom-btn").addEventListener("click",Ve=>{const _e=Ve.target.parentElement;E(_e.getAttribute("data-id")),_e.remove()}),T.remove()})}const a=v("#download-cherry-pick-btn-add",this.cherryPickElement),l=v("#download-cherry-pick-btn-exclude",this.cherryPickElement),c=v("#download-cherry-pick-btn-clear",this.cherryPickElement),d=v("#download-cherry-pick-btn-range-before",this.cherryPickElement),p=v("#download-cherry-pick-btn-range-after",this.cherryPickElement),u=v("#download-cherry-pick-input",this.cherryPickElement),g=(w,C)=>{const E=C?[G.from((w?"!":"")+C)].filter(T=>T!==null):(u.value||"").split(",").map(T=>(w?"!":"")+T).map(G.from).filter(T=>T!==null);E.length>0&&E.forEach(T=>{const U=e(r,T);U!==null&&o(this.cherryPickElement.firstElementChild,U,H=>t(r,H))}),u.value="",u.focus()},m=()=>{i(r),o(this.cherryPickElement.firstElementChild,[],w=>t(r,w)),u.value="",u.focus()};a.addEventListener("click",()=>g(!1)),l.addEventListener("click",()=>g(!0)),c.addEventListener("click",m),this.cherryPickElement.querySelectorAll(".download-cherry-pick-follow-btn").forEach(w=>{const C=()=>{const E=parseInt(w.getAttribute("data-sibling-step")||"1");let T=w;for(let U=0;U<E;U++)T=T.previousElementSibling;E<=1&&m(),g(E>1,T.getAttribute("data-range")||void 0)};w.addEventListener("click",C)}),u.addEventListener("keypress",w=>w.key==="Enter"&&g(!1));let b=0;f.subscribe("add-cherry-pick-range",(w,C,E,T)=>{const U=new G([C+1,T?(b??C)+1:C+1],E);b=C,o(this.cherryPickElement.firstElementChild,e(w,U)||[],H=>t(w,H))}),f.subscribe("pf-change-chapter",w=>{w!==-1&&(r=w,o(this.cherryPickElement.firstElementChild,n(r)||[],C=>t(r,C)))});let y=0;f.subscribe("pf-on-appended",w=>{y=w.toString().length;const C=p.getAttribute("data-range").split("-").map(T=>T.padStart(y,"0")).join("-");p.textContent=C,p.setAttribute("data-range",C);const E=d.getAttribute("data-range").split("-").map((T,U)=>U===1?w.toString():T.padStart(y,"0")).join("-");d.textContent=E,d.setAttribute("data-range",E)}),f.subscribe("ifq-do",w=>{const C=[1,w+1].map(T=>T.toString().padStart(y,"0")).join("-");p.textContent=C,p.setAttribute("data-range",C);const E=d.getAttribute("data-range").split("-").map((T,U)=>U===0?(w+1).toString().padStart(y,"0"):T).join("-");d.textContent=E,d.setAttribute("data-range",E)})}static html(){return`
<div id="downloader-panel" class="p-panel p-downloader p-collapse">
    <div id="download-notice" class="download-notice" style="font-size: 0.7em;"></div>
    <div id="download-middle" class="download-middle">
      <div class="ehvp-tabs">
        <a id="download-tab-status" class="clickable ehvp-p-tab">${_.status.get()}</a>
        <a id="download-tab-cherry-pick" class="clickable ehvp-p-tab">${_.cherryPick.get()}</a>
        <a id="download-tab-chapters" class="clickable ehvp-p-tab">${_.selectChapters.get()}</a>
      </div>
      <div>
        <div id="download-status" class="download-status" hidden>
          <canvas id="downloader-canvas" width="0" height="0"></canvas>
        </div>
        <div id="download-cherry-pick" class="download-cherry-pick" hidden>
          <div class="ehvp-custom-panel-item-values" style="text-align: start;">
            <div style="margin-bottom: 1rem;display: flex;">
              <input type="text" class="ehvp-custom-panel-item-input" id="download-cherry-pick-input" placeholder="1, 2-3" style="text-align: start; width: 50%; height: 1.3rem; border-radius: 0px;" />
              <span class="ehvp-custom-btn ehvp-custom-btn-green" id="download-cherry-pick-btn-add">Pick</span>
              <span class="ehvp-custom-btn ehvp-custom-btn-plain" id="download-cherry-pick-btn-exclude">Exclude</span>
              <span class="ehvp-custom-btn ehvp-custom-btn-plain" id="download-cherry-pick-btn-clear">Clear</span>
            </div>
            <div style="margin-bottom: 1rem;">
              <div style="margin-bottom: 0.2rem">
                <span class="ehvp-custom-panel-item-span" id="download-cherry-pick-btn-range-after" data-range="1-1">1-1</span><span
                 class="ehvp-custom-btn ehvp-custom-btn-green download-cherry-pick-follow-btn" data-sibling-step="1">pick</span><span
                 class="ehvp-custom-btn ehvp-custom-btn-plain download-cherry-pick-follow-btn" data-sibling-step="2">exclude</span>
              </div>
              <div>
                <span class="ehvp-custom-panel-item-span" id="download-cherry-pick-btn-range-before" data-range="1-1">1-1</span><span
                class="ehvp-custom-btn ehvp-custom-btn-green download-cherry-pick-follow-btn" data-sibling-step="1">pick</span><span
                class="ehvp-custom-btn ehvp-custom-btn-plain download-cherry-pick-follow-btn" data-sibling-step="2">exclude</span>
              </div>
            </div>
          </div>
        </div>
        <div id="download-chapters" class="download-chapters" hidden></div>
      </div>
    </div>
    <div class="download-btn-group">
       <a id="download-force" class="clickable">${_.forceDownload.get()}</a>
       <a id="download-start" style="color: rgb(120, 240, 80)" class="clickable">${_.downloadStart.get()}</a>
    </div>
</div>`}}class gt{root;panel;configSelect;constructor(e){this.root=e,this.panel=v("#config-panel",e),this.configSelect=v("#config-a-select",e)}initEvents(e){this.flushConfigItems(e),this.configSelect.addEventListener("click",t=>{const i=t.target.getAttribute("data-value");i&&(h.conf.selectedSiteNameConfig=i==="global"?void 0:i,console.log("ADAPTER.conf.selectedSiteNameConfig: ",h.conf.selectedSiteNameConfig),Array.from(this.configSelect.querySelectorAll(".b-main-option")).forEach(n=>{n.getAttribute("data-value")===h.conf.selectedSiteNameConfig||n.getAttribute("data-value")==="global"&&h.conf.selectedSiteNameConfig===void 0?n.classList.add("b-main-option-selected"):n.classList.remove("b-main-option-selected")}),this.flushConfigItems(e))}),v("#show-guide-element",this.panel).addEventListener("click",e.showGuideEvent),v("#show-keyboard-custom-element",this.panel).addEventListener("click",e.showKeyboardCustomEvent),v("#show-site-profiles-element",this.panel).addEventListener("click",e.showSiteProfilesEvent),v("#show-style-custom-element",this.panel).addEventListener("click",e.showStyleCustomEvent),v("#show-action-custom-element",this.panel).addEventListener("click",e.showActionCustomEvent),v("#reset-config-element",this.panel).addEventListener("click",()=>{const t=h.conf.selectedSiteNameConfig;qt(t)&&(h.conf=h.globalConf=t?h.globalConf:ge(),h.conf.selectedSiteNameConfig=t,this.flushConfigItems(e))})}flushConfigItems(e){const t=v("#config-panel-header",this.panel);Array.from(this.panel.querySelectorAll(".config-panel-item")).forEach(n=>n.remove());const i=Ke.map(zr).map(n=>{const r=document.createElement("template");return r.innerHTML=n.trim(),r.content.firstElementChild});t.after(...i),Ke.forEach(n=>{switch(n.typ){case"number":v(`#${n.key}MinusBTN`,this.panel).addEventListener("click",()=>e.modNumberConfigEvent(n.key,"minus")),v(`#${n.key}AddBTN`,this.panel).addEventListener("click",()=>e.modNumberConfigEvent(n.key,"add")),v(`#${n.key}Input`,this.panel).addEventListener("wheel",r=>{r.preventDefault(),r.deltaY<0?e.modNumberConfigEvent(n.key,"add"):r.deltaY>0&&e.modNumberConfigEvent(n.key,"minus")});break;case"boolean":v(`#${n.key}Checkbox`,this.panel).addEventListener("click",()=>e.modBooleanConfigEvent(n.key));break;case"select":v(`#${n.key}Select`,this.panel).addEventListener("change",()=>e.modSelectConfigEvent(n.key));break;case"input":v(`#${n.key}TextInput`,this.panel).addEventListener("change",()=>e.modTextConfigEvent(n.key));break}}),this.panel.querySelectorAll(".p-tooltip").forEach(n=>{const r=n.querySelector(".p-tooltiptext");r&&(n.addEventListener("mouseenter",()=>{r.style.display="block",pe(r,n,this.root.offsetWidth,this.root.offsetHeight)}),n.addEventListener("mouseleave",()=>r.style.display="none"))})}static html(){return`
<div id="config-panel" class="p-panel p-config p-collapse">
    <div id="config-panel-header" style="position: sticky;border: 1px solid black;grid-column-start: 1;grid-column-end: 11;padding: 0px 0.3em;top: 0;z-index: 1;background-color: #33333390">
      <div id="config-a-select"
      ><a class="b-main-option clickable ${h.conf.selectedSiteNameConfig===void 0?"b-main-option-selected":""}" data-value="global">${_.global.get()}</a
      ><a class="b-main-option clickable ${h.conf.selectedSiteNameConfig===h.matcher.name?"b-main-option-selected":""}" data-value="${h.matcher.name}">${h.matcher.name}</a></div>
    </div>

    <!-- config items will place here -->
    <div style="grid-column-start: 1; grid-column-end: 11; padding-left: 5px;">
        <label class="p-label">
            <span>${_.dragToMove.get()}:</span>
            <span id="dragHub" style="font-size: 1.85rem;cursor: grab;">\u2720</span>
        </label>
    </div>
    <div style="grid-column-start: 1; grid-column-end: 11; padding-left: 5px; text-align: left;">
         <a id="show-guide-element" class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;">${_.showHelp.get()}</a>
         <a id="show-keyboard-custom-element" class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;">${_.showKeyboard.get()}</a>
         <a id="show-site-profiles-element" class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;">${_.showSiteProfiles.get()}</a>
         <a id="show-style-custom-element" class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;">${_.showStyleCustom.get()}</a>
         <a id="show-action-custom-element" class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;">${_.showActionCustom.get()}</a>
         <a id="reset-config-element" class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;">${_.resetConfig.get()}</a>
         <a class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;" href="https://github.com/MapoMagpie/eh-view-enhance" target="_blank">${_.letUsStar.get()}</a>
    </div>
</div>`}}function zr(s){const e=s.i18nKey||s.key,t=_[e],i=_[`${e}Tooltip`];if(!t)throw new Error(`i18n key ${e} not found`);let n=!0;s.displayInSite&&(n=s.displayInSite.test(location.href));const r=h.conf.selectedSiteNameConfig?h.conf:h.globalConf;let o="";switch(s.typ){case"boolean":o=`<input id="${s.key}Checkbox" ${r[s.key]?"checked":""} type="checkbox" />`;break;case"number":o=`<span>
                  <button id="${s.key}MinusBTN" class="p-btn" type="button">-</button>
                  <input id="${s.key}Input" value="${r[s.key]}" disabled type="text" />
                  <button id="${s.key}AddBTN" class="p-btn" type="button">+</button></span>`;break;case"select":if(!s.options)throw new Error(`options for ${s.key} not found`);const c=s.options.map(d=>`<option value="${d.value}" ${r[s.key]==d.value?"selected":""}>${d.display}</option>`).join("");o=`<select id="${s.key}Select">${c}</select>`;break;case"input":o=`<span><input id="${s.key}TextInput" ${r[s.key]?"value="+r[s.key]:""} class="text-input" placeholder="${s.placeholder??""}" type="text" /></span>`;break}const[a,l]=s.gridColumnRange?s.gridColumnRange:[1,11];return`<div class="config-panel-item" style="grid-column-start: ${a}; grid-column-end: ${l}; padding-left: 5px;${n?"":" display: none;"}"><label class="p-label"><span><span>${t.get()}</span><span class="p-tooltip">${i?" ?:":" :"}<span class="p-tooltiptext">${i?.get()||""}</span></span></span>${o}</label></div>`}class mt{panel;root;thumbnail;thumbnailImg;thumbnailCanvas;listContainer;constructor(e){this.root=e,this.panel=v("#chapters-panel",e),this.thumbnail=v("#chapter-thumbnail",e),this.thumbnailImg=v("#chapter-thumbnail-image",e),this.thumbnailCanvas=v("#chapter-thumbnail-canvas",e),this.listContainer=v("#chapter-list",e),f.subscribe("pf-update-chapters",(t,i)=>{this.updateChapterList(t),t.length>1&&!i&&this.relocateToCenter()}),f.subscribe("pf-change-chapter",(t,i)=>this.updateHighlight(t,i))}updateChapterList(e){const t=this.listContainer.firstElementChild;t.innerHTML="",e.forEach((i,n)=>{const r=document.createElement("div");let o="";i.title instanceof Array?o=i.title.join("	"):o=i.title,r.innerHTML=`<span>${o}</span>`,r.setAttribute("id","chapter-list-item-"+i.id.toString()),r.classList.add("chapter-list-item"),r.addEventListener("click",()=>{i.onclick?.(n),this.panel.classList.contains("p-panel-large")&&(this.panel.classList.add("p-collapse"),this.panel.classList.remove("p-panel-large"),this.panel.classList.remove("p-chapters-large"))}),r.addEventListener("mouseenter",()=>this.updateChapterThumbnail(i)),t.appendChild(r)}),this.updateChapterThumbnail(e[0])}relocateToCenter(){this.panel.classList.remove("p-collapse"),this.panel.classList.add("p-panel-large"),this.panel.classList.add("p-chapters-large");const[e,t]=[this.root.offsetWidth,this.root.offsetHeight],[i,n]=[this.panel.offsetWidth,this.panel.offsetHeight],[r,o]=[e/2-i/2,t/2-n/2];this.panel.style.left=r+"px",this.panel.style.top=o+"px"}updateHighlight(e,t){Array.from(this.listContainer.querySelectorAll("div > .chapter-list-item")).forEach((i,n)=>{n===e?i.classList.add("chapter-list-item-hl"):i.classList.remove("chapter-list-item-hl")}),this.updateChapterThumbnail(t)}updateChapterThumbnail(e){this.thumbnailImg.onload=()=>{const i=this.thumbnailImg.naturalWidth,n=this.thumbnailImg.naturalHeight;let[r,o,a,l]=[0,i,0,n];i>n?(r=Math.floor((i-n)/2),o=n):i<n&&(a=Math.floor((n-i)/2),l=i),this.thumbnailCanvas.width=o,this.thumbnailCanvas.height=l,this.thumbnailCanvas.getContext("2d").drawImage(this.thumbnailImg,r,a,o,l,0,0,i,n)},this.thumbnailImg.src=e.thumbimg??ie,this.thumbnail.querySelector(".ehvp-chapter-description")?.remove();const t=document.createElement("div");t.classList.add("ehvp-chapter-description"),Array.isArray(e.title)?t.innerHTML=e.title.map(i=>`<span>${i}</span>`).join("<br>"):t.innerHTML=`<span>${e.title}</span>`,this.thumbnail.appendChild(t)}static html(){return`
<div id="chapters-panel" class="p-panel p-chapters p-panel-large p-collapse">
    <div id="chapter-thumbnail" class="chapter-thumbnail">
      <div id="chapter-thumbnail-image-container" style="display:none;">
        <img id="chapter-thumbnail-image" src="${ie}" alt="thumbnail" />
      </div>
      <canvas id="chapter-thumbnail-canvas" width="100" height="100"></canvas>
    </div>
    <div id="chapter-list" class="chapter-list">
      <div></div>
    </div>
</div>`}}class ft{panel;root;filter;input;list;candidates;candidatasFragment;candidateSelectIndex=0;candidateCached=[];constructor(e,t){this.root=e,this.panel=v("#filter-panel",e),this.input=v("#tag-input",this.panel),this.list=v("#tag-list",this.panel),this.candidates=v("#tag-candidates",this.panel),this.candidatasFragment=document.createDocumentFragment(),this.filter=t,this.input.addEventListener("click",()=>f.emit("filter-update-all-tags")),this.input.addEventListener("input",()=>{this.candidateSelectIndex=0,this.updateCandidates(!1)}),this.input.addEventListener("keyup",i=>{if(console.log("keypress ev: ",i),i.key.toLowerCase()==="arrowup")this.candidateSelectIndex=this.candidateSelectIndex-1,this.updateCandidates(!0),i.preventDefault();else if(i.key.toLowerCase()==="arrowdown")this.candidateSelectIndex=this.candidateSelectIndex+1,this.updateCandidates(!0),i.preventDefault();else if(i.key.toLowerCase()==="enter"){const n=this.candidateCached[this.candidateSelectIndex];this.input.value="",n&&(this.filter.push(!0,n),this.updateFilterValues()),this.candidates.hidden=!0}})}updateCandidates(e){if(this.input.value.length===0){this.candidates.hidden=!0;return}const t=this.input.value.trim();if(e||(this.candidateCached=[...this.filter.allTags].filter(n=>!t||n.includes(t))),this.candidateCached.length>500){this.candidates.hidden=!0;return}this.candidateSelectIndex=Math.max(0,this.candidateSelectIndex),this.candidateSelectIndex=Math.min(this.candidateCached.length-1,this.candidateSelectIndex);let i;for(let n=0;n<this.candidateCached.length;n++){const r=this.candidateCached[n],o=document.createElement("li");o.textContent=r.toString(),n===this.candidateSelectIndex&&(o.classList.add("tc-selected"),i=o),o.addEventListener("click",a=>{const l=a.target.textContent;l&&(this.input.value="",this.filter.push(!0,l),this.updateFilterValues(),this.candidates.hidden=!0)}),this.candidatasFragment.appendChild(o)}this.candidates.innerHTML="",this.candidates.append(...Array.from(this.candidatasFragment.childNodes)),this.candidates.hidden=!1,i?.scrollIntoView({block:"center"})}updateFilterValues(){this.list.innerHTML="";for(const e of this.filter.values){const t=document.createElement("li");t.textContent=e.tag,t.addEventListener("click",i=>{const n=i.target.textContent;n&&(this.filter.remove(n),this.updateFilterValues())}),this.list.appendChild(t)}}static html(){return`
<div id="filter-panel" class="p-panel p-filter p-collapse">
    <div style="position: relative;">
      <input id="tag-input" class="tag-input" style="width:76%; margin-top:0.6em; margin-left: 12%;"/>
      <div id="tag-candidates" style="position:absolute; width:100%; min-height:1em; max-height:15em; overflow:auto; background-color:#444; margin-top:0; top:100%;" hidden="true"></div>
    </div>
    <div>
      <ul id="tag-list" class="tag-list">
      <span>Filter the images, unfinished!</span>
      </ul>
    </div>
</div>`}}function Gr(s){const e=/https?:\/\/[^\s<>"']+/g;return s.replace(e,t=>{const i=Vr(t);return`<a target="_blank" href="${i}">${i}</a>`})}function Vr(s){return s.replace(/[&<>"']/g,e=>{switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#39;";default:return e}})}function jr(s){const e=document.createElement("div"),t=lt();e.id="ehvp-base",e.setAttribute("style","all: initial"),document.body.after(e);const i=`
<div id="page-loading" class="page-loading" style="display: none;">
    <div class="page-loading-text border-ani">Loading...</div>
</div>
<div id="message-box" class="ehvp-message-box"></div>
<div id="ehvp-nodes-container" class="full-view-grid" tabindex="6"></div>
<div id="big-img-frame" class="big-img-frame big-img-frame-collapse" tabindex="7">
   <a id="img-land-left" class="img-land img-land-left"></a>
   <a id="img-land-right" class="img-land img-land-right"></a>
</div>
<div id="p-helper" class="p-helper">
    <div>
        ${gt.html()}
        ${ut.html()}
        ${mt.html()}
        ${ft.html()}
    </div>
    <div id="b-main" class="b-main">
        <a id="entry-btn" class="b-main-item clickable" data-display-texts="${t.entry},${t.collapse}">${t.entry}</a>
        <div id="page-status" class="b-main-item" hidden>
            <a class="clickable" id="p-curr-page" style="color:#ffc005;">1</a><span id="p-slash-1">/</span><span id="p-total">0</span>
        </div>
        <div id="fin-status" class="b-main-item" hidden>
            <span>${t.fin}:</span><span id="p-finished">0</span>
        </div>
        <a id="auto-page-btn" class="b-main-item clickable" hidden data-status="paused" data-display-texts="${t.autoPagePlay},${t.autoPagePause}">
           <span>${t.autoPagePlay}</span>
           <div id="auto-page-progress"></div>
        </a>
        <a id="config-panel-btn" class="b-main-item clickable" hidden>${t.config}</a>
        <a id="downloader-panel-btn" class="b-main-item clickable" hidden>${t.download}</a>
        <a id="chapters-panel-btn" class="b-main-item clickable" hidden>${t.chapters}</a>
        <a id="filter-panel-btn" class="b-main-item clickable" hidden>${t.filter}</a>
        <div id="read-mode-bar" class="b-main-item" hidden>
            <div id="read-mode-select"
            ><a class="b-main-option clickable ${h.conf.readMode==="pagination"?"b-main-option-selected":""}" data-value="pagination">${t.pagination}</a
            ><a class="b-main-option clickable ${h.conf.readMode==="continuous"?"b-main-option-selected":""}" data-value="continuous">${t.continuous}</a
            ><a class="b-main-option clickable ${h.conf.readMode==="horizontal"?"b-main-option-selected":""}" data-value="horizontal">${t.horizontal}</a></div>
        </div>
        <div id="pagination-adjust-bar" class="b-main-item" hidden>
            <span>
              <a id="paginationStepPrev" class="b-main-btn clickable" type="button">&lt;</a>
              <a id="paginationMinusBTN" class="b-main-btn clickable" type="button">-</a>
              <span id="paginationInput" class="b-main-input">${h.conf.paginationIMGCount}</span>
              <a id="paginationAddBTN" class="b-main-btn clickable" type="button">+</a>
              <a id="paginationStepNext" class="b-main-btn clickable" type="button">&gt;</a>
            </span>
        </div>
        <div id="scale-bar" class="b-main-item" hidden>
            <span>
              <span>${Be.zoomIcon}</span>
              <a id="scaleMinusBTN" class="b-main-btn clickable" type="button">-</a>
              <span id="scaleInput" class="b-main-input" style="width: 3rem; cursor: move;">${h.conf.imgScale}</span>
              <a id="scaleAddBTN" class="b-main-btn clickable" type="button">+</a>
            </span>
        </div>
    </div>
</div>
`,n=e.attachShadow({mode:"open"}),r=document.createElement("div");r.classList.add("ehvp-root"),r.classList.add("ehvp-root-collapse"),r.innerHTML=i;const o=document.createElement("style");o.innerHTML=Br();const a=document.createElement("style");return a.id="ehvp-style-custom",a.innerHTML=h.conf.customStyle,n.append(o),r.append(a),n.append(r),{root:r,fullViewGrid:v("#ehvp-nodes-container",r),bigImageFrame:v("#big-img-frame",r),pageHelper:v("#p-helper",r),configPanelBTN:v("#config-panel-btn",r),downloaderPanelBTN:v("#downloader-panel-btn",r),chaptersPanelBTN:v("#chapters-panel-btn",r),filterPanelBTN:v("#filter-panel-btn",r),entryBTN:v("#entry-btn",r),currPageElement:v("#p-curr-page",r),totalPageElement:v("#p-total",r),finishedElement:v("#p-finished",r),imgLandLeft:v("#img-land-left",r),imgLandRight:v("#img-land-right",r),autoPageBTN:v("#auto-page-btn",r),pageLoading:v("#page-loading",r),messageBox:v("#message-box",r),config:new gt(r),downloader:new ut(r),chapters:new mt(r),filter:new ft(r,s),readModeSelect:v("#read-mode-select",r),paginationAdjustBar:v("#pagination-adjust-bar",r),styleSheet:o.sheet}}function Fr(s,e,t,i,n){e.config.initEvents(s);const r={config:{panel:e.config.panel,btn:e.configPanelBTN},downloader:{panel:e.downloader.panel,btn:e.downloaderPanelBTN,cb:()=>i.check()},chapters:{panel:e.chapters.panel,btn:e.chaptersPanelBTN},filter:{panel:e.filter.panel,btn:e.filterPanelBTN}};function o(l){h.conf.autoCollapsePanel&&!l.classList.contains("p-panel-large")&&s.collapsePanelEvent(l,l.id),t.visible?e.bigImageFrame.focus():e.fullViewGrid.focus()}Object.entries(r).forEach(([l,c])=>{c.panel.addEventListener("mouseleave",()=>o(c.panel)),c.panel.addEventListener("blur",()=>o(c.panel)),c.btn.addEventListener("click",()=>{s.togglePanelEvent(l,void 0,c.btn),c.cb?.()})});let a=!1;e.pageHelper.addEventListener("mouseover",()=>{a=!0,s.abortMouseleavePanelEvent(),n.minify(n.lastStage,!0)}),e.pageHelper.addEventListener("mouseleave",()=>{a=!1,Object.values(r).forEach(l=>o(l.panel)),setTimeout(()=>!a&&n.minify(n.lastStage,!1),700)}),e.entryBTN.addEventListener("click",()=>{let l=e.entryBTN.getAttribute("data-stage")||"exit";l=l==="open"?"exit":"open",e.entryBTN.setAttribute("data-stage",l),f.emit("toggle-main-view",l==="open")}),e.currPageElement.addEventListener("wheel",l=>{t.callbackOnWheel?.(),t.stepNext(l.deltaY>0?"next":"prev",l.deltaY>0?-1:1,parseInt(e.currPageElement.textContent)-1)}),document.addEventListener("keydown",l=>s.keyboardEvent(l)),document.addEventListener("mouseup",l=>s.keyboardEvent(l)),e.fullViewGrid.addEventListener("keydown",l=>{s.fullViewGridKeyBoardEvent(l),l.stopPropagation()}),e.fullViewGrid.addEventListener("mouseup",l=>{s.fullViewGridKeyBoardEvent(l),l.stopPropagation()}),e.bigImageFrame.addEventListener("keydown",l=>{s.bigImageFrameKeyBoardEvent(l),l.stopPropagation()}),e.bigImageFrame.addEventListener("mouseup",l=>{s.bigImageFrameKeyBoardEvent(l),l.stopPropagation()}),e.imgLandLeft.addEventListener("click",l=>{t.callbackOnWheel?.(),t.stepNext(h.conf.reversePages?"next":"prev"),l.stopPropagation()}),e.imgLandRight.addEventListener("click",l=>{t.callbackOnWheel?.(),t.stepNext(h.conf.reversePages?"prev":"next"),l.stopPropagation()}),Dr(e.pageHelper,{onFinish:()=>{h.conf.pageHelperAbTop=e.pageHelper.style.top,h.conf.pageHelperAbLeft=e.pageHelper.style.left,h.conf.pageHelperAbBottom=e.pageHelper.style.bottom,h.conf.pageHelperAbRight=e.pageHelper.style.right,q({pageHelperAbTop:h.conf.pageHelperAbTop,pageHelperAbLeft:h.conf.pageHelperAbLeft,pageHelperAbBottom:h.conf.pageHelperAbBottom,pageHelperAbRight:h.conf.pageHelperAbRight},h.conf.selectedSiteNameConfig)},onMoving:l=>{e.pageHelper.style.top=l.top===void 0?"unset":`${l.top}px`,e.pageHelper.style.bottom=l.bottom===void 0?"unset":`${l.bottom}px`,e.pageHelper.style.left=l.left===void 0?"unset":`${l.left}px`,e.pageHelper.style.right=l.right===void 0?"unset":`${l.right}px`;const c=Y(e.styleSheet,".b-main");c&&(c.style.flexDirection=l.left===void 0?"row-reverse":"row")}},v("#dragHub",e.pageHelper)),e.readModeSelect.addEventListener("click",l=>{const c=l.target.getAttribute("data-value");c&&(s.changeReadModeEvent(c,h.matcher.name),n.minify(n.lastStage))}),v("#paginationStepPrev",e.pageHelper).addEventListener("click",()=>{t.callbackOnWheel?.(),t.stepNext(h.conf.reversePages?"next":"prev",h.conf.reversePages?-1:1)}),v("#paginationStepNext",e.pageHelper).addEventListener("click",()=>{t.callbackOnWheel?.(),t.stepNext(h.conf.reversePages?"prev":"next",h.conf.reversePages?1:-1)}),v("#paginationMinusBTN",e.pageHelper).addEventListener("click",()=>s.modNumberConfigEvent("paginationIMGCount","minus",void 0,h.matcher.name)),v("#paginationAddBTN",e.pageHelper).addEventListener("click",()=>s.modNumberConfigEvent("paginationIMGCount","add",void 0,h.matcher.name)),v("#paginationInput",e.pageHelper).addEventListener("wheel",l=>s.modNumberConfigEvent("paginationIMGCount",l.deltaY<0?"add":"minus",void 0,h.matcher.name)),v("#scaleInput",e.pageHelper).addEventListener("mousedown",l=>{const c=l.target,d=h.conf.imgScale||(h.conf.readMode==="continuous"?h.conf.defaultImgScaleModeC:100);Ur(l,c,{},p=>{if(p.distance===0)return;const u=(p.direction&3)===1?1:-1;t.scaleBigImages(1,0,Math.floor(d+p.distance*.6*u)),c.textContent=h.conf.imgScale.toString()})}),v("#scaleMinusBTN",e.pageHelper).addEventListener("click",()=>t.scaleBigImages(-1,10)),v("#scaleAddBTN",e.pageHelper).addEventListener("click",()=>t.scaleBigImages(1,10)),v("#scaleInput",e.pageHelper).addEventListener("wheel",l=>t.scaleBigImages(l.deltaY>0?-1:1,5))}function Hr(s,e,t,i){t=Gr(t);const n=document.createElement("div");n.classList.add("ehvp-message"),n.innerHTML=`<span ${e==="error"?"style='color: red;'":""}>${t}</span><button>X</button><div class="ehvp-message-duration-bar"></div>`,s.appendChild(n),n.querySelector("button")?.addEventListener("click",()=>n.remove());const r=n.querySelector("div.ehvp-message-duration-bar");i&&(r.style.animation=`${i}ms linear main-progress`,r.addEventListener("animationend",()=>n.remove()))}class Wr{html;chapterIndex=-1;pageNumInChapter=[];lastStage="exit";chapters;downloading;constructor(e,t,i){this.html=e,this.chapters=t,this.downloading=i,f.subscribe("pf-change-chapter",n=>{let r=0;n>=0&&(r=this.pageNumInChapter[n]||0),this.chapterIndex=n;const[o,a]=(()=>{const l=this.chapters()[n]?.filteredQueue;if(!l)return[0,0];const c=l.filter(d=>d.stage===z.DONE).length;return[l.length,c]})();this.setPageState({finished:a.toString(),total:o.toString(),current:(r+1).toString()}),this.minify(this.lastStage)}),f.subscribe("bifm-on-show",()=>this.minify("bigImageFrame")),f.subscribe("bifm-on-hidden",()=>this.minify("fullViewGrid")),f.subscribe("ifq-do",(n,r)=>{r.chapterIndex!==this.chapterIndex||!this.chapters()[this.chapterIndex]?.filteredQueue||(this.pageNumInChapter[this.chapterIndex]=n,this.setPageState({current:(n+1).toString()}))}),f.subscribe("ifq-on-finished-report",(n,r)=>{r.chapterIndex===this.chapterIndex&&(this.setPageState({finished:r.finishedIndex.size.toString()}),A("info",`No.${n+1} Finished\uFF0CCurrent index at No.${r.currIndex+1}`))}),f.subscribe("pf-on-appended",(n,r,o,a)=>{this.chapterIndex>-1&&o!==this.chapterIndex||this.setPageState({total:`${n}${a?"":".."}`})}),e.currPageElement.addEventListener("click",n=>{const r=n.target,o=parseInt(r.textContent||"1")-1;if(this.chapterIndex>=0){const a=this.chapters()[this.chapterIndex]?.filteredQueue;if(!a||!a[o])return;f.emit("imf-on-click",a[o])}})}setPageState({total:e,current:t,finished:i}){e!==void 0&&(this.html.totalPageElement.textContent=e),t!==void 0&&(this.html.currPageElement.textContent=t),i!==void 0&&(this.html.finishedElement.textContent=i)}minify(e,t=!1){this.lastStage=e;let i=[0,0];if(e==="exit")i=[0,0];else switch(e){case"fullViewGrid":h.conf.minifyPageHelper==="never"||h.conf.minifyPageHelper==="inBigMode"?i=[1,1]:i=t?[1,1]:[3,1];break;case"bigImageFrame":h.conf.minifyPageHelper==="never"?i=[2,2]:i=t?[2,2]:[3,2];break}function n(p,u=!1){switch(p){case 0:return u?["entry-btn","page-status","fin-status"]:["entry-btn"];case 1:return["page-status","fin-status","auto-page-btn","config-panel-btn","downloader-panel-btn","chapters-panel-btn","filter-panel-btn","entry-btn"];case 2:return["page-status","fin-status","auto-page-btn","config-panel-btn","downloader-panel-btn","chapters-panel-btn","entry-btn","read-mode-bar","pagination-adjust-bar","scale-bar"];case 3:return["page-status","auto-page-btn"]}return[]}const r=p=>p==="chapters-panel-btn"?this.chapters().length>1:p==="filter-panel-btn"?h.conf.enableFilter:p==="auto-page-btn"&&i[0]===3?this.html.pageHelper.querySelector("#auto-page-btn")?.getAttribute("data-status")==="playing":p==="pagination-adjust-bar"?h.conf.readMode==="pagination":!0,o=n(i[0],this.downloading()).filter(r),a=n(i[1],this.downloading()).filter(r),l=Array.from(this.html.pageHelper.querySelectorAll(".b-main > .b-main-item"));for(const p of l){const u=o.indexOf(p.id);p.style.order=u===-1?"99":u.toString(),p.style.opacity=u===-1?"0":"1",p.hidden=!a.includes(p.id)}const c=this.html.pageHelper.querySelector("#entry-btn"),d=c.getAttribute("data-display-texts").split(",");c.textContent=e==="exit"?d[0]:d[1]}}function bt(s,e,t){s.addEventListener("mousedown",i=>{const{left:n}=s.getBoundingClientRect(),r=o=>{const a=o.clientX-n,l=Math.round(a/s.clientWidth*100);e(l)};r(i),s.addEventListener("mousemove",r),s.addEventListener("mouseup",()=>{s.removeEventListener("mousemove",r)},{once:!0}),s.addEventListener("mouseleave",()=>{s.removeEventListener("mousemove",r)},{once:!0})},{signal:t})}const wt='<svg width="1.4rem" height="1.4rem" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M106.854 106.002a26.003 26.003 0 0 0-25.64 29.326c16 124 16 117.344 0 241.344a26.003 26.003 0 0 0 35.776 27.332l298-124a26.003 26.003 0 0 0 0-48.008l-298-124a26.003 26.003 0 0 0-10.136-1.994z"/></svg>',Zr='<svg width="1.4rem" height="1.4rem" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M120.16 45A20.162 20.162 0 0 0 100 65.16v381.68A20.162 20.162 0 0 0 120.16 467h65.68A20.162 20.162 0 0 0 206 446.84V65.16A20.162 20.162 0 0 0 185.84 45h-65.68zm206 0A20.162 20.162 0 0 0 306 65.16v381.68A20.162 20.162 0 0 0 326.16 467h65.68A20.162 20.162 0 0 0 412 446.84V65.16A20.162 20.162 0 0 0 391.84 45h-65.68z"/></svg>',Xr='<svg width="1.4rem" height="1.4rem" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <path fill="#fff" d="M10.0012 8.99984H9.1C8.53995 8.99984 8.25992 8.99984 8.04601 9.10883C7.85785 9.20471 7.70487 9.35769 7.60899 9.54585C7.5 9.75976 7.5 10.0398 7.5 10.5998V13.3998C7.5 13.9599 7.5 14.2399 7.60899 14.4538C7.70487 14.642 7.85785 14.795 8.04601 14.8908C8.25992 14.9998 8.53995 14.9998 9.1 14.9998H10.0012C10.5521 14.9998 10.8276 14.9998 11.0829 15.0685C11.309 15.1294 11.5228 15.2295 11.7143 15.3643C11.9305 15.5164 12.1068 15.728 12.4595 16.1512L15.0854 19.3023C15.5211 19.8252 15.739 20.0866 15.9292 20.1138C16.094 20.1373 16.2597 20.0774 16.3712 19.9538C16.5 19.811 16.5 19.4708 16.5 18.7902V5.20948C16.5 4.52892 16.5 4.18864 16.3712 4.04592C16.2597 3.92233 16.094 3.86234 15.9292 3.8859C15.7389 3.9131 15.5211 4.17451 15.0854 4.69733L12.4595 7.84843C12.1068 8.27166 11.9305 8.48328 11.7143 8.63542C11.5228 8.77021 11.309 8.87032 11.0829 8.93116C10.8276 8.99984 10.5521 8.99984 10.0012 8.99984Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',vt='<svg width="1.4rem" height="1.4rem" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M16 9.50009L21 14.5001M21 9.50009L16 14.5001M4.6 9.00009H5.5012C6.05213 9.00009 6.32759 9.00009 6.58285 8.93141C6.80903 8.87056 7.02275 8.77046 7.21429 8.63566C7.43047 8.48353 7.60681 8.27191 7.95951 7.84868L10.5854 4.69758C11.0211 4.17476 11.2389 3.91335 11.4292 3.88614C11.594 3.86258 11.7597 3.92258 11.8712 4.04617C12 4.18889 12 4.52917 12 5.20973V18.7904C12 19.471 12 19.8113 11.8712 19.954C11.7597 20.0776 11.594 20.1376 11.4292 20.114C11.239 20.0868 11.0211 19.8254 10.5854 19.3026L7.95951 16.1515C7.60681 15.7283 7.43047 15.5166 7.21429 15.3645C7.02275 15.2297 6.80903 15.1296 6.58285 15.0688C6.32759 15.0001 6.05213 15.0001 5.5012 15.0001H4.6C4.03995 15.0001 3.75992 15.0001 3.54601 14.8911C3.35785 14.7952 3.20487 14.6422 3.10899 14.4541C3 14.2402 3 13.9601 3 13.4001V10.6001C3 10.04 3 9.76001 3.10899 9.54609C3.20487 9.35793 3.35785 9.20495 3.54601 9.10908C3.75992 9.00009 4.03995 9.00009 4.6 9.00009Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';class Kr{ui;paused=!1;abort;elementID;root;constructor(e){this.root=e,this.ui=this.create(this.root),this.flushUI()}show(){this.ui.root.hidden=!1}hidden(){this.ui.root.hidden=!0}create(e){const t=document.createElement("div");return t.classList.add("bifm-vid-ctl"),t.innerHTML=`
<div>
  <button id="bifm-vid-ctl-play" class="bifm-vid-ctl-btn">${wt}</button>
  <button id="bifm-vid-ctl-mute" class="bifm-vid-ctl-btn">${vt}</button>
    <div id="bifm-vid-ctl-volume" class="bifm-vid-ctl-pg">
      <div class="bifm-vid-ctl-pg-inner" style="width: 30%"></div>
    </div>
  <span id="bifm-vid-ctl-time" class="bifm-vid-ctl-span">00:00</span>
  <span class="bifm-vid-ctl-span">/</span>
  <span id="bifm-vid-ctl-duration" class="bifm-vid-ctl-span">10:00</span>
  <!-- <span id = "bifm-vid-ctl-drag" class="bifm-vid-ctl-span" style = "cursor: grab;">\u2720</span> -->
</div>
<div>
    <div id="bifm-vid-ctl-pg" class="bifm-vid-ctl-pg">
      <div class="bifm-vid-ctl-pg-inner" style="width: 30%"></div>
    </div>
</div>
`,e.appendChild(t),{root:t,playBTN:v("#bifm-vid-ctl-play",t),volumeBTN:v("#bifm-vid-ctl-mute",t),volumeProgress:v("#bifm-vid-ctl-volume",t),progress:v("#bifm-vid-ctl-pg",t),time:v("#bifm-vid-ctl-time",t),duration:v("#bifm-vid-ctl-duration",t)}}flushUI(e,t){const{value:i,max:n}=e?{value:e.time,max:e.duration}:{value:0,max:10},r=i/n*100;this.ui.progress.firstElementChild.style.width=`${r}%`,this.ui.time.textContent=yt(i),this.ui.duration.textContent=yt(n),!t&&(this.ui.playBTN.innerHTML=this.paused?wt:Zr,this.ui.volumeBTN.innerHTML=h.conf.muted?vt:Xr,this.ui.volumeProgress.firstElementChild.style.width=`${h.conf.volume||30}%`)}attach(e){this.detach(),this.show(),this.abort=new AbortController;const t={time:e.currentTime,duration:e.duration};this.flushUI(t),e.addEventListener("timeupdate",i=>{const n=i.target;t&&(t.time=n.currentTime,this.flushUI(t,!0))},{signal:this.abort.signal}),e.onwaiting=()=>A("debug","onwaiting"),e.onended=()=>{e.currentTime=0,e.play()},e.muted=h.conf.muted||!1,e.volume=Math.min(1,(h.conf.volume||30)/100),this.paused||e.play(),this.elementID=e.id,this.elementID||(this.elementID="vid-"+Math.random().toString(36).slice(2),e.id=this.elementID),this.ui.playBTN.addEventListener("click",()=>{const i=this.getVideoElement();i&&(this.paused=!this.paused,this.paused?i.pause():i.play(),this.flushUI(t))},{signal:this.abort.signal}),this.ui.volumeBTN.addEventListener("click",()=>{const i=this.getVideoElement();i&&(h.conf.muted=!h.conf.muted,i.muted=h.conf.muted,q({muted:i.muted}),this.flushUI(t))},{signal:this.abort.signal}),bt(this.ui.progress,i=>{const n=this.getVideoElement();n&&(n.currentTime=n.duration*(i/100),t.time=n.currentTime,this.flushUI(t))},this.abort.signal),bt(this.ui.volumeProgress,i=>{const n=this.getVideoElement();n&&(h.conf.volume=Math.min(100,i),n.volume=Math.min(1,h.conf.volume/100),q({volume:h.conf.volume}),this.flushUI(t))},this.abort.signal)}detach(){const e=this.getVideoElement();e&&e.pause(),this.elementID=void 0,this.abort?.abort(),this.abort=void 0,this.flushUI(),this.hidden()}getVideoElement(){return this.root.querySelector(`#${this.elementID}`)}}function yt(s){const e=Math.floor(s/60).toString().padStart(2,"0"),t=Math.floor(s%60).toString().padStart(2,"0");return`${e}:${t}`}class _t{element;scrolling=!1;step;distance=0;additional=0;lastDirection;directionChanged=!1;scrollMargin;maxScrollMargin;setScrollMargin;constructor(e,t,i){this.element=e,this.step=t||1,i&&i==="x"?(this.scrollMargin=()=>this.element.scrollLeft,this.maxScrollMargin=()=>this.element.scrollWidth-this.element.clientWidth,this.setScrollMargin=n=>this.element.scrollLeft=n):(this.scrollMargin=()=>this.element.scrollTop,this.maxScrollMargin=()=>this.element.scrollHeight-this.element.clientHeight,this.setScrollMargin=n=>this.element.scrollTop=n)}scroll(e,t){t&&(this.step=t);let i;const n=new Promise(c=>i=c);this.distance=Math.abs(e);const r=e<0?"up":"down";if(this.directionChanged=this.lastDirection!==void 0&&this.lastDirection!==r,this.scrolling||this.distance<=0)return n;const o=e/this.distance;this.lastDirection=r,this.additional=0,this.scrolling=!0;const a=()=>{this.scrolling=!1,this.directionChanged=!1,this.lastDirection=void 0,this.distance=0,i?.()},l=()=>{if(!this.scrolling)return a();this.distance-=this.step+this.additional;let c=this.scrollMargin()+(this.step+this.additional)*o;if(c=Math.max(c,0),c=Math.min(c,this.maxScrollMargin()),this.setScrollMargin(c),this.distance<=0||this.directionChanged||c===0||c===this.maxScrollMargin())return a();window.requestAnimationFrame(l)};return window.requestAnimationFrame(l),n}}class ye{id;x;y;constructor(e,t,i){this.id=e,this.x=t,this.y=i}static from(e){return new ye(e.identifier,e.clientX,e.clientY)}distance(e){return Ct({x:this.x,y:this.y},{x:e.x,y:e.y})}direction(e){const t=this.x-e.x,i=this.y-e.y,n=Math.abs(t),r=Math.abs(i);return n>r?t>0?"L":"R":i>0?"U":"D"}}class Yr{element;trail={};handlers;constructor(e,t){this.element=e,this.handlers=t,this.element.addEventListener("touchstart",i=>this.start(i)),this.element.addEventListener("touchmove",i=>this.move(i)),this.element.addEventListener("touchend",i=>this.end(i))}start(e){const t=Array.from(e.targetTouches).map(ye.from);this.trail=t.reduce((n,r)=>(n[r.id]=[r],n),{});let i=0;t.length===2&&(i=t[0].distance(t[1])),this.handlers.start?.(i,e)}move(e){const t=Array.from(e.targetTouches).map(ye.from);if(t.forEach(i=>{const n=this.trail[i.id];n[n.length-1].distance(i)>30&&n.push(i)}),Object.keys(this.trail).length===2&&t.length===2){const i=t[0],n=t[1];this.handlers.zoom?.(i.distance(n),e);return}}end(e){const t=Object.keys(this.trail).map(Number);if(t.length===1&&this.trail[t[0]].length>1){const i=this.trail[t[0]];let n;for(let r=0,o=1;o<i.length;r++,o++)if(!n)n=i[r].direction(i[o]);else if(i[r].direction(i[o])!==n)return;this.handlers.swipe?.(n,e)}if(t.length===2){const i=this.trail[t[0]],n=this.trail[t[1]];if(i.length>1&&n.length>1){const r=[i[0],i[i.length-1]],o=[n[0],n[n.length-1]],{angle:a,clockwise:l}=Jr(r,o);this.handlers.rotate?.(l,a,e)}}this.trail={},this.handlers.end?.(e)}}function Ct(s,e){const t=s.x-e.x,i=s.y-e.y;return Math.sqrt(t*t+i*i)}function Jr(s,e){if(s.length!==2||e.length!==2)throw new Error("line1 or line2 length must be 2");[s,e].forEach(([u,g])=>{if(u.x===g.x&&u.y===g.y)throw new Error(`start at ${u.toString()}, end at ${g.toString()}, not line`)});const t={x:s[1].x-s[0].x,y:s[1].y-s[0].y},i={x:e[1].x-e[0].x,y:e[1].y-e[0].y},n=t.x*i.x+t.y*i.y,r=Math.sqrt(t.x**2+t.y**2),o=Math.sqrt(i.x**2+i.y**2),a=n/(r*o),l=Math.acos(a),d=t.x*i.y-t.y*i.x<=0;return{angle:l*(180/Math.PI),clockwise:d}}class Qr{root;container;observer;intersectingElements=[];renderingElements=[];currentIndex=0;preventStep={currentPreventFinished:!1};debouncer;callbackOnWheel;visible=!1;html;vidController;chapterIndex=0;getChapter;loadingHelper;currLoadingState=new Map;scrollerY;scrollerX;lastMouse;pageNumInChapter=[];oriented="next";intersectingIndexLock=!1;constructor(e,t){switch(this.html=e,this.root=e.bigImageFrame,this.debouncer=new W,this.getChapter=t,this.scrollerY=new _t(this.root),this.scrollerX=new _t(this.root,void 0,"x"),this.container=document.createElement("div"),this.container.classList.add("bifm-container"),h.conf.readMode){case"continuous":this.container.classList.add("bifm-container-vert");break;case"pagination":this.container.classList.add("bifm-container-page");break;case"horizontal":this.container.classList.add("bifm-container-hori");break}this.observer=new IntersectionObserver(i=>this.intersecting(i),{root:this.root}),this.root.appendChild(this.container),this.initEvent(),f.subscribe("pf-on-appended",(i,n,r)=>{r===this.chapterIndex&&this.append(n)}),f.subscribe("pf-change-chapter",i=>{this.chapterIndex=Math.max(0,i),this.container.innerHTML=""}),f.subscribe("imf-on-click",i=>this.show(i)),f.subscribe("imf-on-finished",(i,n,r)=>{if(r.chapterIndex!==this.chapterIndex||(this.currLoadingState.delete(i),this.debouncer.addEvent("FLUSH-LOADING-HELPER",()=>this.flushLoadingHelper(),20),!n))return;const o=this.renderingElements.find(a=>oe(a)===i);o&&(o.innerHTML="",o.appendChild(this.newMediaNode(r)))}),f.subscribe("imf-resize",i=>{i.chapterIndex===this.chapterIndex&&this.onResize(i)}),f.subscribe("bifm-rotate-image",()=>this.rotate(!0)),this.loadingHelper=document.createElement("span"),this.loadingHelper.id="bifm-loading-helper",this.root.appendChild(this.loadingHelper),f.subscribe("imf-download-state-change",i=>{if(i.chapterIndex!==this.chapterIndex)return;const[n,r]=[this.currentIndex,this.currentIndex+(h.conf.readMode!=="pagination"?1:h.conf.paginationIMGCount)];i.index<n||i.index>=r||(this.currLoadingState.set(i.index,Math.floor(i.downloadState.loaded/i.downloadState.total*100)),this.debouncer.addEvent("FLUSH-LOADING-HELPER",()=>this.flushLoadingHelper(),20))}),new eo(this,e.autoPageBTN)}onResize(e){const t=this.container.querySelector(`div[d-index="${e.index}"]`),i=this.container.querySelector(`div[d-index="${this.currentIndex}"]`);if(!(!t||!i))if(h.conf.readMode==="continuous"){const n=i.offsetTop,r=this.root.scrollTop;t.style.aspectRatio=e.ratio().toString(),n!==i.offsetTop&&(this.root.scrollTop=i.offsetTop+(n-r))}else{const n=i.offsetLeft,r=this.root.scrollLeft;t.style.aspectRatio=e.ratio().toString(),h.conf.readMode==="pagination"&&e.index===this.currentIndex?this.jumpTo(this.currentIndex):n!==i.offsetLeft&&(this.root.scrollLeft=i.offsetLeft-(n-r))}}intersecting(e){for(const t of e)if(t.isIntersecting){const i=t.target;if(oe(i)===-1)continue;this.intersectingElements.push(i)}else{const i=this.intersectingElements.indexOf(t.target);i>-1&&this.intersectingElements.splice(i,1)}if(this.intersectingIndexLock)if(this.intersectingElements.find(i=>this.currentIndex===oe(i)))this.intersectingIndexLock=!1;else return;this.debouncer.addEvent("rendering-images",()=>this.rendering(),50)}rendering(){const e=this.intersectingElements.map(l=>({index:oe(l),elem:l}));e.filter(l=>l.index>-1).sort((l,c)=>l.index-c.index),h.conf.reversePages&&e.reverse();const t=e.map(l=>l.elem);if(t.length===0)return;let i=t[0],[n,r]=[0,h.conf.paginationIMGCount];for(;(i=i.previousElementSibling)&&n<r;)t.unshift(i),n++;for(i=t[t.length-1],n=0;(i=i.nextElementSibling)&&n<r;)t.push(i),n++;const o=[],a=[];for(const l of this.renderingElements)t.includes(l)?a.push(l):o.push(l);o.forEach(l=>l.innerHTML="");for(const l of t)if(!a.includes(l)){l.innerHTML="";const c=this.getIMF(l);c&&l.appendChild(this.newMediaNode(c))}this.renderingElements=t}getIMF(e){const t=oe(e);return t===-1||isNaN(t)?null:this.getChapter(this.chapterIndex).filteredQueue[t]??null}initEvent(){this.root.addEventListener("wheel",e=>this.onWheel(new WheelEvent("wheel",{deltaY:h.conf.scrollingDelta*(e.deltaY<0?-1:1),buttons:e.buttons,button:e.button}),void 0,void 0,void 0,e)),this.root.addEventListener("scroll",e=>this.onScroll(e),{passive:!1}),this.root.addEventListener("contextmenu",e=>{e.preventDefault()}),this.root.addEventListener("mousedown",e=>{if(e.button!==0||e.target.classList.contains("img-land"))return;let t=!1;const i={x:e.clientX,y:e.clientY};let n={x:e.clientX,y:e.clientY},r;const o=new AbortController,[a,l]=[this.root.scrollTop,this.root.scrollLeft];this.root.addEventListener("mouseup",c=>{o.abort(),t?h.conf.magnifier&&h.conf.imgScale===100&&(this.scaleBigImages(1,0,h.conf.imgScale,!1),[this.root.scrollTop,this.root.scrollLeft]=[a,l]):this.hidden(c),t=!1},{once:!0}),this.root.addEventListener("mousemove",c=>{if(h.conf.dragImageOut){t=!0;return}if(!X){if(!t){if(Ct(i,{x:c.clientX,y:c.clientY})<20)return;if(h.conf.magnifier&&h.conf.imgScale===100&&this.scaleBigImages(1,0,150,!1),h.conf.readMode==="pagination"){const p=this.intersectingElements;p.length>0&&(r=p[p.length-1].offsetLeft+p[p.length-1].offsetWidth-p[0].offsetLeft)}}t=!0,this.debouncer.addEvent("BIG-IMG-MOUSE-MOVE",()=>{to(this.root,c,n,r),n={x:c.clientX,y:c.clientY}},5)}},{signal:o.signal})}),new Yr(this.root,{start:()=>{h.conf.readMode==="pagination"&&(this.root.style.overflow="hidden")},swipe:e=>{h.conf.readMode==="continuous"||h.conf.readMode==="horizontal"||(this.oriented=(()=>{switch(e){case"L":return h.conf.reversePages?"next":"prev";case"R":return h.conf.reversePages?"prev":"next";case"U":return"next";case"D":return"prev"}})(),this.callbackOnWheel?.(),this.stepNext(this.oriented),h.conf.readMode==="pagination"&&(this.root.style.overflow=""))},rotate:(e,t)=>{}})}cherryPickCurrent(e){f.emit("add-cherry-pick-range",this.chapterIndex,this.currentIndex,!e,!1);const t=h.conf.readMode==="pagination"&&h.conf.paginationIMGCount>1,i=this.currentIndex+h.conf.paginationIMGCount-1;t&&f.emit("add-cherry-pick-range",this.chapterIndex,i,!e,!0);const n=`${e?"Excluded":"Selected"} Image${t?"s":""} no.${this.currentIndex+1}${t?"-"+(i+1):""}`;f.emit("notify-message","info",n,1e3)}rotate(e){const t=["bifm-rotate-90","bifm-rotate-180","bifm-rotate-270",""];e||t.reverse();let i=t.findIndex(r=>this.root.classList.contains(r));i===-1?i=e?3:0:this.root.classList.remove(t[i]);const n=(i+1)%4;t[n]!==""&&this.root.classList.add(t[n])}scrollStop(){this.scrollerY.scrolling=!1,this.scrollerX.scrolling=!1}hidden(e){e&&e.target&&e.target.tagName==="SPAN"||(this.visible=!1,f.emit("bifm-on-hidden"),this.html.fullViewGrid.focus(),this.vidController?.detach(),this.root.classList.add("big-img-frame-collapse"),this.renderingElements.forEach(t=>t.innerHTML=""),this.renderingElements=[],this.intersectingIndexLock=!1)}show(e){this.visible=!0,this.currentIndex=e.index,this.intersectingIndexLock=!0,this.root.classList.remove("big-img-frame-collapse"),this.root.focus(),this.debouncer.addEvent("TOGGLE-CHILDREN-D",()=>e.chapterIndex===this.chapterIndex&&this.setNow(e),100),f.emit("bifm-on-show")}setNow(e){this.currentIndex=e.index,this.pageNumInChapter[this.chapterIndex]=e.index,this.visible&&this.jumpTo(e.index),f.emit("ifq-do",e.index,e,this.oriented??"next"),this.lastMouse=void 0,this.currLoadingState.clear(),this.flushLoadingHelper()}append(e){if(h.conf.readMode==="pagination")return;const t=[],i=this.root.scrollWidth;for(const r of e){const o=document.createElement("div");o.style.aspectRatio=r.ratio().toString(),o.setAttribute("d-index",r.index.toString()),t.push(o),this.observer.observe(o)}const n=h.conf.readMode!=="continuous"&&h.conf.reversePages;if(this.container.childElementCount===0){const r=window.innerWidth/window.innerHeight,o=document.createElement("div");o.style.aspectRatio=r.toString(),o.setAttribute("d-index","-1"),t.unshift(o);const a=document.createElement("div");a.style.aspectRatio=r.toString(),a.setAttribute("d-index","-1"),t.push(a)}else t.push(n?this.container.firstElementChild:this.container.lastElementChild);n?(t.reverse(),this.container.prepend(...t),this.root.scrollLeft=this.root.scrollLeft+this.root.scrollWidth-i):this.container.append(...t)}changeLayout(){switch(this.resetScaleBigImages(!0),h.conf.readMode){case"continuous":this.container.classList.remove("bifm-container-hori","bifm-container-vert","bifm-container-page"),this.container.classList.add("bifm-container-vert");break;case"pagination":this.container.classList.remove("bifm-container-hori","bifm-container-vert","bifm-container-page"),this.container.classList.add("bifm-container-page");break;case"horizontal":this.container.classList.remove("bifm-container-hori","bifm-container-vert","bifm-container-page"),this.container.classList.add("bifm-container-hori");break}this.container.innerHTML="",this.intersectingElements=[],this.renderingElements=[];const e=this.getChapter(this.chapterIndex).filteredQueue;this.append(e),this.jumpTo(this.currentIndex)}jumpTo(e){switch(h.conf.readMode){case"pagination":{const t=this.setElements();this.container.offsetWidth>this.root.offsetWidth&&(h.conf.reversePages?this.root.scrollLeft=this.container.offsetWidth-this.root.offsetWidth:this.root.scrollLeft=0),this.root.scrollTop=0,t[0].firstElementChild&&this.tryPlayVideo(t[0].firstElementChild);break}case"horizontal":{const t=this.container.querySelector(`div[d-index="${e}"]`);if(!t)return;h.conf.reversePages?this.root.scrollLeft=t.offsetLeft-this.root.offsetWidth+t.offsetWidth:this.root.scrollLeft=t.offsetLeft;break}case"continuous":{const t=this.container.querySelector(`div[d-index="${e}"]`);if(!t)return;const i=this.root.offsetHeight,n=t.offsetHeight;let r=e===0?0:Math.floor((i-n)/2);r=Math.max(0,r),this.root.scrollTop=t.offsetTop-r;break}}}stepNext(e,t=0,i){this.oriented=e;let n=i||this.currentIndex;if(n===void 0||isNaN(n))return;const r=this.getChapter(this.chapterIndex)?.filteredQueue;!r||r.length===0||(n=e==="next"?n+h.conf.paginationIMGCount:n-h.conf.paginationIMGCount,h.conf.paginationIMGCount>1&&(n+=t),n<-h.conf.paginationIMGCount?n=r.length-1:n=Math.max(0,n),r[n]&&(this.resetPreventStep(),this.setNow(r[n])))}checkCurrent(){const e=this.root.getBoundingClientRect(),t=h.conf.readMode==="continuous"?(i,n)=>i.top<=n.height/2&&i.bottom>=n.height/2:(i,n)=>i.left<=n.width/2&&i.right>=n.width/2;for(const i of this.intersectingElements){const n=i.getBoundingClientRect();if(t(n,e)){const r=this.getIMF(i);if(r===null||r.index===this.currentIndex)continue;f.emit("ifq-do",r.index,r,this.oriented),this.currentIndex=r.index,this.pageNumInChapter[this.chapterIndex]=r.index,i.firstElementChild&&this.tryPlayVideo(i.firstElementChild);break}}}onScroll(e){switch(h.conf.readMode){case"continuous":{const[t,i]=[this.container.children.item(1),this.container.children.item(this.container.children.length-2)];let n=t.offsetTop??0;this.root.scrollTop<n-3?this.root.scrollTop=n-2:(n=i?i.offsetTop+i.offsetHeight-this.root.offsetHeight:this.root.scrollHeight,this.root.scrollTop>n+3&&(this.root.scrollTop=n+2));break}case"pagination":break;case"horizontal":{const[t,i]=[this.container.children.item(1),this.container.children.item(this.container.children.length-2)];let n=t?.offsetLeft??0;this.root.scrollLeft<n-3?this.root.scrollLeft=n-2:(n=i?i.offsetLeft+i.offsetWidth-this.root.offsetWidth:this.root.scrollWidth,this.root.scrollLeft>n+3&&(this.root.scrollLeft=n+2));break}}h.conf.readMode!=="pagination"&&this.debouncer.addEvent("bifm-on-wheel",()=>this.checkCurrent(),69)}onWheel(e,t,i,n,r){const o=()=>{e.preventDefault(),r?.preventDefault()};if(n||this.callbackOnWheel?.(),e.buttons===2){o(),this.scaleBigImages(e.deltaY>0?-1:1,5);return}const[a,l]=e.deltaY>0?["next","prev"]:["prev","next"];switch(this.oriented=a,h.conf.readMode){case"pagination":{const c=this.checkOverflow(),[d,p]=h.conf.reversePages?[l,this.oriented]:[this.oriented,l];if(this.root.classList.contains("bifm-rotate-90")||this.root.classList.contains("bifm-rotate-270")){this.stepNext(this.oriented);break}if(c[this.oriented].overY-1<=0&&c[d].overX-1<=0){if(o(),!t&&(c[p].overX>0||c[l].overY>0)&&this.tryPreventStep())break;this.stepNext(this.oriented);break}let g=this.oriented==="next"?1:-1;i&&c[this.oriented].overY>0&&this.scrollerY.scroll(Math.min(c[this.oriented].overY,Math.abs(e.deltaY*3))*g,Math.abs(Math.ceil(e.deltaY/4))),g=g*(h.conf.reversePages?-1:1),c[this.oriented].overY-1<=0&&c[d].overX>0&&this.scrollerX.scroll(Math.min(c[d].overX,Math.abs(e.deltaY*3))*g,Math.abs(Math.ceil(e.deltaY/4)));break}case"horizontal":{o(),this.scrollerX.scroll(e.deltaY*(h.conf.reversePages?-1:1),h.conf.scrollingSpeed);break}case"continuous":{i&&this.scrollerY.scroll(e.deltaY,h.conf.scrollingSpeed);break}}}resetPreventStep(e){this.preventStep.ani?.cancel(),this.preventStep.ele?.remove(),this.preventStep={currentPreventFinished:e??!1}}tryPreventStep(){if(h.conf.preventScrollPageTime===0)return!1;if(this.preventStep.currentPreventFinished)return this.resetPreventStep(),!1;if(!this.preventStep.ele){const e=document.createElement("div");if(e.style.width="100vw",e.style.position="fixed",e.style.display="flex",e.style.justifyContent="center",e.style.bottom="0px",e.innerHTML='<div style="width: 30vw;height: 0.1rem;background-color: #1b00ff59;text-align: center;font-size: 0.8rem;position: relative;font-weight: 800;color: gray;border-radius: 7px;border: 1px solid #510000;"><span style="position: absolute;bottom: -3px;"></span></div>',this.root.appendChild(e),this.preventStep.ele=e,h.conf.preventScrollPageTime>0){const t=e.children[0].animate([{width:"30vw"},{width:"0vw"}],{duration:h.conf.preventScrollPageTime});t.onfinish=()=>this.preventStep.ele&&this.resetPreventStep(!0),this.preventStep.ani=t}this.preventStep.currentPreventFinished=!1}return!0}checkOverflow(){const e=Array.from(this.container.querySelectorAll("div:not(.bifm-node-hide)"));if(e.length===0)return{prev:{overX:0,overY:0},next:{overX:0,overY:0},elements:[]};const t=this.root.getBoundingClientRect().left,i=e[0].getBoundingClientRect(),n=e[e.length-1].getBoundingClientRect();return{prev:{overX:Math.round(i.left)*-1+t,overY:Math.round(i.top)*-1},next:{overX:Math.round(n.right)-this.root.offsetWidth,overY:Math.round(i.bottom)-this.root.offsetHeight},elements:e}}restoreScrollTop(e,t){this.root.scrollTop=this.getRealOffsetTop(e)-t}getRealOffsetTop(e){return e.offsetTop}newMediaNode(e){if(e.contentType?.startsWith("video")){const t=document.createElement("video");return t.classList.add("bifm-img"),t.classList.add("bifm-vid"),t.draggable=h.conf.dragImageOut,t.onloadeddata=()=>{this.visible&&e.index===this.currentIndex&&this.tryPlayVideo(t)},t.src=e.node.blobSrc,t}else{const t=document.createElement("img");return t.decoding="async",t.classList.add("bifm-img"),t.draggable=h.conf.dragImageOut,e.stage===z.DONE?t.src=e.node.blobSrc:e.node.thumbnailSrc?t.src=e.node.thumbnailSrc:t.src=ie,t}}tryPlayVideo(e){e instanceof HTMLVideoElement?(this.vidController||(this.vidController=new Kr(this.html.root)),this.vidController.attach(e)):this.vidController?.detach()}scaleBigImages(e,t,i,n){let r=h.conf.imgScale,o=i??r+t*e;switch(h.conf.readMode){case"pagination":{const a=Y(this.html.styleSheet,".bifm-container-page");if(o=Math.max(o,100),o=Math.min(o,300),a&&(a.style.height=`${o}%`),h.conf.paginationIMGCount===1){const l=Y(this.html.styleSheet,".bifm-container-page .bifm-img");l&&(l.style.maxWidth=o>100?"":"100%")}}break;case"horizontal":{const a=this.root.scrollLeft,l=Y(this.html.styleSheet,".bifm-container-hori");o=Math.max(o,80),o=Math.min(o,300),l&&(l.style.height=`${o}%`),this.root.scrollLeft=a*(o/r)}break;case"continuous":{const a=this.root.scrollTop,l=Y(this.html.styleSheet,".bifm-container-vert");o=Math.max(o,20),o=Math.min(o,100),l&&(l.style.width=`${o}%`),this.root.scrollTop=a*(o/r)}break}return(n??!0)&&(h.conf.imgScale=o,q({imgScale:o},h.matcher.name)),v("#scaleInput",this.html.pageHelper).textContent=`${o}`,o}resetScaleBigImages(e){const t=h.conf.readMode!=="continuous"||X?100:h.conf.defaultImgScaleModeC;this.scaleBigImages(1,0,t,e)}flushLoadingHelper(){if(this.currLoadingState.size===0)this.loadingHelper.style.display="none";else{this.loadingHelper.style.display==="none"&&(this.loadingHelper.style.display="inline-block");const e=Array.from(this.currLoadingState).map(([t,i])=>`[P-${t+1}: ${i}%]`);h.conf.reversePages&&e.reverse(),this.loadingHelper.textContent=`Loading ${e.join(",")}`}}getPageNumber(){return this.pageNumInChapter[this.chapterIndex]??0}setElements(){let e=Array.from(this.container.childNodes);const t=h.conf.paginationIMGCount*3;if(e.length>t)e.splice(t).forEach(p=>p.remove());else for(;e.length<t;){const d=document.createElement("div");e.push(d)}const i=this.getChapter(this.chapterIndex).filteredQueue;let[n,r]=[this.currentIndex-h.conf.paginationIMGCount,this.currentIndex+h.conf.paginationIMGCount*2-1];[n,r]=[Math.max(n,0),Math.min(r,i.length-1)];const o=e.map(d=>({index:oe(d),elem:d})).sort((d,p)=>d.index-p.index),a=d=>{let p=o.findIndex(g=>g.index===d);if(p>-1)return[o.splice(p,1)[0].elem,!1];if(p=o.findIndex(g=>g.index<n||g.index>r),p===-1)return[null,!1];const u=o.splice(p,1)[0];return u.elem.setAttribute("d-index",d.toString()),[u.elem,!0]};e=[];const l=[];for(let d=n;d<=r;d++){const[p,u]=a(d);if(!p)throw new Error(`BIFM.setElements cannot found element by index:[${d}], or found empty element`);const g=d>=this.currentIndex&&d<this.currentIndex+h.conf.paginationIMGCount;e.push(p),g?(p.classList.remove("bifm-node-hide"),l.push(p)):p.classList.add("bifm-node-hide"),(u||p.childElementCount===0)&&(p.style.aspectRatio="",p.innerHTML="",p.appendChild(this.newMediaNode(i[d])))}h.conf.reversePages&&e.reverse(),this.renderingElements=[...e];const c=o.map(d=>(d.elem.setAttribute("d-index","-1"),d.elem.innerHTML="",d.elem.classList.add("bifm-node-hide"),d.elem));return e.push(...c),this.container.append(...e),l}}class eo{bifm;status;button;lockVer;constructor(e,t){this.bifm=e,this.status="stop",this.button=t,this.lockVer=0,this.bifm.callbackOnWheel=()=>{this.status==="running"&&(this.stop(),this.start(this.lockVer))},f.subscribe("bifm-on-hidden",()=>this.stop()),f.subscribe("bifm-on-show",()=>h.conf.autoPlay&&this.start(this.lockVer)),f.subscribe("toggle-auto-play",()=>{this.status==="stop"?this.start(this.lockVer):this.stop()}),this.initPlayButton()}initPlayButton(){this.button.addEventListener("click",()=>{this.status==="stop"?this.start(this.lockVer):this.stop()})}async start(e){this.status="running",this.button.setAttribute("data-status","playing");const t=this.button.getAttribute("data-display-texts").split(",");if(this.button.firstElementChild.innerText=t[1],!this.bifm.visible){const r=this.bifm.getChapter(this.bifm.chapterIndex).filteredQueue;if(r.length===0)return;this.bifm.show(r[this.bifm.currentIndex])}const i=v("#auto-page-progress",this.button),n=()=>h.conf.readMode==="pagination"?h.conf.autoPageSpeed:1;for(;;){if(await K(10),i.style.animation=`${n()*1e3}ms linear main-progress`,await K(n()*1e3),this.lockVer!==e)return;if(i.style.animation="",this.status!=="running")break;const r=this.bifm.getChapter(this.bifm.chapterIndex).filteredQueue;if(this.bifm.currentIndex<0||this.bifm.currentIndex>=r.length)break;if(h.conf.readMode==="pagination"){const a=this.bifm.container.querySelector(`div[d-index="${this.bifm.currentIndex}"]`)?.firstElementChild;if(a instanceof HTMLVideoElement){let l;const c=new Promise(d=>l=d);a.addEventListener("timeupdate",()=>{a.currentTime>=a.duration-1&&K(1e3).then(l)}),await c}}const o=this.bifm.root.offsetHeight/2;this.bifm.onWheel(new WheelEvent("wheel",{deltaY:o}),!0,!0,!0)}this.stop()}stop(){this.status="stop",this.button.setAttribute("data-status","paused");const e=v("#auto-page-progress",this.button);e.style.animation="",this.lockVer+=1;const t=this.button.getAttribute("data-display-texts").split(",");this.button.firstElementChild.innerText=t[0],this.bifm.scrollStop()}}function oe(s){if(!s)return-1;const e=s.getAttribute("d-index")||"",t=parseInt(e);return isNaN(t)?-1:t}function to(s,e,t,i){let[n,r]=[e.clientY-t.y,e.clientX-t.x];[n,r]=[-n,-r];const o=s.scrollHeight-s.offsetHeight;if(o>0){const l=h.conf.readMode==="continuous"?1:o/(s.offsetHeight/4)*3;let c=s.scrollTop+n*l;c=Math.max(c,0),c=Math.min(c,o),s.scrollTop=c}const a=(i??s.scrollWidth)-s.offsetWidth;if(a>0){const l=h.conf.readMode!=="pagination"?1:a/(s.offsetWidth/4)*3;let c=s.scrollLeft+r*l;s.scrollLeft=c}}function io(s){const e=Element.prototype.scrollTo;Object.defineProperty(s,"scrollTo",{value:e,writable:!0,configurable:!0})}class no{values=[];allTags=new Set;onChange;filterNodes(e,t){if(!h.conf.enableFilter)return e;let i=e;for(const n of this.values)i=i.filter(r=>{for(const o of r.node.tags)if(o===n.tag)return!0;return!1});return t&&this.allTags.clear(),i.forEach(n=>n.node.tags.forEach(r=>this.allTags.add(r))),i}push(e,t){this.values.find(n=>n.tag===t)||(this.values.push({exclude:e,tag:t}),this.onChange?.(this))}remove(e){const t=this.values.findIndex(i=>i.tag===e);t>-1&&(this.values.splice(t,1),this.onChange?.(this))}clear(){this.values=[],this.onChange?.(this)}}const xt=Object.assign({"./platform/matchers/18comic.ts":Jt,"./platform/matchers/3hentai.ts":ei,"./platform/matchers/akuma.ts":ii,"./platform/matchers/arca.ts":ri,"./platform/matchers/artstation.ts":ai,"./platform/matchers/asmhentai.ts":li,"./platform/matchers/bilibili.ts":di,"./platform/matchers/colamanga.ts":_i,"./platform/matchers/danbooru.ts":Si,"./platform/matchers/eahentai.ts":Ei,"./platform/matchers/ehentai.ts":Mi,"./platform/matchers/hanime1.ts":$i,"./platform/matchers/hentainexus.ts":qi,"./platform/matchers/hentaizap.ts":Gi,"./platform/matchers/hitomi.ts":Wi,"./platform/matchers/im-hentai.ts":Ki,"./platform/matchers/instagram.ts":Qi,"./platform/matchers/kemono.ts":sn,"./platform/matchers/konachan.ts":cn,"./platform/matchers/mangacopy.ts":un,"./platform/matchers/mangapark.ts":mn,"./platform/matchers/mangatoto.ts":bn,"./platform/matchers/manhuagui.ts":Sn,"./platform/matchers/miniserve.ts":En,"./platform/matchers/mycomic.ts":Tn,"./platform/matchers/nhentai.ts":Mn,"./platform/matchers/niyaniya.ts":Dn,"./platform/matchers/pixiv.ts":Qn,"./platform/matchers/rokuhentai.ts":er,"./platform/matchers/steam.ts":nr,"./platform/matchers/twitter.ts":dr,"./platform/matchers/wnacg.ts":pr,"./platform/matchers/yabai.ts":gr,"./platform/matchers/yandere.ts":br});for(const s in xt)xt[s];function ro(){const s=h.matcher.constructor(),e=new no,t=jr(e);[t.fullViewGrid,t.bigImageFrame].forEach(u=>io(u));const i=Ue.newQueue(),n=new Ir(i),r=new Wt(i,s,e),o=new Cr(t,i,n,r,s),a=new Wr(t,()=>r.chapters,()=>o.downloading),l=new Qr(t,u=>r.chapters[u]);new Or(t,l);const c=$r(t,l,i,n,a);Fr(c,t,l,o,a),f.subscribe("downloader-canvas-on-click",u=>{i.currIndex=u,i.chapterIndex===l.chapterIndex&&l.show(i[u])}),f.subscribe("notify-message",(u,g,m)=>Hr(t.messageBox,u,g,m)),r.beforeInit=()=>t.pageLoading.style.display="flex",r.afterInit=()=>{if(t.pageLoading.style.display="none",n.processingIndexList=[0],n.start(),h.conf.autoEnterBig||l.visible){const u=i[l.getPageNumber()];u&&l.show(u)}},h.conf.first&&(c.showGuideEvent(),h.conf.first=!1,q({first:!1})),f.subscribe("start-download",u=>{d.first=!1,r.chapters.length===0?f.emit("pf-init",()=>{o.start(),u()}):(o.start(),K(20).then(u))});const d={first:!0};function p(u){t.pageHelper&&(u?(c.showFullViewGrid(),d.first&&(d.first=!1,f.emit("pf-init",()=>{}))):(["config","downloader"].forEach(g=>c.togglePanelEvent(g,!0)),c.hiddenFullViewGrid()))}return f.subscribe("toggle-main-view",p),h.conf.autoOpen&&(t.entryBTN.setAttribute("data-stage","open"),p(!0)),()=>(console.log("destory eh-view-enhance"),p(!1),r.abort(),n.abort(),i.length=0,f.reset(),document.querySelector("#ehvp-base")?.remove(),K(500))}let ze;const oo=new W;function Ge(){oo.addEvent("LOCATION-CHANGE",()=>{const s=()=>{if(window.self!==window.top){A("error","in iframe");return}document.querySelector(".ehvp-base")||h.ready.then(()=>{ze=ro()})};ze?ze().then(s):s()},20)}setTimeout(()=>{const s=history.pushState;history.pushState=function(...i){return Ge(),s.apply(this,i)};const e=history.replaceState;history.replaceState=function(...i){return e.apply(this,i)},window.addEventListener("popstate",Ge),Ge()},300)})(pica,zip,saveAs);
